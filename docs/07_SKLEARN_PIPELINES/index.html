<!doctype html><html lang=es class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Curso end-to-end para construir un portafolio ML/MLOps profesional desde cero"><meta name=author content=DuqueOM><link href=https://duqueom.github.io/Guia_MLOps/docs/07_SKLEARN_PIPELINES/ rel=canonical><link href=../06_VERSIONADO_DATOS/ rel=prev><link href=../08_INGENIERIA_FEATURES/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>07 â€” sklearn Pipelines - GuÃ­a MLOps â€” Portfolio Edition v2</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#07-sklearn-pipelines-el-corazon-de-mlops class=md-skip> Saltar a contenido </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabecera> <a href=../.. title="GuÃ­a MLOps â€” Portfolio Edition v2" class="md-header__button md-logo" aria-label="GuÃ­a MLOps â€” Portfolio Edition v2" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> GuÃ­a MLOps â€” Portfolio Edition v2 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 07 â€” sklearn Pipelines </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Cambiar a modo oscuro" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Cambiar a modo claro" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Cambiar a modo claro" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=BÃºsqueda placeholder=BÃºsqueda autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Buscar> <button type=reset class="md-search__icon md-icon" title=Limpiar aria-label=Limpiar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando bÃºsqueda </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/DuqueOM/Guia_MLOps title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Guia_MLOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=PestaÃ±as data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../ class=md-tabs__link> Inicio </a> </li> <li class=md-tabs__item> <a href=../00_INDICE/ class=md-tabs__link> Ãndice Principal </a> </li> <li class=md-tabs__item> <a href=../SYLLABUS/ class=md-tabs__link> Syllabus </a> </li> <li class=md-tabs__item> <a href=../MAPA_PORTAFOLIO_1TO1/ class=md-tabs__link> Mapa 1:1 Portafolio </a> </li> <li class=md-tabs__item> <a href=../PLAN_ESTUDIOS/ class=md-tabs__link> Plan de Estudios </a> </li> <li class=md-tabs__item> <a href=../01_PYTHON_MODERNO/ class=md-tabs__link> Fase 1 - Fundamentos </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Fase 2 - ML Engineering </a> </li> <li class=md-tabs__item> <a href=../11_TESTING_ML/ class=md-tabs__link> Fase 3 - MLOps Core </a> </li> <li class=md-tabs__item> <a href=../17_DESPLIEGUE/ class=md-tabs__link> Fase 4 - ProducciÃ³n </a> </li> <li class=md-tabs__item> <a href=../19_DOCUMENTACION/ class=md-tabs__link> Fase 5 - Senior/Staff </a> </li> <li class=md-tabs__item> <a href=../apoyo/ class=md-tabs__link> Material de Apoyo </a> </li> <li class=md-tabs__item> <a href=../study_tools/ class=md-tabs__link> Herramientas de Estudio </a> </li> <li class=md-tabs__item> <a href=../../exams/EXAM_01_SETUP/ class=md-tabs__link> ExÃ¡menes </a> </li> <li class=md-tabs__item> <a href=../SIMULACRO_ENTREVISTA_JUNIOR/ class=md-tabs__link> Simulacros de Entrevista </a> </li> <li class=md-tabs__item> <a href=../../notebooks/labs/LAB_01_DOCKER_DEBUG/ class=md-tabs__link> Laboratorios </a> </li> <li class=md-tabs__item> <a href=../templates/ class=md-tabs__link> Plantillas </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=NavegaciÃ³n data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="GuÃ­a MLOps â€” Portfolio Edition v2" class="md-nav__button md-logo" aria-label="GuÃ­a MLOps â€” Portfolio Edition v2" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> GuÃ­a MLOps â€” Portfolio Edition v2 </label> <div class=md-nav__source> <a href=https://github.com/DuqueOM/Guia_MLOps title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Guia_MLOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Inicio </span> </a> </li> <li class=md-nav__item> <a href=../00_INDICE/ class=md-nav__link> <span class=md-ellipsis> Ãndice Principal </span> </a> </li> <li class=md-nav__item> <a href=../SYLLABUS/ class=md-nav__link> <span class=md-ellipsis> Syllabus </span> </a> </li> <li class=md-nav__item> <a href=../MAPA_PORTAFOLIO_1TO1/ class=md-nav__link> <span class=md-ellipsis> Mapa 1:1 Portafolio </span> </a> </li> <li class=md-nav__item> <a href=../PLAN_ESTUDIOS/ class=md-nav__link> <span class=md-ellipsis> Plan de Estudios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Fase 1 - Fundamentos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Fase 1 - Fundamentos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01_PYTHON_MODERNO/ class=md-nav__link> <span class=md-ellipsis> 01 â€” Python Moderno </span> </a> </li> <li class=md-nav__item> <a href=../02_DISENO_SISTEMAS/ class=md-nav__link> <span class=md-ellipsis> 02 â€” DiseÃ±o de Sistemas </span> </a> </li> <li class=md-nav__item> <a href=../03_ESTRUCTURA_PROYECTO/ class=md-nav__link> <span class=md-ellipsis> 03 â€” Estructura de Proyecto </span> </a> </li> <li class=md-nav__item> <a href=../04_ENTORNOS/ class=md-nav__link> <span class=md-ellipsis> 04 â€” Entornos </span> </a> </li> <li class=md-nav__item> <a href=../05_GIT_PROFESIONAL/ class=md-nav__link> <span class=md-ellipsis> 05 â€” Git Profesional </span> </a> </li> <li class=md-nav__item> <a href=../06_VERSIONADO_DATOS/ class=md-nav__link> <span class=md-ellipsis> 06 â€” Versionado de Datos </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Fase 2 - ML Engineering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=true> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Fase 2 - ML Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 07 â€” sklearn Pipelines </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 07 â€” sklearn Pipelines </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#objetivo-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Objetivo del MÃ³dulo </span> </a> </li> <li class=md-nav__item> <a href=#00-prerrequisitos class=md-nav__link> <span class=md-ellipsis> 0.0 Prerrequisitos </span> </a> </li> <li class=md-nav__item> <a href=#01-protocolo-e-como-estudiar-este-modulo class=md-nav__link> <span class=md-ellipsis> 0.1 ğŸ§  Protocolo E: CÃ³mo estudiar este mÃ³dulo </span> </a> </li> <li class=md-nav__item> <a href=#02-entregables-verificables-minimo-viable class=md-nav__link> <span class=md-ellipsis> 0.2 âœ… Entregables verificables (mÃ­nimo viable) </span> </a> </li> <li class=md-nav__item> <a href=#03-puente-teoria-codigo-portafolio class=md-nav__link> <span class=md-ellipsis> 0.3 ğŸ§© Puente teorÃ­a â†” cÃ³digo (Portafolio) </span> </a> </li> <li class=md-nav__item> <a href=#contenido class=md-nav__link> <span class=md-ellipsis> ğŸ“‹ Contenido </span> </a> </li> <li class=md-nav__item> <a href=#71-por-que-pipelines class=md-nav__link> <span class=md-ellipsis> 7.1 Â¿Por QuÃ© Pipelines? </span> </a> <nav class=md-nav aria-label="7.1 Â¿Por QuÃ© Pipelines?"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#la-analogia-de-la-linea-de-ensamblaje class=md-nav__link> <span class=md-ellipsis> La AnalogÃ­a de la LÃ­nea de Ensamblaje </span> </a> </li> <li class=md-nav__item> <a href=#el-problema-real-training-serving-skew class=md-nav__link> <span class=md-ellipsis> El Problema Real: Training-Serving Skew </span> </a> </li> <li class=md-nav__item> <a href=#practica-del-portafolio-pipeline-de-bankchurn class=md-nav__link> <span class=md-ellipsis> ğŸ› ï¸ PrÃ¡ctica del Portafolio: Pipeline de BankChurn </span> </a> </li> <li class=md-nav__item> <a href=#checkpoint-de-conocimiento-pipelines class=md-nav__link> <span class=md-ellipsis> âœ… Checkpoint de Conocimiento: Pipelines </span> </a> </li> <li class=md-nav__item> <a href=#visualizacion-del-flujo class=md-nav__link> <span class=md-ellipsis> VisualizaciÃ³n del Flujo </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#73-custom-transformers-tu-superpoder class=md-nav__link> <span class=md-ellipsis> 7.3 Custom Transformers: Tu Superpoder </span> </a> <nav class=md-nav aria-label="7.3 Custom Transformers: Tu Superpoder"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cuando-crear-un-custom-transformer class=md-nav__link> <span class=md-ellipsis> Â¿CuÃ¡ndo Crear un Custom Transformer? </span> </a> </li> <li class=md-nav__item> <a href=#ejemplo-1-featureengineer-carvision class=md-nav__link> <span class=md-ellipsis> Ejemplo 1: FeatureEngineer (CarVision) </span> </a> </li> <li class=md-nav__item> <a href=#ejemplo-2-resampleclassifier-bankchurn class=md-nav__link> <span class=md-ellipsis> Ejemplo 2: ResampleClassifier (BankChurn) </span> </a> </li> <li class=md-nav__item> <a href=#la-plantilla-crea-tu-propio-transformer class=md-nav__link> <span class=md-ellipsis> La Plantilla: Crea Tu Propio Transformer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#74-pipeline-completo-codigo-real class=md-nav__link> <span class=md-ellipsis> 7.4 Pipeline Completo: CÃ³digo Real </span> </a> <nav class=md-nav aria-label="7.4 Pipeline Completo: CÃ³digo Real"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#carvision-el-pipeline-de-3-etapas class=md-nav__link> <span class=md-ellipsis> CarVision: El Pipeline de 3 Etapas </span> </a> </li> <li class=md-nav__item> <a href=#bankchurn-pipeline-con-ensemble class=md-nav__link> <span class=md-ellipsis> BankChurn: Pipeline con Ensemble </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#75-ejercicios-practicos class=md-nav__link> <span class=md-ellipsis> 7.5 Ejercicios PrÃ¡cticos </span> </a> <nav class=md-nav aria-label="7.5 Ejercicios PrÃ¡cticos"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ejercicio-1-construir-un-columntransformer class=md-nav__link> <span class=md-ellipsis> Ejercicio 1: Construir un ColumnTransformer </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-2-crear-un-custom-transformer class=md-nav__link> <span class=md-ellipsis> Ejercicio 2: Crear un Custom Transformer </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-3-pipeline-completo-para-telecomai class=md-nav__link> <span class=md-ellipsis> Ejercicio 3: Pipeline Completo para TelecomAI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#76-ingenieria-inversa-pedagogica-columntransformer-real class=md-nav__link> <span class=md-ellipsis> 7.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ColumnTransformer Real </span> </a> <nav class=md-nav aria-label="7.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ColumnTransformer Real"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#761-el-por-que-arquitectonico class=md-nav__link> <span class=md-ellipsis> 7.6.1 ğŸ¯ El "Por QuÃ©" ArquitectÃ³nico </span> </a> </li> <li class=md-nav__item> <a href=#762-anatomia-del-columntransformer class=md-nav__link> <span class=md-ellipsis> 7.6.2 ğŸ” AnatomÃ­a del ColumnTransformer </span> </a> </li> <li class=md-nav__item> <a href=#763-troubleshooting class=md-nav__link> <span class=md-ellipsis> 7.6.3 ğŸš¨ Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#errores-habituales-y-como-depurarlos-en-sklearn-pipelines class=md-nav__link> <span class=md-ellipsis> ğŸ§¨ Errores habituales y cÃ³mo depurarlos en sklearn Pipelines </span> </a> <nav class=md-nav aria-label="ğŸ§¨ Errores habituales y cÃ³mo depurarlos en sklearn Pipelines"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-valueerror-number-of-features-does-not-match-mismatch-entre-train-e-inference class=md-nav__link> <span class=md-ellipsis> 1) ValueError: number of features does not match (mismatch entre train e inference) </span> </a> </li> <li class=md-nav__item> <a href=#2-data-leakage-por-features-que-usan-el-target-especialmente-en-carvision class=md-nav__link> <span class=md-ellipsis> 2) Data leakage por features que usan el target (especialmente en CarVision) </span> </a> </li> <li class=md-nav__item> <a href=#3-custom-transformers-que-modifican-el-input-in-place-o-no-respetan-la-api-sklearn class=md-nav__link> <span class=md-ellipsis> 3) Custom transformers que modifican el input in-place o no respetan la API sklearn </span> </a> </li> <li class=md-nav__item> <a href=#4-pipelines-diferentes-en-training-y-en-la-api class=md-nav__link> <span class=md-ellipsis> 4) Pipelines diferentes en training y en la API </span> </a> </li> <li class=md-nav__item> <a href=#5-patron-general-de-debugging-para-pipelines class=md-nav__link> <span class=md-ellipsis> 5) PatrÃ³n general de debugging para pipelines </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#checkpoint-completaste-el-modulo class=md-nav__link> <span class=md-ellipsis> âœ… Checkpoint: Â¿Completaste el MÃ³dulo? </span> </a> <nav class=md-nav aria-label="âœ… Checkpoint: Â¿Completaste el MÃ³dulo?"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#checklist class=md-nav__link> <span class=md-ellipsis> Checklist </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adr-decisiones-de-arquitectura class=md-nav__link> <span class=md-ellipsis> ğŸ”— ADR: Decisiones de Arquitectura </span> </a> <nav class=md-nav aria-label="ğŸ”— ADR: Decisiones de Arquitectura"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#adr-007-pipeline-unificado-obligatorio class=md-nav__link> <span class=md-ellipsis> ADR-007: Pipeline Unificado Obligatorio </span> </a> </li> <li class=md-nav__item> <a href=#adr-008-custom-transformers-para-feature-engineering class=md-nav__link> <span class=md-ellipsis> ADR-008: Custom Transformers para Feature Engineering </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#como-se-uso-en-el-portafolio class=md-nav__link> <span class=md-ellipsis> ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio </span> </a> <nav class=md-nav aria-label="ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pipeline-unificado-de-bankchurn class=md-nav__link> <span class=md-ellipsis> Pipeline Unificado de BankChurn </span> </a> </li> <li class=md-nav__item> <a href=#featureengineer-de-carvision class=md-nav__link> <span class=md-ellipsis> FeatureEngineer de CarVision </span> </a> </li> <li class=md-nav__item> <a href=#archivos-clave-por-proyecto class=md-nav__link> <span class=md-ellipsis> Archivos Clave por Proyecto </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-explora-los-pipelines-reales class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Ejercicio: Explora los Pipelines Reales </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consejos-profesionales class=md-nav__link> <span class=md-ellipsis> ğŸ’¼ Consejos Profesionales </span> </a> <nav class=md-nav aria-label="ğŸ’¼ Consejos Profesionales"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#para-entrevistas class=md-nav__link> <span class=md-ellipsis> Para Entrevistas </span> </a> </li> <li class=md-nav__item> <a href=#para-proyectos-reales class=md-nav__link> <span class=md-ellipsis> Para Proyectos Reales </span> </a> </li> <li class=md-nav__item> <a href=#patrones-avanzados class=md-nav__link> <span class=md-ellipsis> Patrones Avanzados </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#recursos-externos-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ“º Recursos Externos del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ“º Recursos Externos del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#videos class=md-nav__link> <span class=md-ellipsis> ğŸ¬ Videos </span> </a> </li> <li class=md-nav__item> <a href=#cursos class=md-nav__link> <span class=md-ellipsis> ğŸ“š Cursos </span> </a> </li> <li class=md-nav__item> <a href=#documentacion class=md-nav__link> <span class=md-ellipsis> ğŸ“„ DocumentaciÃ³n </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decision-tecnica-adr-002-scikit-learn class=md-nav__link> <span class=md-ellipsis> âš–ï¸ DecisiÃ³n TÃ©cnica: ADR-002 scikit-learn </span> </a> </li> <li class=md-nav__item> <a href=#ejercicios-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Ejercicios del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ”§ Ejercicios del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ejercicio-71-pipeline-basico class=md-nav__link> <span class=md-ellipsis> Ejercicio 7.1: Pipeline BÃ¡sico </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-72-columntransformer class=md-nav__link> <span class=md-ellipsis> Ejercicio 7.2: ColumnTransformer </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-73-custom-transformer class=md-nav__link> <span class=md-ellipsis> Ejercicio 7.3: Custom Transformer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#glosario-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ”— Glosario del MÃ³dulo </span> </a> </li> <li class=md-nav__item> <a href=#la-trampa-errores-comunes-de-este-modulo class=md-nav__link> <span class=md-ellipsis> ğŸª¤ La Trampa â€” Errores Comunes de Este MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸª¤ La Trampa â€” Errores Comunes de Este MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trampa-1-data-leakage-con-fit_transform-en-todo-el-dataset class=md-nav__link> <span class=md-ellipsis> Trampa 1: Data leakage con fit_transform en todo el dataset </span> </a> </li> <li class=md-nav__item> <a href=#trampa-2-columntransformer-pierde-nombres-de-columnas class=md-nav__link> <span class=md-ellipsis> Trampa 2: ColumnTransformer pierde nombres de columnas </span> </a> </li> <li class=md-nav__item> <a href=#trampa-3-custom-transformer-sin-retornar-self-en-fit class=md-nav__link> <span class=md-ellipsis> Trampa 3: Custom Transformer sin retornar self en fit </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quiz-del-modulo-semanas-7-8 class=md-nav__link> <span class=md-ellipsis> ğŸ“ Quiz del MÃ³dulo â€” Semanas 7-8 </span> </a> <nav class=md-nav aria-label="ğŸ“ Quiz del MÃ³dulo â€” Semanas 7-8"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quiz-semana-7-sklearn-pipelines class=md-nav__link> <span class=md-ellipsis> Quiz Semana 7: sklearn Pipelines </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../08_INGENIERIA_FEATURES/ class=md-nav__link> <span class=md-ellipsis> 08 â€” IngenierÃ­a de Features </span> </a> </li> <li class=md-nav__item> <a href=../09_TRAINING_PROFESIONAL/ class=md-nav__link> <span class=md-ellipsis> 09 â€” Training Profesional </span> </a> </li> <li class=md-nav__item> <a href=../10_EXPERIMENT_TRACKING/ class=md-nav__link> <span class=md-ellipsis> 10 â€” Experiment Tracking </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Fase 3 - MLOps Core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Fase 3 - MLOps Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../11_TESTING_ML/ class=md-nav__link> <span class=md-ellipsis> 11 â€” Testing ML </span> </a> </li> <li class=md-nav__item> <a href=../12_CI_CD/ class=md-nav__link> <span class=md-ellipsis> 12 â€” CI/CD </span> </a> </li> <li class=md-nav__item> <a href=../13_DOCKER/ class=md-nav__link> <span class=md-ellipsis> 13 â€” Docker </span> </a> </li> <li class=md-nav__item> <a href=../14_FASTAPI/ class=md-nav__link> <span class=md-ellipsis> 14 â€” FastAPI </span> </a> </li> <li class=md-nav__item> <a href=../15_STREAMLIT/ class=md-nav__link> <span class=md-ellipsis> 15 â€” Streamlit </span> </a> </li> <li class=md-nav__item> <a href=../16_OBSERVABILIDAD/ class=md-nav__link> <span class=md-ellipsis> 16 â€” Observabilidad </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Fase 4 - ProducciÃ³n </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Fase 4 - ProducciÃ³n </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../17_DESPLIEGUE/ class=md-nav__link> <span class=md-ellipsis> 17 â€” Despliegue </span> </a> </li> <li class=md-nav__item> <a href=../18_INFRAESTRUCTURA/ class=md-nav__link> <span class=md-ellipsis> 18 â€” Infraestructura </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0> <span class=md-ellipsis> Fase 5 - Senior/Staff </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Fase 5 - Senior/Staff </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../19_DOCUMENTACION/ class=md-nav__link> <span class=md-ellipsis> 19 â€” DocumentaciÃ³n </span> </a> </li> <li class=md-nav__item> <a href=../20_OBSERVABILIDAD_AVANZADA_DRIFT/ class=md-nav__link> <span class=md-ellipsis> 20 â€” Observabilidad Avanzada </span> </a> </li> <li class=md-nav__item> <a href=../21_CLOUD_FINOPS/ class=md-nav__link> <span class=md-ellipsis> 21 â€” Cloud FinOps </span> </a> </li> <li class=md-nav__item> <a href=../22_IAC_EMPRESARIAL/ class=md-nav__link> <span class=md-ellipsis> 22 â€” IaC Empresarial </span> </a> </li> <li class=md-nav__item> <a href=../23_PROYECTO_INTEGRADOR/ class=md-nav__link> <span class=md-ellipsis> 23 â€” Proyecto Integrador </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0> <span class=md-ellipsis> Material de Apoyo </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Material de Apoyo </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../apoyo/ class=md-nav__link> <span class=md-ellipsis> Ãndice Apoyo </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GLOSARIO/ class=md-nav__link> <span class=md-ellipsis> Glosario MLOps </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/CHECKLIST/ class=md-nav__link> <span class=md-ellipsis> Checklist Profesional </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/RECURSOS/ class=md-nav__link> <span class=md-ellipsis> Recursos Externos </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/RUBRICA_EVALUACION/ class=md-nav__link> <span class=md-ellipsis> RÃºbrica de EvaluaciÃ³n </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/PLANTILLAS/ class=md-nav__link> <span class=md-ellipsis> Plantillas </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GUIA_AUDIOVISUAL/ class=md-nav__link> <span class=md-ellipsis> GuÃ­a Audiovisual </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/MAINTENANCE_GUIDE/ class=md-nav__link> <span class=md-ellipsis> GuÃ­a de Mantenimiento </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GUIA_SCRIPTS_OPERACIONALES/ class=md-nav__link> <span class=md-ellipsis> Scripts Operacionales </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_12> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex=0> <span class=md-ellipsis> Herramientas de Estudio </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_12_label aria-expanded=false> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Herramientas de Estudio </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../study_tools/ class=md-nav__link> <span class=md-ellipsis> Ãndice </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/PROTOCOLO_E/ class=md-nav__link> <span class=md-ellipsis> Protocolo E </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/DIARIO_ERRORES/ class=md-nav__link> <span class=md-ellipsis> Diario de Errores </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/CIERRE_SEMANAL/ class=md-nav__link> <span class=md-ellipsis> Cierre Semanal </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13> <label class=md-nav__link for=__nav_13 id=__nav_13_label tabindex=0> <span class=md-ellipsis> ExÃ¡menes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_13_label aria-expanded=false> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> ExÃ¡menes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../exams/EXAM_01_SETUP/ class=md-nav__link> <span class=md-ellipsis> Exam 01 â€” Setup </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_02_PIPELINE/ class=md-nav__link> <span class=md-ellipsis> Exam 02 â€” Pipeline </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_03_TESTING/ class=md-nav__link> <span class=md-ellipsis> Exam 03 â€” Testing </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_04_DEPLOYMENT/ class=md-nav__link> <span class=md-ellipsis> Exam 04 â€” Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_05_PRODUCTION/ class=md-nav__link> <span class=md-ellipsis> Exam 05 â€” Production </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_06_INTEGRATION/ class=md-nav__link> <span class=md-ellipsis> Exam 06 â€” Integration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_14> <label class=md-nav__link for=__nav_14 id=__nav_14_label tabindex=0> <span class=md-ellipsis> Simulacros de Entrevista </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_14_label aria-expanded=false> <label class=md-nav__title for=__nav_14> <span class="md-nav__icon md-icon"></span> Simulacros de Entrevista </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_JUNIOR/ class=md-nav__link> <span class=md-ellipsis> Junior </span> </a> </li> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_MID/ class=md-nav__link> <span class=md-ellipsis> Mid </span> </a> </li> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_SENIOR_PARTE1/ class=md-nav__link> <span class=md-ellipsis> Senior Parte 1 </span> </a> </li> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_SENIOR_PARTE2/ class=md-nav__link> <span class=md-ellipsis> Senior Parte 2 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_15> <label class=md-nav__link for=__nav_15 id=__nav_15_label tabindex=0> <span class=md-ellipsis> Laboratorios </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_15_label aria-expanded=false> <label class=md-nav__title for=__nav_15> <span class="md-nav__icon md-icon"></span> Laboratorios </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_01_DOCKER_DEBUG/ class=md-nav__link> <span class=md-ellipsis> LAB 01 â€” Docker Debug </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_02_PANDAS_PERFORMANCE/ class=md-nav__link> <span class=md-ellipsis> LAB 02 â€” Pandas Performance </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_03_DEPENDENCY_CONFLICTS/ class=md-nav__link> <span class=md-ellipsis> LAB 03 â€” Dependency Conflicts </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/07_08_sklearn_pipelines/ class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Notebook Interactivo: sklearn Pipelines y Feature Engineering </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_16> <label class=md-nav__link for=__nav_16 id=__nav_16_label tabindex=0> <span class=md-ellipsis> Plantillas </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_16_label aria-expanded=false> <label class=md-nav__title for=__nav_16> <span class="md-nav__icon md-icon"></span> Plantillas </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../templates/ class=md-nav__link> <span class=md-ellipsis> Ãndice Plantillas </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#objetivo-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Objetivo del MÃ³dulo </span> </a> </li> <li class=md-nav__item> <a href=#00-prerrequisitos class=md-nav__link> <span class=md-ellipsis> 0.0 Prerrequisitos </span> </a> </li> <li class=md-nav__item> <a href=#01-protocolo-e-como-estudiar-este-modulo class=md-nav__link> <span class=md-ellipsis> 0.1 ğŸ§  Protocolo E: CÃ³mo estudiar este mÃ³dulo </span> </a> </li> <li class=md-nav__item> <a href=#02-entregables-verificables-minimo-viable class=md-nav__link> <span class=md-ellipsis> 0.2 âœ… Entregables verificables (mÃ­nimo viable) </span> </a> </li> <li class=md-nav__item> <a href=#03-puente-teoria-codigo-portafolio class=md-nav__link> <span class=md-ellipsis> 0.3 ğŸ§© Puente teorÃ­a â†” cÃ³digo (Portafolio) </span> </a> </li> <li class=md-nav__item> <a href=#contenido class=md-nav__link> <span class=md-ellipsis> ğŸ“‹ Contenido </span> </a> </li> <li class=md-nav__item> <a href=#71-por-que-pipelines class=md-nav__link> <span class=md-ellipsis> 7.1 Â¿Por QuÃ© Pipelines? </span> </a> <nav class=md-nav aria-label="7.1 Â¿Por QuÃ© Pipelines?"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#la-analogia-de-la-linea-de-ensamblaje class=md-nav__link> <span class=md-ellipsis> La AnalogÃ­a de la LÃ­nea de Ensamblaje </span> </a> </li> <li class=md-nav__item> <a href=#el-problema-real-training-serving-skew class=md-nav__link> <span class=md-ellipsis> El Problema Real: Training-Serving Skew </span> </a> </li> <li class=md-nav__item> <a href=#practica-del-portafolio-pipeline-de-bankchurn class=md-nav__link> <span class=md-ellipsis> ğŸ› ï¸ PrÃ¡ctica del Portafolio: Pipeline de BankChurn </span> </a> </li> <li class=md-nav__item> <a href=#checkpoint-de-conocimiento-pipelines class=md-nav__link> <span class=md-ellipsis> âœ… Checkpoint de Conocimiento: Pipelines </span> </a> </li> <li class=md-nav__item> <a href=#visualizacion-del-flujo class=md-nav__link> <span class=md-ellipsis> VisualizaciÃ³n del Flujo </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#73-custom-transformers-tu-superpoder class=md-nav__link> <span class=md-ellipsis> 7.3 Custom Transformers: Tu Superpoder </span> </a> <nav class=md-nav aria-label="7.3 Custom Transformers: Tu Superpoder"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cuando-crear-un-custom-transformer class=md-nav__link> <span class=md-ellipsis> Â¿CuÃ¡ndo Crear un Custom Transformer? </span> </a> </li> <li class=md-nav__item> <a href=#ejemplo-1-featureengineer-carvision class=md-nav__link> <span class=md-ellipsis> Ejemplo 1: FeatureEngineer (CarVision) </span> </a> </li> <li class=md-nav__item> <a href=#ejemplo-2-resampleclassifier-bankchurn class=md-nav__link> <span class=md-ellipsis> Ejemplo 2: ResampleClassifier (BankChurn) </span> </a> </li> <li class=md-nav__item> <a href=#la-plantilla-crea-tu-propio-transformer class=md-nav__link> <span class=md-ellipsis> La Plantilla: Crea Tu Propio Transformer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#74-pipeline-completo-codigo-real class=md-nav__link> <span class=md-ellipsis> 7.4 Pipeline Completo: CÃ³digo Real </span> </a> <nav class=md-nav aria-label="7.4 Pipeline Completo: CÃ³digo Real"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#carvision-el-pipeline-de-3-etapas class=md-nav__link> <span class=md-ellipsis> CarVision: El Pipeline de 3 Etapas </span> </a> </li> <li class=md-nav__item> <a href=#bankchurn-pipeline-con-ensemble class=md-nav__link> <span class=md-ellipsis> BankChurn: Pipeline con Ensemble </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#75-ejercicios-practicos class=md-nav__link> <span class=md-ellipsis> 7.5 Ejercicios PrÃ¡cticos </span> </a> <nav class=md-nav aria-label="7.5 Ejercicios PrÃ¡cticos"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ejercicio-1-construir-un-columntransformer class=md-nav__link> <span class=md-ellipsis> Ejercicio 1: Construir un ColumnTransformer </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-2-crear-un-custom-transformer class=md-nav__link> <span class=md-ellipsis> Ejercicio 2: Crear un Custom Transformer </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-3-pipeline-completo-para-telecomai class=md-nav__link> <span class=md-ellipsis> Ejercicio 3: Pipeline Completo para TelecomAI </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#76-ingenieria-inversa-pedagogica-columntransformer-real class=md-nav__link> <span class=md-ellipsis> 7.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ColumnTransformer Real </span> </a> <nav class=md-nav aria-label="7.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ColumnTransformer Real"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#761-el-por-que-arquitectonico class=md-nav__link> <span class=md-ellipsis> 7.6.1 ğŸ¯ El "Por QuÃ©" ArquitectÃ³nico </span> </a> </li> <li class=md-nav__item> <a href=#762-anatomia-del-columntransformer class=md-nav__link> <span class=md-ellipsis> 7.6.2 ğŸ” AnatomÃ­a del ColumnTransformer </span> </a> </li> <li class=md-nav__item> <a href=#763-troubleshooting class=md-nav__link> <span class=md-ellipsis> 7.6.3 ğŸš¨ Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#errores-habituales-y-como-depurarlos-en-sklearn-pipelines class=md-nav__link> <span class=md-ellipsis> ğŸ§¨ Errores habituales y cÃ³mo depurarlos en sklearn Pipelines </span> </a> <nav class=md-nav aria-label="ğŸ§¨ Errores habituales y cÃ³mo depurarlos en sklearn Pipelines"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-valueerror-number-of-features-does-not-match-mismatch-entre-train-e-inference class=md-nav__link> <span class=md-ellipsis> 1) ValueError: number of features does not match (mismatch entre train e inference) </span> </a> </li> <li class=md-nav__item> <a href=#2-data-leakage-por-features-que-usan-el-target-especialmente-en-carvision class=md-nav__link> <span class=md-ellipsis> 2) Data leakage por features que usan el target (especialmente en CarVision) </span> </a> </li> <li class=md-nav__item> <a href=#3-custom-transformers-que-modifican-el-input-in-place-o-no-respetan-la-api-sklearn class=md-nav__link> <span class=md-ellipsis> 3) Custom transformers que modifican el input in-place o no respetan la API sklearn </span> </a> </li> <li class=md-nav__item> <a href=#4-pipelines-diferentes-en-training-y-en-la-api class=md-nav__link> <span class=md-ellipsis> 4) Pipelines diferentes en training y en la API </span> </a> </li> <li class=md-nav__item> <a href=#5-patron-general-de-debugging-para-pipelines class=md-nav__link> <span class=md-ellipsis> 5) PatrÃ³n general de debugging para pipelines </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#checkpoint-completaste-el-modulo class=md-nav__link> <span class=md-ellipsis> âœ… Checkpoint: Â¿Completaste el MÃ³dulo? </span> </a> <nav class=md-nav aria-label="âœ… Checkpoint: Â¿Completaste el MÃ³dulo?"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#checklist class=md-nav__link> <span class=md-ellipsis> Checklist </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adr-decisiones-de-arquitectura class=md-nav__link> <span class=md-ellipsis> ğŸ”— ADR: Decisiones de Arquitectura </span> </a> <nav class=md-nav aria-label="ğŸ”— ADR: Decisiones de Arquitectura"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#adr-007-pipeline-unificado-obligatorio class=md-nav__link> <span class=md-ellipsis> ADR-007: Pipeline Unificado Obligatorio </span> </a> </li> <li class=md-nav__item> <a href=#adr-008-custom-transformers-para-feature-engineering class=md-nav__link> <span class=md-ellipsis> ADR-008: Custom Transformers para Feature Engineering </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#como-se-uso-en-el-portafolio class=md-nav__link> <span class=md-ellipsis> ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio </span> </a> <nav class=md-nav aria-label="ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pipeline-unificado-de-bankchurn class=md-nav__link> <span class=md-ellipsis> Pipeline Unificado de BankChurn </span> </a> </li> <li class=md-nav__item> <a href=#featureengineer-de-carvision class=md-nav__link> <span class=md-ellipsis> FeatureEngineer de CarVision </span> </a> </li> <li class=md-nav__item> <a href=#archivos-clave-por-proyecto class=md-nav__link> <span class=md-ellipsis> Archivos Clave por Proyecto </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-explora-los-pipelines-reales class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Ejercicio: Explora los Pipelines Reales </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consejos-profesionales class=md-nav__link> <span class=md-ellipsis> ğŸ’¼ Consejos Profesionales </span> </a> <nav class=md-nav aria-label="ğŸ’¼ Consejos Profesionales"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#para-entrevistas class=md-nav__link> <span class=md-ellipsis> Para Entrevistas </span> </a> </li> <li class=md-nav__item> <a href=#para-proyectos-reales class=md-nav__link> <span class=md-ellipsis> Para Proyectos Reales </span> </a> </li> <li class=md-nav__item> <a href=#patrones-avanzados class=md-nav__link> <span class=md-ellipsis> Patrones Avanzados </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#recursos-externos-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ“º Recursos Externos del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ“º Recursos Externos del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#videos class=md-nav__link> <span class=md-ellipsis> ğŸ¬ Videos </span> </a> </li> <li class=md-nav__item> <a href=#cursos class=md-nav__link> <span class=md-ellipsis> ğŸ“š Cursos </span> </a> </li> <li class=md-nav__item> <a href=#documentacion class=md-nav__link> <span class=md-ellipsis> ğŸ“„ DocumentaciÃ³n </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decision-tecnica-adr-002-scikit-learn class=md-nav__link> <span class=md-ellipsis> âš–ï¸ DecisiÃ³n TÃ©cnica: ADR-002 scikit-learn </span> </a> </li> <li class=md-nav__item> <a href=#ejercicios-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Ejercicios del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ”§ Ejercicios del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ejercicio-71-pipeline-basico class=md-nav__link> <span class=md-ellipsis> Ejercicio 7.1: Pipeline BÃ¡sico </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-72-columntransformer class=md-nav__link> <span class=md-ellipsis> Ejercicio 7.2: ColumnTransformer </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-73-custom-transformer class=md-nav__link> <span class=md-ellipsis> Ejercicio 7.3: Custom Transformer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#glosario-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ”— Glosario del MÃ³dulo </span> </a> </li> <li class=md-nav__item> <a href=#la-trampa-errores-comunes-de-este-modulo class=md-nav__link> <span class=md-ellipsis> ğŸª¤ La Trampa â€” Errores Comunes de Este MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸª¤ La Trampa â€” Errores Comunes de Este MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trampa-1-data-leakage-con-fit_transform-en-todo-el-dataset class=md-nav__link> <span class=md-ellipsis> Trampa 1: Data leakage con fit_transform en todo el dataset </span> </a> </li> <li class=md-nav__item> <a href=#trampa-2-columntransformer-pierde-nombres-de-columnas class=md-nav__link> <span class=md-ellipsis> Trampa 2: ColumnTransformer pierde nombres de columnas </span> </a> </li> <li class=md-nav__item> <a href=#trampa-3-custom-transformer-sin-retornar-self-en-fit class=md-nav__link> <span class=md-ellipsis> Trampa 3: Custom Transformer sin retornar self en fit </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#quiz-del-modulo-semanas-7-8 class=md-nav__link> <span class=md-ellipsis> ğŸ“ Quiz del MÃ³dulo â€” Semanas 7-8 </span> </a> <nav class=md-nav aria-label="ğŸ“ Quiz del MÃ³dulo â€” Semanas 7-8"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quiz-semana-7-sklearn-pipelines class=md-nav__link> <span class=md-ellipsis> Quiz Semana 7: sklearn Pipelines </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=07-sklearn-pipelines-el-corazon-de-mlops>07. sklearn Pipelines: El CorazÃ³n de MLOps<a class=headerlink href=#07-sklearn-pipelines-el-corazon-de-mlops title="Permanent link">&para;</a></h1> <h2 id=objetivo-del-modulo>ğŸ¯ Objetivo del MÃ³dulo<a class=headerlink href=#objetivo-del-modulo title="Permanent link">&para;</a></h2> <p>Dominar el patrÃ³n mÃ¡s importante de ML profesional: <strong>pipelines unificados</strong> que garantizan reproducibilidad desde entrenamiento hasta producciÃ³n.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>â•‘                                                                              â•‘
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>â•‘  ğŸš¨ EL ERROR #1 EN PRODUCCIÃ“N ML:                                            â•‘
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>â•‘                                                                              â•‘
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>â•‘  Entrenar con una transformaciÃ³n, servir con otra.                           â•‘
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>â•‘                                                                              â•‘
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>â•‘  Ejemplo real:                                                               â•‘
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>â•‘  â€¢ Training: StandardScaler fitted en train set (mean=45000, std=20000)      â•‘
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>â•‘  â€¢ Production: StandardScaler fitted en cada request (mean=???, std=???)     â•‘
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>â•‘  â€¢ Resultado: Predicciones COMPLETAMENTE diferentes                          â•‘
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>â•‘                                                                              â•‘
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>â•‘  ğŸ›¡ï¸ LA SOLUCIÃ“N: Pipeline unificado que guarda TODO junto                    â•‘
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>â•‘                                                                              â•‘
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre></div> <hr> <p><a id=00-prerrequisitos></a></p> <h2 id=00-prerrequisitos>0.0 Prerrequisitos<a class=headerlink href=#00-prerrequisitos title="Permanent link">&para;</a></h2> <ul> <li>Haber completado <strong><a href=../01_PYTHON_MODERNO/ >01_PYTHON_MODERNO</a></strong> y entender el motivo del <code>src/</code> layout.</li> <li>Tener un proyecto del portafolio a mano (ideal: BankChurn) para ubicar el <code>pipeline.pkl</code> real.</li> <li>Entender el problema de <em>training-serving skew</em> (al menos a nivel conceptual).</li> </ul> <hr> <p><a id=01-protocolo-e-como-estudiar-este-modulo></a></p> <h2 id=01-protocolo-e-como-estudiar-este-modulo>0.1 ğŸ§  Protocolo E: CÃ³mo estudiar este mÃ³dulo<a class=headerlink href=#01-protocolo-e-como-estudiar-este-modulo title="Permanent link">&para;</a></h2> <ul> <li><strong>Antes de codificar</strong>: abre <strong><a href=../study_tools/PROTOCOLO_E/ >Protocolo E</a></strong> y define tu <em>output mÃ­nimo</em> (ej: â€œpipeline serializable + tests bÃ¡sicosâ€).</li> <li><strong>Mientras debuggeas</strong>: si te atoras &gt;15 min (ColumnTransformer, columnas, dtypes, <code>fit/transform</code>), registra el bloqueo en <strong><a href=../study_tools/DIARIO_ERRORES/ >Diario de Errores</a></strong>.</li> <li><strong>Al cerrar la semana</strong>: usa <strong><a href=../study_tools/CIERRE_SEMANAL/ >Cierre Semanal</a></strong> para decidir quÃ© mejorar (reproducibilidad, tests, DX).</li> </ul> <hr> <p><a id=02-entregables-verificables-minimo-viable></a></p> <h2 id=02-entregables-verificables-minimo-viable>0.2 âœ… Entregables verificables (mÃ­nimo viable)<a class=headerlink href=#02-entregables-verificables-minimo-viable title="Permanent link">&para;</a></h2> <p>Al terminar este mÃ³dulo, deberÃ­as poder mostrar (en al menos 1 proyecto del portafolio):</p> <ul> <li>[ ] <strong>1 pipeline unificado</strong> serializado (<code>pipeline.pkl</code>) que incluya preprocesamiento + modelo.</li> <li>[ ] <strong>Inferencia consistente</strong>: <code>pipeline.predict(X_new)</code> sin re-fit de transformadores.</li> <li>[ ] <strong>Checklist de verificaciÃ³n</strong> pasando (secciÃ³n â€œCheckpointâ€).</li> </ul> <hr> <p><a id=03-puente-teoria-codigo-portafolio></a></p> <h2 id=03-puente-teoria-codigo-portafolio>0.3 ğŸ§© Puente teorÃ­a â†” cÃ³digo (Portafolio)<a class=headerlink href=#03-puente-teoria-codigo-portafolio title="Permanent link">&para;</a></h2> <p>Para que esto cuente como progreso real, fuerza este mapeo:</p> <ul> <li><strong>Concepto</strong>: Pipeline/ColumnTransformer/custom transformers</li> <li><strong>Archivo</strong>: <code>src/&lt;paquete&gt;/training.py</code>, <code>src/&lt;paquete&gt;/features.py</code>, <code>models/pipeline.pkl</code></li> <li><strong>Prueba</strong>: entrenar una vez, guardar <code>pipeline.pkl</code>, cargarlo y predecir con datos nuevos.</li> </ul> <hr> <h2 id=contenido>ğŸ“‹ Contenido<a class=headerlink href=#contenido title="Permanent link">&para;</a></h2> <ul> <li><strong>0.0</strong> <a href=#00-prerrequisitos>Prerrequisitos</a></li> <li><strong>0.1</strong> <a href=#01-protocolo-e-como-estudiar-este-modulo>Protocolo E: CÃ³mo estudiar este mÃ³dulo</a></li> <li><strong>0.2</strong> <a href=#02-entregables-verificables-minimo-viable>Entregables verificables (mÃ­nimo viable)</a></li> <li><strong>0.3</strong> <a href=#03-puente-teoria-codigo-portafolio>Puente teorÃ­a â†” cÃ³digo (Portafolio)</a></li> <li><a href=#71-por-que-pipelines>Â¿Por QuÃ© Pipelines?</a></li> <li><a href=#72-columntransformer-transformaciones-paralelas>ColumnTransformer: Transformaciones Paralelas</a></li> <li><a href=#73-custom-transformers-tu-superpoder>Custom Transformers</a></li> <li><a href=#74-pipeline-completo-codigo-real>Pipeline Completo: CÃ³digo Real</a></li> <li><a href=#75-ejercicios-practicos>Ejercicios PrÃ¡cticos</a></li> <li><a href=#76-ingenieria-inversa-pipelines>ğŸ”¬ IngenierÃ­a Inversa: ColumnTransformer</a> â­ NUEVO</li> <li><a href=#errores-habituales>Errores habituales</a></li> <li><a href=#checkpoint>âœ… Checkpoint</a></li> </ul> <hr> <p><a id=71-por-que-pipelines></a></p> <h2 id=71-por-que-pipelines>7.1 Â¿Por QuÃ© Pipelines?<a class=headerlink href=#71-por-que-pipelines title="Permanent link">&para;</a></h2> <h3 id=la-analogia-de-la-linea-de-ensamblaje>La AnalogÃ­a de la LÃ­nea de Ensamblaje<a class=headerlink href=#la-analogia-de-la-linea-de-ensamblaje title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>â•‘  ğŸ­ IMAGINA UNA FÃBRICA DE AUTOS:                                         â•‘
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>â•‘                                                                           â•‘
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>â•‘  SIN LÃNEA DE ENSAMBLAJE (cÃ³digo suelto):                                 â•‘
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>â•‘  â€¢ Trabajador 1 pone ruedas, pero a veces se le olvida                    â•‘
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>â•‘  â€¢ Trabajador 2 pinta, pero usa colores diferentes cada dÃ­a               â•‘
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>â•‘  â€¢ Trabajador 3 instala motor, pero a veces del modelo equivocado         â•‘
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>â•‘  â€¢ Resultado: Cada auto es diferente, imposible de mantener               â•‘
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>â•‘                                                                           â•‘
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>â•‘  CON LÃNEA DE ENSAMBLAJE (Pipeline):                                      â•‘
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>â•‘  â€¢ Paso 1: Chasis â†’ Paso 2: Motor â†’ Paso 3: Pintura â†’ Paso 4: Ruedas      â•‘
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>â•‘  â€¢ Cada paso estÃ¡ definido y es SIEMPRE igual                             â•‘
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>â•‘  â€¢ El proceso completo es una sola unidad                                 â•‘
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>â•‘  â€¢ Resultado: Todos los autos son consistentes                            â•‘
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>â•‘                                                                           â•‘
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>â•‘  sklearn Pipeline = LÃ­nea de ensamblaje para ML                           â•‘
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre></div> <h3 id=el-problema-real-training-serving-skew>El Problema Real: Training-Serving Skew<a class=headerlink href=#el-problema-real-training-serving-skew title="Permanent link">&para;</a></h3> <p><div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># âŒ CÃ“DIGO PROBLEMÃTICO (muy comÃºn en notebooks convertidos a producciÃ³n)</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=c1># === ENTRENAMIENTO ===</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>  <span class=c1># Importa transformadores de sklearn.</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=c1># Ajustar scaler en datos de entrenamiento</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>                                  <span class=c1># Crea instancia: aÃºn no tiene parÃ¡metros learned.</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>X_train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>[</span><span class=n>num_cols</span><span class=p>])</span>   <span class=c1># fit_transform: calcula mean/std Y transforma.</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=n>encoder</span> <span class=o>=</span> <span class=n>OneHotEncoder</span><span class=p>()</span>                                  <span class=c1># Crea encoder para convertir categorÃ­as a binario.</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=n>X_train_encoded</span> <span class=o>=</span> <span class=n>encoder</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_train</span><span class=p>[</span><span class=n>cat_cols</span><span class=p>])</span> <span class=c1># fit: aprende categorÃ­as Ãºnicas; transform: aplica.</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=c1># Entrenar modelo</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>()</span>                           <span class=c1># Crea el modelo de clasificaciÃ³n.</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_processed</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>                      <span class=c1># Entrena con datos ya transformados.</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=c1># Guardar modelo... pero Â¿y el scaler? Â¿y el encoder?</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=s2>&quot;model.pkl&quot;</span><span class=p>)</span>  <span class=c1># â† Â¡ERROR! Solo guarda el modelo, NO los transformadores.</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=c1># === PRODUCCIÃ“N (meses despuÃ©s, otro desarrollador) ===</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=n>model</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;model.pkl&quot;</span><span class=p>)</span>                           <span class=c1># Carga solo el modelo.</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=c1># Â¿CÃ³mo transformo los datos nuevos?</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=c1># ğŸ¤· No tengo el scaler ni el encoder fitted             # Los transformadores se perdieron.</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=c1># ğŸ¤· Incluso si los tuviera, Â¿cÃ³mo sÃ© quÃ© columnas usar? # No hay documentaciÃ³n de las columnas.</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=c1># ğŸ¤· Â¿Era StandardScaler o MinMaxScaler?                 # Imposible saber quÃ© se usÃ³.</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=c1># &quot;SoluciÃ³n&quot; del desarrollador desesperado:</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>                                  <span class=c1># Crea NUEVO scaler (sin los parÃ¡metros originales).</span>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=n>X_new_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_new</span><span class=p>[</span><span class=n>num_cols</span><span class=p>])</span>       <span class=c1># fit en datos NUEVOS: mean/std DIFERENTES.</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=c1># âš ï¸ Ahora mean y std son DIFERENTES a los de entrenamiento â†’ training-serving skew.</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=c1># âš ï¸ Las predicciones son BASURA porque la escala es inconsistente.</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=c1># ============================================================================</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=c1># âœ… SOLUCIÃ“N: Pipeline Unificado</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=c1># ============================================================================</span>
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a>
<a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a><span class=c1># === ENTRENAMIENTO ===</span>
<a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>              <span class=c1># Pipeline: encadena pasos secuenciales.</span>
<a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>      <span class=c1># ColumnTransformer: aplica transformaciones por grupo de columnas.</span>
<a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a>
<a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a><span class=c1># Definir pipeline completo</span>
<a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>                              <span class=c1># Lista de tuplas (nombre, objeto).</span>
<a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a>    <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>ColumnTransformer</span><span class=p>([</span>           <span class=c1># Primer paso: preprocesamiento por columnas.</span>
<a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a>        <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>(),</span> <span class=n>num_cols</span><span class=p>),</span>       <span class=c1># Escala numÃ©ricas (aprende mean/std de train).</span>
<a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a>        <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>),</span> <span class=n>cat_cols</span><span class=p>)</span>  <span class=c1># One-hot categorÃ­cas; ignore evita crash.</span>
<a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a>    <span class=p>])),</span>
<a id=__codelineno-2-48 name=__codelineno-2-48 href=#__codelineno-2-48></a>    <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>            <span class=c1># Segundo paso: el modelo.</span>
<a id=__codelineno-2-49 name=__codelineno-2-49 href=#__codelineno-2-49></a><span class=p>])</span>
<a id=__codelineno-2-50 name=__codelineno-2-50 href=#__codelineno-2-50></a>
<a id=__codelineno-2-51 name=__codelineno-2-51 href=#__codelineno-2-51></a><span class=c1># Un solo fit entrena TODO</span>
<a id=__codelineno-2-52 name=__codelineno-2-52 href=#__codelineno-2-52></a><span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>                     <span class=c1># fit() propaga por todos los pasos: transforma Y entrena.</span>
<a id=__codelineno-2-53 name=__codelineno-2-53 href=#__codelineno-2-53></a>
<a id=__codelineno-2-54 name=__codelineno-2-54 href=#__codelineno-2-54></a><span class=c1># Guardar TODO junto</span>
<a id=__codelineno-2-55 name=__codelineno-2-55 href=#__codelineno-2-55></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=s2>&quot;pipeline.pkl&quot;</span><span class=p>)</span>              <span class=c1># Serializa Scaler + Encoder + Model en UN archivo.</span>
<a id=__codelineno-2-56 name=__codelineno-2-56 href=#__codelineno-2-56></a>
<a id=__codelineno-2-57 name=__codelineno-2-57 href=#__codelineno-2-57></a><span class=c1># === PRODUCCIÃ“N ===</span>
<a id=__codelineno-2-58 name=__codelineno-2-58 href=#__codelineno-2-58></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;pipeline.pkl&quot;</span><span class=p>)</span>             <span class=c1># Carga todo: transformadores YA fitted + modelo.</span>
<a id=__codelineno-2-59 name=__codelineno-2-59 href=#__codelineno-2-59></a>
<a id=__codelineno-2-60 name=__codelineno-2-60 href=#__codelineno-2-60></a><span class=c1># Una sola llamada hace TODO (con los parÃ¡metros de entrenamiento)</span>
<a id=__codelineno-2-61 name=__codelineno-2-61 href=#__codelineno-2-61></a><span class=n>predictions</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_new</span><span class=p>)</span>              <span class=c1># predict() internamente transforma X_new y luego predice.</span>
<a id=__codelineno-2-62 name=__codelineno-2-62 href=#__codelineno-2-62></a>
<a id=__codelineno-2-63 name=__codelineno-2-63 href=#__codelineno-2-63></a><span class=c1># âœ… El scaler usa mean/std del entrenamiento      â†’ Consistencia garantizada.</span>
<a id=__codelineno-2-64 name=__codelineno-2-64 href=#__codelineno-2-64></a><span class=c1># âœ… El encoder conoce las categorÃ­as del entrenamiento â†’ No crash por categorÃ­as nuevas.</span>
<a id=__codelineno-2-65 name=__codelineno-2-65 href=#__codelineno-2-65></a><span class=c1># âœ… Las predicciones son consistentes             â†’ Sin training-serving skew.</span>
<a id=__codelineno-2-66 name=__codelineno-2-66 href=#__codelineno-2-66></a>
<a id=__codelineno-2-67 name=__codelineno-2-67 href=#__codelineno-2-67></a><span class=c1>### ğŸ§  Mapa Mental de Conceptos: sklearn Pipelines</span>
</code></pre></div> â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â•‘ SKLEARN PIPELINES PARA MLOPS â•‘ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–¼ â–¼ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Pipeline â”‚ â”‚ColumnTransformer â”‚ â”‚ Custom Transform â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”œâ”€ Pasos secuenciales â”œâ”€ Transforma paralelo â”œâ”€ BaseEstimator â”œâ”€ fit/transform/predict â”œâ”€ Por grupos de columnas â”œâ”€ TransformerMixin â”œâ”€ Serializable como 1 objeto â”œâ”€ num/cat/text/etc â”œâ”€ fit/transform â””â”€ Evita training-serving skew â””â”€ Combina resultados â””â”€ Tu lÃ³gica custom <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>**TÃ©rminos clave que debes dominar:**
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>| TÃ©rmino | Significado | Ejemplo |
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>|---------|-------------|---------|
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>| **Pipeline** | Cadena de pasos (transformadores + modelo) | `Pipeline([(&#39;scaler&#39;, ...), (&#39;model&#39;, ...)])` |
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>| **ColumnTransformer** | Aplica diferentes transformaciones a diferentes columnas | NumÃ©ricas â†’ Scaler, CategÃ³ricas â†’ OneHot |
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>| **Training-Serving Skew** | Diferencia entre preprocesamiento en train y producciÃ³n | Scaler con diferente mean/std |
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>| **fit_transform** | Aprende parÃ¡metros Y transforma (solo en training) | `scaler.fit_transform(X_train)` |
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>| **transform** | Solo transforma con parÃ¡metros aprendidos (producciÃ³n) | `scaler.transform(X_new)` |
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>---
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>### ğŸ’» Ejercicio Puente: Pipeline BÃ¡sico
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>&gt; **Meta**: Antes de crear pipelines complejos, domina el patrÃ³n bÃ¡sico.
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>**Ejercicio 1: Pipeline mÃ­nimo**
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>```python
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>from sklearn.pipeline import Pipeline
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>from sklearn.preprocessing import StandardScaler
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>from sklearn.linear_model import LogisticRegression
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a># TU TAREA: Crea un pipeline con scaler + modelo
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>pipeline = Pipeline([
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>    # paso 1: escalar
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>    # paso 2: modelo
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>])
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a># Entrenar
<a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a>pipeline.fit(X_train, y_train)
<a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a>
<a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a># Predecir (Â¿necesitas transformar X_test manualmente?)
<a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a>predictions = pipeline.predict(X_test)
</code></pre></div></p> <p><strong>Ejercicio 2: Guardar y cargar</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=c1># Guardar</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=s2>&quot;pipeline.pkl&quot;</span><span class=p>)</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=c1># En otro script/proceso</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=n>pipeline_loaded</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;pipeline.pkl&quot;</span><span class=p>)</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=c1># TU TAREA: Â¿QuÃ© contiene pipeline_loaded?</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=c1># Â¿Necesitas re-entrenar el scaler?</span>
</code></pre></div></p> <details> <summary>ğŸ” Ver SoluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Ejercicio 1</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>LogisticRegression</span><span class=p>())</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=p>])</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=n>predictions</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=c1># NO necesitas transformar X_test manualmente</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=c1># pipeline.predict() lo hace internamente</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=c1># Ejercicio 2</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=c1># pipeline_loaded contiene:</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=c1># - StandardScaler YA fitted (con mean/std de X_train)</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=c1># - LogisticRegression YA entrenado</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=c1># NO necesitas re-entrenar nada</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=c1># Puedes predecir directamente</span>
</code></pre></div> </details> <hr> <h3 id=practica-del-portafolio-pipeline-de-bankchurn>ğŸ› ï¸ PrÃ¡ctica del Portafolio: Pipeline de BankChurn<a class=headerlink href=#practica-del-portafolio-pipeline-de-bankchurn title="Permanent link">&para;</a></h3> <blockquote> <p><strong>Tarea</strong>: Explorar y entender el pipeline de BankChurn-Predictor.</p> </blockquote> <p><strong>Paso 1: Localiza el pipeline</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nb>cd</span><span class=w> </span>BankChurn-Predictor
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>find<span class=w> </span>.<span class=w> </span>-name<span class=w> </span><span class=s2>&quot;*.pkl&quot;</span><span class=w> </span>-o<span class=w> </span>-name<span class=w> </span><span class=s2>&quot;pipeline*&quot;</span>
</code></pre></div></p> <p><strong>Paso 2: Inspecciona la estructura</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;artifacts/pipeline.pkl&quot;</span><span class=p>)</span>  <span class=c1># o ruta correcta</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=nb>print</span><span class=p>(</span><span class=n>pipeline</span><span class=p>)</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=nb>print</span><span class=p>(</span><span class=n>pipeline</span><span class=o>.</span><span class=n>named_steps</span><span class=p>)</span>
</code></pre></div></p> <p><strong>Paso 3: Entiende los pasos</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Â¿QuÃ© transformador se usa para numÃ©ricas?</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=c1># Â¿QuÃ© encoder para categÃ³ricas?</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=c1># Â¿QuÃ© modelo final?</span>
</code></pre></div></p> <p><strong>Paso 4: Verifica consistencia</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># Carga datos de test</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=c1># Â¿pipeline.predict() funciona sin preprocesamiento manual?</span>
</code></pre></div></p> <hr> <h3 id=checkpoint-de-conocimiento-pipelines>âœ… Checkpoint de Conocimiento: Pipelines<a class=headerlink href=#checkpoint-de-conocimiento-pipelines title="Permanent link">&para;</a></h3> <p><strong>Pregunta 1</strong>: Â¿CuÃ¡l es la ventaja principal de guardar <code>pipeline.pkl</code> vs <code>model.pkl</code>?</p> <p>A) Es mÃ¡s pequeÃ±o<br> B) Incluye preprocesamiento con parÃ¡metros de entrenamiento<br> C) Es mÃ¡s rÃ¡pido<br> D) sklearn lo requiere </p> <p><strong>Pregunta 2</strong>: Â¿QuÃ© hace <code>ColumnTransformer</code>?</p> <p>A) Transforma una columna<br> B) Aplica DIFERENTES transformaciones a DIFERENTES grupos de columnas en paralelo<br> C) Concatena DataFrames<br> D) Filtra columnas </p> <p><strong>Pregunta 3</strong>: Si usas <code>OneHotEncoder(handle_unknown='ignore')</code>, Â¿quÃ© pasa con una categorÃ­a nueva en producciÃ³n?</p> <p>A) Error<br> B) Se ignora (todos los valores de esa categorÃ­a serÃ¡n 0)<br> C) Se crea una nueva columna<br> D) El modelo se reentrena </p> <p><strong>ğŸ”§ Escenario de Debugging:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Training</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=s2>&quot;pipeline.pkl&quot;</span><span class=p>)</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=c1># Production (meses despuÃ©s)</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;pipeline.pkl&quot;</span><span class=p>)</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=n>X_new</span> <span class=o>=</span> <span class=n>get_new_data</span><span class=p>()</span>  <span class=c1># Nuevo request</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=n>pred</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_new</span><span class=p>)</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=c1># ERROR: ValueError: columns in X are different from training</span>
</code></pre></div> <p><strong>Â¿CuÃ¡l es el problema y cÃ³mo lo solucionarÃ­as?</strong></p> <details> <summary>ğŸ” Ver Respuestas</summary> **Pregunta 1**: B) Incluye preprocesamiento con parÃ¡metros de entrenamiento. Sin esto, tienes training-serving skew. **Pregunta 2**: B) Aplica DIFERENTES transformaciones a DIFERENTES grupos de columnas en paralelo. **Pregunta 3**: B) Se ignora. La fila tendrÃ¡ 0s en todas las columnas de esa feature. Mejor que crashear. **Escenario de Debugging**: - **Problema**: X_new tiene columnas diferentes (nombre, orden, o cantidad) que X_train. - **SoluciÃ³n**: 1. Asegurar que X_new tenga EXACTAMENTE las mismas columnas que X_train 2. Usar Pydantic para validar el schema de entrada 3. Documentar las columnas esperadas <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>expected_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;CreditScore&#39;</span><span class=p>,</span> <span class=s1>&#39;Age&#39;</span><span class=p>,</span> <span class=s1>&#39;Balance&#39;</span><span class=p>,</span> <span class=o>...</span><span class=p>]</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=n>X_new</span> <span class=o>=</span> <span class=n>X_new</span><span class=p>[</span><span class=n>expected_cols</span><span class=p>]</span>  <span class=c1># Seleccionar y ordenar</span>
</code></pre></div> </details> <p><div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>---
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>&lt;a id=&quot;72-columntransformer-transformaciones-paralelas&quot;&gt;&lt;/a&gt;
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>## 7.2 ColumnTransformer: Transformaciones Paralelas
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>### El Problema: Diferentes Columnas, Diferentes Tratamientos
</code></pre></div> Datos de un banco: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ CreditScore â”‚ Geography â”‚ Gender â”‚ Age â”‚ Balanceâ”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ 619 â”‚ France â”‚ Female â”‚ 42 â”‚ 10000 â”‚ â”‚ 608 â”‚ Spain â”‚ Female â”‚ 41 â”‚ 83808 â”‚ â”‚ 502 â”‚ France â”‚ Female â”‚ 42 â”‚ 0 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜</p> <p>Columnas numÃ©ricas (CreditScore, Age, Balance): â†’ StandardScaler: normalizar a mean=0, std=1</p> <p>Columnas categÃ³ricas (Geography, Gender): â†’ OneHotEncoder: convertir a columnas binarias <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>### ColumnTransformer: La SoluciÃ³n Elegante
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>```python
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>from sklearn.compose import ColumnTransformer        # Enruta transformaciones por grupos de columnas.
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>from sklearn.preprocessing import StandardScaler, OneHotEncoder  # Transformadores estÃ¡ndar.
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>from sklearn.impute import SimpleImputer             # Imputa valores faltantes (NaN).
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>from sklearn.pipeline import Pipeline                # Encadena pasos secuenciales.
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a># Definir quÃ© columnas son de cada tipo
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>num_cols = [&quot;CreditScore&quot;, &quot;Age&quot;, &quot;Tenure&quot;, &quot;Balance&quot;, &quot;NumOfProducts&quot;, &quot;EstimatedSalary&quot;]  # NumÃ©ricas.
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>cat_cols = [&quot;Geography&quot;, &quot;Gender&quot;]                   # CategÃ³ricas: valores discretos/textuales.
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a># Pipeline para numÃ©ricas: Imputar NaN â†’ Escalar
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>num_pipeline = Pipeline([                            # Pipeline DENTRO de ColumnTransformer.
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>    (&#39;imputer&#39;, SimpleImputer(strategy=&#39;median&#39;)),   # Rellena NaN con mediana (robusto a outliers).
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>    (&#39;scaler&#39;, StandardScaler())                     # Normaliza a mean=0, std=1.
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>])
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a># Pipeline para categÃ³ricas: Imputar NaN â†’ One-Hot
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>cat_pipeline = Pipeline([
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>    (&#39;imputer&#39;, SimpleImputer(strategy=&#39;constant&#39;, fill_value=&#39;Unknown&#39;)),  # NaN â†’ string &quot;Unknown&quot;.
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>    (&#39;encoder&#39;, OneHotEncoder(handle_unknown=&#39;ignore&#39;))  # ignore: categorÃ­as nuevas â†’ vector de ceros.
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>])
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a># ColumnTransformer: Aplica cada pipeline a sus columnas
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>preprocessor = ColumnTransformer(
<a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>    transformers=[                                   # Lista de transformadores.
<a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a>        (&#39;num&#39;, num_pipeline, num_cols),             # (nombre, transformer, columnas_a_transformar).
<a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>        (&#39;cat&#39;, cat_pipeline, cat_cols)              # Cada grupo se procesa independientemente.
<a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a>    ],
<a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>    remainder=&#39;drop&#39;                                 # &#39;drop&#39;: elimina columnas no listadas. &#39;passthrough&#39;: las deja.
<a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a>)
<a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a>
<a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a># Resultado: Un solo objeto que sabe transformar todo
<a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a>X_processed = preprocessor.fit_transform(X_train)   # fit: aprende parÃ¡metros; transform: aplica.
</code></pre></div></p> <h3 id=visualizacion-del-flujo>VisualizaciÃ³n del Flujo<a class=headerlink href=#visualizacion-del-flujo title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>                        ColumnTransformer
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>                              â”‚
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>              â”‚               â”‚               â”‚
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>              â–¼               â–¼               â–¼
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>        num_pipeline    cat_pipeline      remainder
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>              â”‚               â”‚               â”‚
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>              â”‚               â”‚               â”‚
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚               â”‚
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>    â”‚                   â”‚     â”‚               â”‚
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a>    â–¼                   â–¼     â–¼               â–¼
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   drop
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a>â”‚Imputer  â”‚       â”‚ Scaler  â”‚ â”‚ Imputer â”‚
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a>â”‚(median) â”‚       â”‚         â”‚ â”‚(Unknown)â”‚
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a>                                   â”‚
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a>                                   â–¼
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a>                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a>                              â”‚ OneHot  â”‚
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a>                              â”‚ Encoder â”‚
<a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a>                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a>                                   â”‚
<a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a>              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a>              â”‚                    â”‚                    â”‚
<a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a>              â–¼                    â–¼                    â–¼
<a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a>    [6 columnas numÃ©ricas]  [3 Geography cols]  [2 Gender cols]
<a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a>         escaladas            (France, Spain,     (Female, Male)
<a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a>                               Germany)
<a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a>
<a id=__codelineno-14-30 name=__codelineno-14-30 href=#__codelineno-14-30></a>    Output: 11 columnas totales (6 + 3 + 2)
</code></pre></div> <hr> <p><a id=73-custom-transformers-tu-superpoder></a></p> <h2 id=73-custom-transformers-tu-superpoder>7.3 Custom Transformers: Tu Superpoder<a class=headerlink href=#73-custom-transformers-tu-superpoder title="Permanent link">&para;</a></h2> <h3 id=cuando-crear-un-custom-transformer>Â¿CuÃ¡ndo Crear un Custom Transformer?<a class=headerlink href=#cuando-crear-un-custom-transformer title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>â•‘  Crea un Custom Transformer cuando:                                       â•‘
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>â•‘                                                                           â•‘
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>â•‘  âœ… Necesitas feature engineering especÃ­fico del dominio                  â•‘
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>â•‘  âœ… La transformaciÃ³n debe aplicarse igual en train y producciÃ³n          â•‘
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>â•‘  âœ… sklearn no tiene un transformer que haga lo que necesitas             â•‘
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>â•‘                                                                           â•‘
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>â•‘  Ejemplos del portafolio:                                                 â•‘
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>â•‘  â€¢ CarVision: Calcular vehicle_age desde model_year                       â•‘
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>â•‘  â€¢ CarVision: Extraer brand desde model                                   â•‘
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>â•‘  â€¢ BankChurn: Resampling para clases desbalanceadas                       â•‘
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre></div> <h3 id=ejemplo-1-featureengineer-carvision>Ejemplo 1: FeatureEngineer (CarVision)<a class=headerlink href=#ejemplo-1-featureengineer-carvision title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1># src/carvision/features.py - CÃ³digo REAL del portafolio</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=kn>from</span><span class=w> </span><span class=nn>__future__</span><span class=w> </span><span class=kn>import</span> <span class=n>annotations</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Optional</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=k>class</span><span class=w> </span><span class=nc>FeatureEngineer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=sd>    Centralized feature engineering to ensure consistency across</span>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=sd>    Training, Inference, and Analysis.</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=sd>    Este transformer garantiza que las mismas transformaciones</span>
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=sd>    se apliquen en:</span>
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=sd>    1. Entrenamiento (training.py)</span>
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a><span class=sd>    2. Inferencia API (fastapi_app.py)</span>
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=sd>    3. Dashboard (streamlit_app.py)</span>
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=sd>    Attributes</span>
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=sd>    ----------</span>
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a><span class=sd>    current_year : int, optional</span>
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a><span class=sd>        AÃ±o para calcular vehicle_age. Si None, usa aÃ±o actual.</span>
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a>
<a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=sd>    Examples</span>
<a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=sd>    --------</span>
<a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a><span class=sd>    &gt;&gt;&gt; fe = FeatureEngineer(current_year=2024)</span>
<a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class=sd>    &gt;&gt;&gt; df_transformed = fe.fit_transform(df)</span>
<a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=sd>    &gt;&gt;&gt; print(df_transformed.columns)</span>
<a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class=sd>    # Incluye: vehicle_age, brand (derivadas de model_year y model)</span>
<a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a>
<a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>current_year</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a>        <span class=bp>self</span><span class=o>.</span><span class=n>current_year</span> <span class=o>=</span> <span class=n>current_year</span>
<a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a>
<a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;FeatureEngineer&quot;</span><span class=p>:</span>
<a id=__codelineno-16-39 name=__codelineno-16-39 href=#__codelineno-16-39></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Fit no hace nada (stateless transformer).&quot;&quot;&quot;</span>
<a id=__codelineno-16-40 name=__codelineno-16-40 href=#__codelineno-16-40></a>        <span class=c1># Este transformer es stateless: no aprende nada de los datos</span>
<a id=__codelineno-16-41 name=__codelineno-16-41 href=#__codelineno-16-41></a>        <span class=c1># Solo necesita fit() para ser compatible con Pipeline</span>
<a id=__codelineno-16-42 name=__codelineno-16-42 href=#__codelineno-16-42></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-16-43 name=__codelineno-16-43 href=#__codelineno-16-43></a>
<a id=__codelineno-16-44 name=__codelineno-16-44 href=#__codelineno-16-44></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<a id=__codelineno-16-45 name=__codelineno-16-45 href=#__codelineno-16-45></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Aplica feature engineering.</span>
<a id=__codelineno-16-46 name=__codelineno-16-46 href=#__codelineno-16-46></a>
<a id=__codelineno-16-47 name=__codelineno-16-47 href=#__codelineno-16-47></a><span class=sd>        Features creadas:</span>
<a id=__codelineno-16-48 name=__codelineno-16-48 href=#__codelineno-16-48></a><span class=sd>        - vehicle_age: current_year - model_year</span>
<a id=__codelineno-16-49 name=__codelineno-16-49 href=#__codelineno-16-49></a><span class=sd>        - brand: primera palabra de model</span>
<a id=__codelineno-16-50 name=__codelineno-16-50 href=#__codelineno-16-50></a><span class=sd>        - price_per_mile: price / odometer (solo si price existe)</span>
<a id=__codelineno-16-51 name=__codelineno-16-51 href=#__codelineno-16-51></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-16-52 name=__codelineno-16-52 href=#__codelineno-16-52></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>  <span class=c1># â† Nunca modificar el input original</span>
<a id=__codelineno-16-53 name=__codelineno-16-53 href=#__codelineno-16-53></a>
<a id=__codelineno-16-54 name=__codelineno-16-54 href=#__codelineno-16-54></a>        <span class=c1># Usar aÃ±o configurado o aÃ±o actual</span>
<a id=__codelineno-16-55 name=__codelineno-16-55 href=#__codelineno-16-55></a>        <span class=n>year</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>current_year</span> <span class=ow>or</span> <span class=n>pd</span><span class=o>.</span><span class=n>Timestamp</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>year</span>
<a id=__codelineno-16-56 name=__codelineno-16-56 href=#__codelineno-16-56></a>
<a id=__codelineno-16-57 name=__codelineno-16-57 href=#__codelineno-16-57></a>        <span class=c1># Feature: Edad del vehÃ­culo</span>
<a id=__codelineno-16-58 name=__codelineno-16-58 href=#__codelineno-16-58></a>        <span class=k>if</span> <span class=s2>&quot;model_year&quot;</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-16-59 name=__codelineno-16-59 href=#__codelineno-16-59></a>            <span class=n>X</span><span class=p>[</span><span class=s2>&quot;vehicle_age&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>year</span> <span class=o>-</span> <span class=n>X</span><span class=p>[</span><span class=s2>&quot;model_year&quot;</span><span class=p>]</span>
<a id=__codelineno-16-60 name=__codelineno-16-60 href=#__codelineno-16-60></a>
<a id=__codelineno-16-61 name=__codelineno-16-61 href=#__codelineno-16-61></a>        <span class=c1># Feature: Marca (primera palabra del modelo)</span>
<a id=__codelineno-16-62 name=__codelineno-16-62 href=#__codelineno-16-62></a>        <span class=k>if</span> <span class=s2>&quot;model&quot;</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-16-63 name=__codelineno-16-63 href=#__codelineno-16-63></a>            <span class=n>X</span><span class=p>[</span><span class=s2>&quot;brand&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=s2>&quot;model&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>split</span><span class=p>()</span><span class=o>.</span><span class=n>str</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-16-64 name=__codelineno-16-64 href=#__codelineno-16-64></a>
<a id=__codelineno-16-65 name=__codelineno-16-65 href=#__codelineno-16-65></a>        <span class=c1># Features derivadas (solo en training, no en inferencia)</span>
<a id=__codelineno-16-66 name=__codelineno-16-66 href=#__codelineno-16-66></a>        <span class=c1># Porque price no estÃ¡ disponible en inferencia</span>
<a id=__codelineno-16-67 name=__codelineno-16-67 href=#__codelineno-16-67></a>        <span class=k>if</span> <span class=s2>&quot;odometer&quot;</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span> <span class=ow>and</span> <span class=s2>&quot;price&quot;</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-16-68 name=__codelineno-16-68 href=#__codelineno-16-68></a>            <span class=n>X</span><span class=p>[</span><span class=s2>&quot;price_per_mile&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=s2>&quot;price&quot;</span><span class=p>]</span> <span class=o>/</span> <span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=s2>&quot;odometer&quot;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-16-69 name=__codelineno-16-69 href=#__codelineno-16-69></a>
<a id=__codelineno-16-70 name=__codelineno-16-70 href=#__codelineno-16-70></a>        <span class=k>return</span> <span class=n>X</span>
<a id=__codelineno-16-71 name=__codelineno-16-71 href=#__codelineno-16-71></a>
<a id=__codelineno-16-72 name=__codelineno-16-72 href=#__codelineno-16-72></a>    <span class=c1># MÃ©todos opcionales para mejor introspecciÃ³n</span>
<a id=__codelineno-16-73 name=__codelineno-16-73 href=#__codelineno-16-73></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_feature_names_out</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_features</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-16-74 name=__codelineno-16-74 href=#__codelineno-16-74></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Retorna nombres de features de salida.&quot;&quot;&quot;</span>
<a id=__codelineno-16-75 name=__codelineno-16-75 href=#__codelineno-16-75></a>        <span class=n>base</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>input_features</span><span class=p>)</span> <span class=k>if</span> <span class=n>input_features</span> <span class=k>else</span> <span class=p>[]</span>
<a id=__codelineno-16-76 name=__codelineno-16-76 href=#__codelineno-16-76></a>        <span class=k>return</span> <span class=n>base</span> <span class=o>+</span> <span class=p>[</span><span class=s2>&quot;vehicle_age&quot;</span><span class=p>,</span> <span class=s2>&quot;brand&quot;</span><span class=p>]</span>
</code></pre></div> <h3 id=ejemplo-2-resampleclassifier-bankchurn>Ejemplo 2: ResampleClassifier (BankChurn)<a class=headerlink href=#ejemplo-2-resampleclassifier-bankchurn title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c1># src/bankchurn/models.py - CÃ³digo REAL del portafolio</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=kn>from</span><span class=w> </span><span class=nn>__future__</span><span class=w> </span><span class=kn>import</span> <span class=n>annotations</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>ClassifierMixin</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.utils.validation</span><span class=w> </span><span class=kn>import</span> <span class=n>check_is_fitted</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=k>class</span><span class=w> </span><span class=nc>ResampleClassifier</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>ClassifierMixin</span><span class=p>):</span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Custom classifier with resampling for imbalanced datasets.</span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=sd>    Implementa oversampling (SMOTE), undersampling, y class weighting</span>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=sd>    para mejorar performance en clasificaciÃ³n desbalanceada.</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=sd>    Este wrapper permite:</span>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=sd>    1. Probar diferentes estrategias de resampling fÃ¡cilmente</span>
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=sd>    2. Mantener la interfaz sklearn estÃ¡ndar (fit/predict)</span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=sd>    3. Ser parte de un Pipeline (incluyendo GridSearchCV)</span>
<a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a>
<a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=sd>    Parameters</span>
<a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=sd>    ----------</span>
<a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a><span class=sd>    estimator : estimator object, optional</span>
<a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=sd>        Clasificador base. Si None, usa LogisticRegression.</span>
<a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a><span class=sd>    strategy : {&quot;none&quot;, &quot;oversample&quot;, &quot;undersample&quot;, &quot;class_weight&quot;}</span>
<a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a><span class=sd>        Estrategia de resampling:</span>
<a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a><span class=sd>        - &quot;none&quot;: Sin resampling</span>
<a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=sd>        - &quot;oversample&quot;: SMOTE oversampling de clase minoritaria</span>
<a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a><span class=sd>        - &quot;undersample&quot;: Undersampling de clase mayoritaria</span>
<a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a><span class=sd>        - &quot;class_weight&quot;: Balanceo automÃ¡tico de pesos</span>
<a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a><span class=sd>    random_state : int, default=42</span>
<a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a><span class=sd>        Semilla para reproducibilidad.</span>
<a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a>
<a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a><span class=sd>    Examples</span>
<a id=__codelineno-17-36 name=__codelineno-17-36 href=#__codelineno-17-36></a><span class=sd>    --------</span>
<a id=__codelineno-17-37 name=__codelineno-17-37 href=#__codelineno-17-37></a><span class=sd>    &gt;&gt;&gt; clf = ResampleClassifier(</span>
<a id=__codelineno-17-38 name=__codelineno-17-38 href=#__codelineno-17-38></a><span class=sd>    ...     estimator=RandomForestClassifier(),</span>
<a id=__codelineno-17-39 name=__codelineno-17-39 href=#__codelineno-17-39></a><span class=sd>    ...     strategy=&quot;oversample&quot;,</span>
<a id=__codelineno-17-40 name=__codelineno-17-40 href=#__codelineno-17-40></a><span class=sd>    ...     random_state=42</span>
<a id=__codelineno-17-41 name=__codelineno-17-41 href=#__codelineno-17-41></a><span class=sd>    ... )</span>
<a id=__codelineno-17-42 name=__codelineno-17-42 href=#__codelineno-17-42></a><span class=sd>    &gt;&gt;&gt; clf.fit(X_train, y_train)</span>
<a id=__codelineno-17-43 name=__codelineno-17-43 href=#__codelineno-17-43></a><span class=sd>    &gt;&gt;&gt; predictions = clf.predict(X_test)</span>
<a id=__codelineno-17-44 name=__codelineno-17-44 href=#__codelineno-17-44></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-17-45 name=__codelineno-17-45 href=#__codelineno-17-45></a>
<a id=__codelineno-17-46 name=__codelineno-17-46 href=#__codelineno-17-46></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span>
<a id=__codelineno-17-47 name=__codelineno-17-47 href=#__codelineno-17-47></a>        <span class=bp>self</span><span class=p>,</span>
<a id=__codelineno-17-48 name=__codelineno-17-48 href=#__codelineno-17-48></a>        <span class=n>estimator</span><span class=p>:</span> <span class=n>BaseEstimator</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-17-49 name=__codelineno-17-49 href=#__codelineno-17-49></a>        <span class=n>strategy</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;none&quot;</span><span class=p>,</span>
<a id=__codelineno-17-50 name=__codelineno-17-50 href=#__codelineno-17-50></a>        <span class=n>random_state</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>42</span><span class=p>,</span>
<a id=__codelineno-17-51 name=__codelineno-17-51 href=#__codelineno-17-51></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-17-52 name=__codelineno-17-52 href=#__codelineno-17-52></a>        <span class=bp>self</span><span class=o>.</span><span class=n>estimator</span> <span class=o>=</span> <span class=n>estimator</span>
<a id=__codelineno-17-53 name=__codelineno-17-53 href=#__codelineno-17-53></a>        <span class=bp>self</span><span class=o>.</span><span class=n>strategy</span> <span class=o>=</span> <span class=n>strategy</span>
<a id=__codelineno-17-54 name=__codelineno-17-54 href=#__codelineno-17-54></a>        <span class=bp>self</span><span class=o>.</span><span class=n>random_state</span> <span class=o>=</span> <span class=n>random_state</span>
<a id=__codelineno-17-55 name=__codelineno-17-55 href=#__codelineno-17-55></a>
<a id=__codelineno-17-56 name=__codelineno-17-56 href=#__codelineno-17-56></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=s2>&quot;ResampleClassifier&quot;</span><span class=p>:</span>
<a id=__codelineno-17-57 name=__codelineno-17-57 href=#__codelineno-17-57></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Entrena el clasificador con resampling opcional.&quot;&quot;&quot;</span>
<a id=__codelineno-17-58 name=__codelineno-17-58 href=#__codelineno-17-58></a>        <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
<a id=__codelineno-17-59 name=__codelineno-17-59 href=#__codelineno-17-59></a>
<a id=__codelineno-17-60 name=__codelineno-17-60 href=#__codelineno-17-60></a>        <span class=c1># Inicializar estimador si no se proporcionÃ³</span>
<a id=__codelineno-17-61 name=__codelineno-17-61 href=#__codelineno-17-61></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimator</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-17-62 name=__codelineno-17-62 href=#__codelineno-17-62></a>            <span class=bp>self</span><span class=o>.</span><span class=n>estimator_</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>random_state</span><span class=p>)</span>
<a id=__codelineno-17-63 name=__codelineno-17-63 href=#__codelineno-17-63></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-17-64 name=__codelineno-17-64 href=#__codelineno-17-64></a>            <span class=c1># Clonar para no modificar el original</span>
<a id=__codelineno-17-65 name=__codelineno-17-65 href=#__codelineno-17-65></a>            <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>clone</span>
<a id=__codelineno-17-66 name=__codelineno-17-66 href=#__codelineno-17-66></a>            <span class=bp>self</span><span class=o>.</span><span class=n>estimator_</span> <span class=o>=</span> <span class=n>clone</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>estimator</span><span class=p>)</span>
<a id=__codelineno-17-67 name=__codelineno-17-67 href=#__codelineno-17-67></a>
<a id=__codelineno-17-68 name=__codelineno-17-68 href=#__codelineno-17-68></a>        <span class=c1># Guardar clases (requerido por sklearn)</span>
<a id=__codelineno-17-69 name=__codelineno-17-69 href=#__codelineno-17-69></a>        <span class=bp>self</span><span class=o>.</span><span class=n>classes_</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<a id=__codelineno-17-70 name=__codelineno-17-70 href=#__codelineno-17-70></a>
<a id=__codelineno-17-71 name=__codelineno-17-71 href=#__codelineno-17-71></a>        <span class=c1># Aplicar estrategia de resampling</span>
<a id=__codelineno-17-72 name=__codelineno-17-72 href=#__codelineno-17-72></a>        <span class=n>X_resampled</span><span class=p>,</span> <span class=n>y_resampled</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_apply_resampling</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-17-73 name=__codelineno-17-73 href=#__codelineno-17-73></a>
<a id=__codelineno-17-74 name=__codelineno-17-74 href=#__codelineno-17-74></a>        <span class=c1># Entrenar estimador base</span>
<a id=__codelineno-17-75 name=__codelineno-17-75 href=#__codelineno-17-75></a>        <span class=bp>self</span><span class=o>.</span><span class=n>estimator_</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_resampled</span><span class=p>,</span> <span class=n>y_resampled</span><span class=p>)</span>
<a id=__codelineno-17-76 name=__codelineno-17-76 href=#__codelineno-17-76></a>
<a id=__codelineno-17-77 name=__codelineno-17-77 href=#__codelineno-17-77></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-17-78 name=__codelineno-17-78 href=#__codelineno-17-78></a>
<a id=__codelineno-17-79 name=__codelineno-17-79 href=#__codelineno-17-79></a>    <span class=k>def</span><span class=w> </span><span class=nf>_apply_resampling</span><span class=p>(</span>
<a id=__codelineno-17-80 name=__codelineno-17-80 href=#__codelineno-17-80></a>        <span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span>
<a id=__codelineno-17-81 name=__codelineno-17-81 href=#__codelineno-17-81></a>    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]:</span>
<a id=__codelineno-17-82 name=__codelineno-17-82 href=#__codelineno-17-82></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Aplica la estrategia de resampling.&quot;&quot;&quot;</span>
<a id=__codelineno-17-83 name=__codelineno-17-83 href=#__codelineno-17-83></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>strategy</span> <span class=o>==</span> <span class=s2>&quot;none&quot;</span><span class=p>:</span>
<a id=__codelineno-17-84 name=__codelineno-17-84 href=#__codelineno-17-84></a>            <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span>
<a id=__codelineno-17-85 name=__codelineno-17-85 href=#__codelineno-17-85></a>
<a id=__codelineno-17-86 name=__codelineno-17-86 href=#__codelineno-17-86></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>strategy</span> <span class=o>==</span> <span class=s2>&quot;oversample&quot;</span><span class=p>:</span>
<a id=__codelineno-17-87 name=__codelineno-17-87 href=#__codelineno-17-87></a>            <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-17-88 name=__codelineno-17-88 href=#__codelineno-17-88></a>                <span class=kn>from</span><span class=w> </span><span class=nn>imblearn.over_sampling</span><span class=w> </span><span class=kn>import</span> <span class=n>SMOTE</span>
<a id=__codelineno-17-89 name=__codelineno-17-89 href=#__codelineno-17-89></a>                <span class=n>smote</span> <span class=o>=</span> <span class=n>SMOTE</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>random_state</span><span class=p>)</span>
<a id=__codelineno-17-90 name=__codelineno-17-90 href=#__codelineno-17-90></a>                <span class=k>return</span> <span class=n>smote</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-17-91 name=__codelineno-17-91 href=#__codelineno-17-91></a>            <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
<a id=__codelineno-17-92 name=__codelineno-17-92 href=#__codelineno-17-92></a>                <span class=c1># Si imblearn no estÃ¡ instalado, ignorar</span>
<a id=__codelineno-17-93 name=__codelineno-17-93 href=#__codelineno-17-93></a>                <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span>
<a id=__codelineno-17-94 name=__codelineno-17-94 href=#__codelineno-17-94></a>
<a id=__codelineno-17-95 name=__codelineno-17-95 href=#__codelineno-17-95></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>strategy</span> <span class=o>==</span> <span class=s2>&quot;undersample&quot;</span><span class=p>:</span>
<a id=__codelineno-17-96 name=__codelineno-17-96 href=#__codelineno-17-96></a>            <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-17-97 name=__codelineno-17-97 href=#__codelineno-17-97></a>                <span class=kn>from</span><span class=w> </span><span class=nn>imblearn.under_sampling</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomUnderSampler</span>
<a id=__codelineno-17-98 name=__codelineno-17-98 href=#__codelineno-17-98></a>                <span class=n>rus</span> <span class=o>=</span> <span class=n>RandomUnderSampler</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>random_state</span><span class=p>)</span>
<a id=__codelineno-17-99 name=__codelineno-17-99 href=#__codelineno-17-99></a>                <span class=k>return</span> <span class=n>rus</span><span class=o>.</span><span class=n>fit_resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-17-100 name=__codelineno-17-100 href=#__codelineno-17-100></a>            <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
<a id=__codelineno-17-101 name=__codelineno-17-101 href=#__codelineno-17-101></a>                <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span>
<a id=__codelineno-17-102 name=__codelineno-17-102 href=#__codelineno-17-102></a>
<a id=__codelineno-17-103 name=__codelineno-17-103 href=#__codelineno-17-103></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>strategy</span> <span class=o>==</span> <span class=s2>&quot;class_weight&quot;</span><span class=p>:</span>
<a id=__codelineno-17-104 name=__codelineno-17-104 href=#__codelineno-17-104></a>            <span class=c1># No modifica datos, el estimador maneja los pesos</span>
<a id=__codelineno-17-105 name=__codelineno-17-105 href=#__codelineno-17-105></a>            <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>estimator_</span><span class=p>,</span> <span class=s1>&#39;class_weight&#39;</span><span class=p>):</span>
<a id=__codelineno-17-106 name=__codelineno-17-106 href=#__codelineno-17-106></a>                <span class=bp>self</span><span class=o>.</span><span class=n>estimator_</span><span class=o>.</span><span class=n>set_params</span><span class=p>(</span><span class=n>class_weight</span><span class=o>=</span><span class=s1>&#39;balanced&#39;</span><span class=p>)</span>
<a id=__codelineno-17-107 name=__codelineno-17-107 href=#__codelineno-17-107></a>            <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span>
<a id=__codelineno-17-108 name=__codelineno-17-108 href=#__codelineno-17-108></a>
<a id=__codelineno-17-109 name=__codelineno-17-109 href=#__codelineno-17-109></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-17-110 name=__codelineno-17-110 href=#__codelineno-17-110></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Unknown strategy: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>strategy</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-17-111 name=__codelineno-17-111 href=#__codelineno-17-111></a>
<a id=__codelineno-17-112 name=__codelineno-17-112 href=#__codelineno-17-112></a>    <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
<a id=__codelineno-17-113 name=__codelineno-17-113 href=#__codelineno-17-113></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Predice clases.&quot;&quot;&quot;</span>
<a id=__codelineno-17-114 name=__codelineno-17-114 href=#__codelineno-17-114></a>        <span class=n>check_is_fitted</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;estimator_&#39;</span><span class=p>,</span> <span class=s1>&#39;classes_&#39;</span><span class=p>])</span>
<a id=__codelineno-17-115 name=__codelineno-17-115 href=#__codelineno-17-115></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimator_</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<a id=__codelineno-17-116 name=__codelineno-17-116 href=#__codelineno-17-116></a>
<a id=__codelineno-17-117 name=__codelineno-17-117 href=#__codelineno-17-117></a>    <span class=k>def</span><span class=w> </span><span class=nf>predict_proba</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
<a id=__codelineno-17-118 name=__codelineno-17-118 href=#__codelineno-17-118></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Predice probabilidades.&quot;&quot;&quot;</span>
<a id=__codelineno-17-119 name=__codelineno-17-119 href=#__codelineno-17-119></a>        <span class=n>check_is_fitted</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;estimator_&#39;</span><span class=p>,</span> <span class=s1>&#39;classes_&#39;</span><span class=p>])</span>
<a id=__codelineno-17-120 name=__codelineno-17-120 href=#__codelineno-17-120></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>estimator_</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</code></pre></div> <h3 id=la-plantilla-crea-tu-propio-transformer>La Plantilla: Crea Tu Propio Transformer<a class=headerlink href=#la-plantilla-crea-tu-propio-transformer title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=k>class</span><span class=w> </span><span class=nc>MiTransformer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=sd>    Plantilla para crear transformers custom.</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=sd>    REGLAS IMPORTANTES:</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=sd>    1. __init__ solo guarda parÃ¡metros (no computa nada)</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=sd>    2. fit() aprende de los datos (puede ser no-op)</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=sd>    3. transform() aplica la transformaciÃ³n</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=sd>    4. Nunca modificar input, siempre X.copy()</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>param1</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;default&quot;</span><span class=p>,</span> <span class=n>param2</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>10</span><span class=p>):</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a>        <span class=c1># Solo guardar parÃ¡metros, NO computar nada</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>param1</span> <span class=o>=</span> <span class=n>param1</span>
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a>        <span class=bp>self</span><span class=o>.</span><span class=n>param2</span> <span class=o>=</span> <span class=n>param2</span>
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a>
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Aprende de los datos (opcional).</span>
<a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a>
<a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=sd>        Ejemplos de quÃ© aprender:</span>
<a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=sd>        - Media/std para normalizaciÃ³n</span>
<a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a><span class=sd>        - Vocabulario para encoding</span>
<a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a><span class=sd>        - Umbrales para binning</span>
<a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a>        <span class=c1># Si el transformer es stateless, solo retorna self</span>
<a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a>        <span class=c1># Si aprende algo:</span>
<a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a>        <span class=c1># self.learned_param_ = compute_something(X)</span>
<a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a>
<a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Aplica la transformaciÃ³n.&quot;&quot;&quot;</span>
<a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>  <span class=c1># â† Siempre copiar</span>
<a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a>        <span class=c1># ... tu lÃ³gica de transformaciÃ³n ...</span>
<a id=__codelineno-18-36 name=__codelineno-18-36 href=#__codelineno-18-36></a>        <span class=k>return</span> <span class=n>X</span>
</code></pre></div> <hr> <p><a id=74-pipeline-completo-codigo-real></a></p> <h2 id=74-pipeline-completo-codigo-real>7.4 Pipeline Completo: CÃ³digo Real<a class=headerlink href=#74-pipeline-completo-codigo-real title="Permanent link">&para;</a></h2> <h3 id=carvision-el-pipeline-de-3-etapas>CarVision: El Pipeline de 3 Etapas<a class=headerlink href=#carvision-el-pipeline-de-3-etapas title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># src/carvision/training.py - Pipeline REAL del portafolio</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestRegressor</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=kn>from</span><span class=w> </span><span class=nn>src.carvision.features</span><span class=w> </span><span class=kn>import</span> <span class=n>FeatureEngineer</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=k>def</span><span class=w> </span><span class=nf>build_pipeline</span><span class=p>(</span><span class=n>cfg</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Construye el pipeline completo de CarVision.</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=sd>    Estructura: Features â†’ Preprocessing â†’ Model</span>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=sd>    Esta arquitectura de 3 etapas garantiza:</span>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=sd>    1. Feature engineering consistente (FeatureEngineer)</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=sd>    2. Preprocesamiento apropiado por tipo de columna (ColumnTransformer)</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=sd>    3. Modelo entrenado con datos correctamente transformados</span>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a>    <span class=c1># ParÃ¡metros de configuraciÃ³n</span>
<a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a>    <span class=n>num_cols</span> <span class=o>=</span> <span class=n>cfg</span><span class=p>[</span><span class=s2>&quot;preprocessing&quot;</span><span class=p>][</span><span class=s2>&quot;numeric_features&quot;</span><span class=p>]</span>
<a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a>    <span class=n>cat_cols</span> <span class=o>=</span> <span class=n>cfg</span><span class=p>[</span><span class=s2>&quot;preprocessing&quot;</span><span class=p>][</span><span class=s2>&quot;categorical_features&quot;</span><span class=p>]</span>
<a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a>    <span class=n>dataset_year</span> <span class=o>=</span> <span class=n>cfg</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;dataset_year&quot;</span><span class=p>,</span> <span class=mi>2024</span><span class=p>)</span>
<a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a>    <span class=n>rf_params</span> <span class=o>=</span> <span class=n>cfg</span><span class=p>[</span><span class=s2>&quot;training&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;random_forest_params&quot;</span><span class=p>,</span> <span class=p>{})</span>
<a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a>
<a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a>    <span class=c1># Etapa 1: Feature Engineering</span>
<a id=__codelineno-19-28 name=__codelineno-19-28 href=#__codelineno-19-28></a>    <span class=n>feature_engineer</span> <span class=o>=</span> <span class=n>FeatureEngineer</span><span class=p>(</span><span class=n>current_year</span><span class=o>=</span><span class=n>dataset_year</span><span class=p>)</span>
<a id=__codelineno-19-29 name=__codelineno-19-29 href=#__codelineno-19-29></a>
<a id=__codelineno-19-30 name=__codelineno-19-30 href=#__codelineno-19-30></a>    <span class=c1># Etapa 2: Preprocessing (despuÃ©s de feature engineering)</span>
<a id=__codelineno-19-31 name=__codelineno-19-31 href=#__codelineno-19-31></a>    <span class=c1># Nota: Las columnas aquÃ­ son las que EXISTEN despuÃ©s del FeatureEngineer</span>
<a id=__codelineno-19-32 name=__codelineno-19-32 href=#__codelineno-19-32></a>    <span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
<a id=__codelineno-19-33 name=__codelineno-19-33 href=#__codelineno-19-33></a>        <span class=n>transformers</span><span class=o>=</span><span class=p>[</span>
<a id=__codelineno-19-34 name=__codelineno-19-34 href=#__codelineno-19-34></a>            <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-19-35 name=__codelineno-19-35 href=#__codelineno-19-35></a>                <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
<a id=__codelineno-19-36 name=__codelineno-19-36 href=#__codelineno-19-36></a>                <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>
<a id=__codelineno-19-37 name=__codelineno-19-37 href=#__codelineno-19-37></a>            <span class=p>]),</span> <span class=n>num_cols</span><span class=p>),</span>
<a id=__codelineno-19-38 name=__codelineno-19-38 href=#__codelineno-19-38></a>            <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-19-39 name=__codelineno-19-39 href=#__codelineno-19-39></a>                <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;most_frequent&#39;</span><span class=p>)),</span>
<a id=__codelineno-19-40 name=__codelineno-19-40 href=#__codelineno-19-40></a>                <span class=p>(</span><span class=s1>&#39;encoder&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>,</span> <span class=n>sparse_output</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
<a id=__codelineno-19-41 name=__codelineno-19-41 href=#__codelineno-19-41></a>            <span class=p>]),</span> <span class=n>cat_cols</span><span class=p>)</span>
<a id=__codelineno-19-42 name=__codelineno-19-42 href=#__codelineno-19-42></a>        <span class=p>],</span>
<a id=__codelineno-19-43 name=__codelineno-19-43 href=#__codelineno-19-43></a>        <span class=n>remainder</span><span class=o>=</span><span class=s1>&#39;drop&#39;</span>
<a id=__codelineno-19-44 name=__codelineno-19-44 href=#__codelineno-19-44></a>    <span class=p>)</span>
<a id=__codelineno-19-45 name=__codelineno-19-45 href=#__codelineno-19-45></a>
<a id=__codelineno-19-46 name=__codelineno-19-46 href=#__codelineno-19-46></a>    <span class=c1># Etapa 3: Modelo</span>
<a id=__codelineno-19-47 name=__codelineno-19-47 href=#__codelineno-19-47></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestRegressor</span><span class=p>(</span><span class=o>**</span><span class=n>rf_params</span><span class=p>)</span>
<a id=__codelineno-19-48 name=__codelineno-19-48 href=#__codelineno-19-48></a>
<a id=__codelineno-19-49 name=__codelineno-19-49 href=#__codelineno-19-49></a>    <span class=c1># Pipeline completo: Una sola unidad entrenable/guardable</span>
<a id=__codelineno-19-50 name=__codelineno-19-50 href=#__codelineno-19-50></a>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-19-51 name=__codelineno-19-51 href=#__codelineno-19-51></a>        <span class=p>(</span><span class=s1>&#39;features&#39;</span><span class=p>,</span> <span class=n>feature_engineer</span><span class=p>),</span>    <span class=c1># Crea vehicle_age, brand</span>
<a id=__codelineno-19-52 name=__codelineno-19-52 href=#__codelineno-19-52></a>        <span class=p>(</span><span class=s1>&#39;pre&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>              <span class=c1># Escala y encoda</span>
<a id=__codelineno-19-53 name=__codelineno-19-53 href=#__codelineno-19-53></a>        <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>model</span><span class=p>)</span>                    <span class=c1># Predice</span>
<a id=__codelineno-19-54 name=__codelineno-19-54 href=#__codelineno-19-54></a>    <span class=p>])</span>
<a id=__codelineno-19-55 name=__codelineno-19-55 href=#__codelineno-19-55></a>
<a id=__codelineno-19-56 name=__codelineno-19-56 href=#__codelineno-19-56></a>    <span class=k>return</span> <span class=n>pipeline</span>
<a id=__codelineno-19-57 name=__codelineno-19-57 href=#__codelineno-19-57></a>
<a id=__codelineno-19-58 name=__codelineno-19-58 href=#__codelineno-19-58></a>
<a id=__codelineno-19-59 name=__codelineno-19-59 href=#__codelineno-19-59></a><span class=c1># === USO ===</span>
<a id=__codelineno-19-60 name=__codelineno-19-60 href=#__codelineno-19-60></a><span class=c1># Entrenamiento</span>
<a id=__codelineno-19-61 name=__codelineno-19-61 href=#__codelineno-19-61></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>build_pipeline</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
<a id=__codelineno-19-62 name=__codelineno-19-62 href=#__codelineno-19-62></a><span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-19-63 name=__codelineno-19-63 href=#__codelineno-19-63></a>
<a id=__codelineno-19-64 name=__codelineno-19-64 href=#__codelineno-19-64></a><span class=c1># Guardar TODO junto</span>
<a id=__codelineno-19-65 name=__codelineno-19-65 href=#__codelineno-19-65></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=s2>&quot;artifacts/model.joblib&quot;</span><span class=p>)</span>
<a id=__codelineno-19-66 name=__codelineno-19-66 href=#__codelineno-19-66></a>
<a id=__codelineno-19-67 name=__codelineno-19-67 href=#__codelineno-19-67></a><span class=c1># ProducciÃ³n</span>
<a id=__codelineno-19-68 name=__codelineno-19-68 href=#__codelineno-19-68></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;artifacts/model.joblib&quot;</span><span class=p>)</span>
<a id=__codelineno-19-69 name=__codelineno-19-69 href=#__codelineno-19-69></a><span class=n>price</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_new</span><span class=p>)</span>  <span class=c1># Una llamada hace TODO</span>
</code></pre></div> <h3 id=bankchurn-pipeline-con-ensemble>BankChurn: Pipeline con Ensemble<a class=headerlink href=#bankchurn-pipeline-con-ensemble title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1># src/bankchurn/training.py - Pipeline REAL del portafolio</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=k>def</span><span class=w> </span><span class=nf>build_pipeline</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Construye el pipeline de BankChurn.</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=sd>    Estructura:</span>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=sd>    - Preprocessing: ColumnTransformer (num + cat)</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=sd>    - Model: VotingClassifier o ResampleClassifier</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>    <span class=c1># Columnas desde config</span>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a>    <span class=n>num_cols</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>numerical_features</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a>    <span class=n>cat_cols</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>categorical_features</span>
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a>
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a>    <span class=c1># Preprocessing</span>
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a>    <span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
<a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a>        <span class=n>transformers</span><span class=o>=</span><span class=p>[</span>
<a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a>            <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a>                <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
<a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a>                <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>
<a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a>            <span class=p>]),</span> <span class=n>num_cols</span><span class=p>),</span>
<a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a>            <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a>                <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;constant&#39;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=s1>&#39;Unknown&#39;</span><span class=p>)),</span>
<a id=__codelineno-20-23 name=__codelineno-20-23 href=#__codelineno-20-23></a>                <span class=p>(</span><span class=s1>&#39;encoder&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>))</span>
<a id=__codelineno-20-24 name=__codelineno-20-24 href=#__codelineno-20-24></a>            <span class=p>]),</span> <span class=n>cat_cols</span><span class=p>)</span>
<a id=__codelineno-20-25 name=__codelineno-20-25 href=#__codelineno-20-25></a>        <span class=p>]</span>
<a id=__codelineno-20-26 name=__codelineno-20-26 href=#__codelineno-20-26></a>    <span class=p>)</span>
<a id=__codelineno-20-27 name=__codelineno-20-27 href=#__codelineno-20-27></a>
<a id=__codelineno-20-28 name=__codelineno-20-28 href=#__codelineno-20-28></a>    <span class=c1># Modelo: Ensemble o single model</span>
<a id=__codelineno-20-29 name=__codelineno-20-29 href=#__codelineno-20-29></a>    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=s2>&quot;ensemble&quot;</span><span class=p>:</span>
<a id=__codelineno-20-30 name=__codelineno-20-30 href=#__codelineno-20-30></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>VotingClassifier</span><span class=p>(</span>
<a id=__codelineno-20-31 name=__codelineno-20-31 href=#__codelineno-20-31></a>            <span class=n>estimators</span><span class=o>=</span><span class=p>[</span>
<a id=__codelineno-20-32 name=__codelineno-20-32 href=#__codelineno-20-32></a>                <span class=p>(</span><span class=s1>&#39;lr&#39;</span><span class=p>,</span> <span class=n>LogisticRegression</span><span class=p>(</span>
<a id=__codelineno-20-33 name=__codelineno-20-33 href=#__codelineno-20-33></a>                    <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>logistic_regression</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
<a id=__codelineno-20-34 name=__codelineno-20-34 href=#__codelineno-20-34></a>                <span class=p>)),</span>
<a id=__codelineno-20-35 name=__codelineno-20-35 href=#__codelineno-20-35></a>                <span class=p>(</span><span class=s1>&#39;rf&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span>
<a id=__codelineno-20-36 name=__codelineno-20-36 href=#__codelineno-20-36></a>                    <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>random_forest</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
<a id=__codelineno-20-37 name=__codelineno-20-37 href=#__codelineno-20-37></a>                <span class=p>))</span>
<a id=__codelineno-20-38 name=__codelineno-20-38 href=#__codelineno-20-38></a>            <span class=p>],</span>
<a id=__codelineno-20-39 name=__codelineno-20-39 href=#__codelineno-20-39></a>            <span class=n>voting</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>ensemble</span><span class=o>.</span><span class=n>voting</span><span class=p>,</span>
<a id=__codelineno-20-40 name=__codelineno-20-40 href=#__codelineno-20-40></a>            <span class=n>weights</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>ensemble</span><span class=o>.</span><span class=n>weights</span>
<a id=__codelineno-20-41 name=__codelineno-20-41 href=#__codelineno-20-41></a>        <span class=p>)</span>
<a id=__codelineno-20-42 name=__codelineno-20-42 href=#__codelineno-20-42></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-20-43 name=__codelineno-20-43 href=#__codelineno-20-43></a>        <span class=c1># Con wrapper de resampling</span>
<a id=__codelineno-20-44 name=__codelineno-20-44 href=#__codelineno-20-44></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>ResampleClassifier</span><span class=p>(</span>
<a id=__codelineno-20-45 name=__codelineno-20-45 href=#__codelineno-20-45></a>            <span class=n>estimator</span><span class=o>=</span><span class=n>RandomForestClassifier</span><span class=p>(</span>
<a id=__codelineno-20-46 name=__codelineno-20-46 href=#__codelineno-20-46></a>                <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>random_forest</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span>
<a id=__codelineno-20-47 name=__codelineno-20-47 href=#__codelineno-20-47></a>            <span class=p>),</span>
<a id=__codelineno-20-48 name=__codelineno-20-48 href=#__codelineno-20-48></a>            <span class=n>strategy</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>resampling_strategy</span><span class=p>,</span>
<a id=__codelineno-20-49 name=__codelineno-20-49 href=#__codelineno-20-49></a>            <span class=n>random_state</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>random_state</span>
<a id=__codelineno-20-50 name=__codelineno-20-50 href=#__codelineno-20-50></a>        <span class=p>)</span>
<a id=__codelineno-20-51 name=__codelineno-20-51 href=#__codelineno-20-51></a>
<a id=__codelineno-20-52 name=__codelineno-20-52 href=#__codelineno-20-52></a>    <span class=c1># Pipeline final</span>
<a id=__codelineno-20-53 name=__codelineno-20-53 href=#__codelineno-20-53></a>    <span class=k>return</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-20-54 name=__codelineno-20-54 href=#__codelineno-20-54></a>        <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
<a id=__codelineno-20-55 name=__codelineno-20-55 href=#__codelineno-20-55></a>        <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>model</span><span class=p>)</span>
<a id=__codelineno-20-56 name=__codelineno-20-56 href=#__codelineno-20-56></a>    <span class=p>])</span>
</code></pre></div> <hr> <p><a id=75-ejercicios-practicos></a></p> <h2 id=75-ejercicios-practicos>7.5 Ejercicios PrÃ¡cticos<a class=headerlink href=#75-ejercicios-practicos title="Permanent link">&para;</a></h2> <h3 id=ejercicio-1-construir-un-columntransformer>Ejercicio 1: Construir un ColumnTransformer<a class=headerlink href=#ejercicio-1-construir-un-columntransformer title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># Datos de telecom:</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=c1># - calls: float (numÃ©rico)</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=c1># - minutes: float (numÃ©rico)</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=c1># - messages: int (numÃ©rico)</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=c1># - mb_used: float (numÃ©rico)</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=c1># - plan_type: str (categÃ³rico) - &quot;basic&quot;, &quot;premium&quot;</span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=c1># - region: str (categÃ³rico) - &quot;north&quot;, &quot;south&quot;, &quot;east&quot;, &quot;west&quot;</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=c1># Tu tarea: Crea un ColumnTransformer que:</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=c1># 1. Escale las columnas numÃ©ricas con StandardScaler</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=c1># 2. Encode las columnas categÃ³ricas con OneHotEncoder</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=c1># 3. Maneje valores faltantes apropiadamente</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=n>num_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;calls&quot;</span><span class=p>,</span> <span class=s2>&quot;minutes&quot;</span><span class=p>,</span> <span class=s2>&quot;messages&quot;</span><span class=p>,</span> <span class=s2>&quot;mb_used&quot;</span><span class=p>]</span>
<a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a><span class=n>cat_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;plan_type&quot;</span><span class=p>,</span> <span class=s2>&quot;region&quot;</span><span class=p>]</span>
<a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a>
<a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a><span class=c1># Escribe tu cÃ³digo aquÃ­:</span>
<a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
<a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a>    <span class=c1># ...</span>
<a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a><span class=p>)</span>
</code></pre></div> <details> <summary>ğŸ“ Ver SoluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=n>num_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;calls&quot;</span><span class=p>,</span> <span class=s2>&quot;minutes&quot;</span><span class=p>,</span> <span class=s2>&quot;messages&quot;</span><span class=p>,</span> <span class=s2>&quot;mb_used&quot;</span><span class=p>]</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=n>cat_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;plan_type&quot;</span><span class=p>,</span> <span class=s2>&quot;region&quot;</span><span class=p>]</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>    <span class=n>transformers</span><span class=o>=</span><span class=p>[</span>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>        <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a>            <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
<a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a>            <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>
<a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a>        <span class=p>]),</span> <span class=n>num_cols</span><span class=p>),</span>
<a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a>        <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a>            <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;most_frequent&#39;</span><span class=p>)),</span>
<a id=__codelineno-22-17 name=__codelineno-22-17 href=#__codelineno-22-17></a>            <span class=p>(</span><span class=s1>&#39;encoder&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>,</span> <span class=n>sparse_output</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
<a id=__codelineno-22-18 name=__codelineno-22-18 href=#__codelineno-22-18></a>        <span class=p>]),</span> <span class=n>cat_cols</span><span class=p>)</span>
<a id=__codelineno-22-19 name=__codelineno-22-19 href=#__codelineno-22-19></a>    <span class=p>],</span>
<a id=__codelineno-22-20 name=__codelineno-22-20 href=#__codelineno-22-20></a>    <span class=n>remainder</span><span class=o>=</span><span class=s1>&#39;drop&#39;</span>
<a id=__codelineno-22-21 name=__codelineno-22-21 href=#__codelineno-22-21></a><span class=p>)</span>
<a id=__codelineno-22-22 name=__codelineno-22-22 href=#__codelineno-22-22></a>
<a id=__codelineno-22-23 name=__codelineno-22-23 href=#__codelineno-22-23></a><span class=c1># Verificar</span>
<a id=__codelineno-22-24 name=__codelineno-22-24 href=#__codelineno-22-24></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Transformers: </span><span class=si>{</span><span class=p>[</span><span class=n>t</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=ow>in</span><span class=w> </span><span class=n>preprocessor</span><span class=o>.</span><span class=n>transformers</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-22-25 name=__codelineno-22-25 href=#__codelineno-22-25></a><span class=c1># Output: [&#39;num&#39;, &#39;cat&#39;]</span>
</code></pre></div> </details> <hr> <h3 id=ejercicio-2-crear-un-custom-transformer>Ejercicio 2: Crear un Custom Transformer<a class=headerlink href=#ejercicio-2-crear-un-custom-transformer title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=c1># Tu tarea: Crea un transformer que calcule ratios de uso de telecom</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=c1># </span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=c1># Features a crear:</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=c1># - minutes_per_call = minutes / (calls + 1)</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=c1># - mb_per_message = mb_used / (messages + 1)</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=c1># - total_usage = calls + messages + (mb_used / 1000)</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=c1>#</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=c1># Requisitos:</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=c1># - Debe heredar de BaseEstimator y TransformerMixin</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=c1># - fit() debe retornar self</span>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=c1># - transform() debe retornar DataFrame con nuevas columnas</span>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>
<a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a><span class=k>class</span><span class=w> </span><span class=nc>TelecomFeatureEngineer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a>    <span class=c1># Tu cÃ³digo aquÃ­</span>
<a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a>    <span class=k>pass</span>
</code></pre></div> <details> <summary>ğŸ“ Ver SoluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=k>class</span><span class=w> </span><span class=nc>TelecomFeatureEngineer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Feature engineering para datos de telecom.&quot;&quot;&quot;</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>        <span class=k>pass</span>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;No aprende nada (stateless).&quot;&quot;&quot;</span>
<a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a>
<a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Crea features derivadas.&quot;&quot;&quot;</span>
<a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a>
<a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a>        <span class=c1># Minutos por llamada</span>
<a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a>        <span class=k>if</span> <span class=s2>&quot;minutes&quot;</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span> <span class=ow>and</span> <span class=s2>&quot;calls&quot;</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a>            <span class=n>X</span><span class=p>[</span><span class=s2>&quot;minutes_per_call&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=s2>&quot;minutes&quot;</span><span class=p>]</span> <span class=o>/</span> <span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=s2>&quot;calls&quot;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a>
<a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a>        <span class=c1># MB por mensaje</span>
<a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a>        <span class=k>if</span> <span class=s2>&quot;mb_used&quot;</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span> <span class=ow>and</span> <span class=s2>&quot;messages&quot;</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a>            <span class=n>X</span><span class=p>[</span><span class=s2>&quot;mb_per_message&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=s2>&quot;mb_used&quot;</span><span class=p>]</span> <span class=o>/</span> <span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=s2>&quot;messages&quot;</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a>
<a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a>        <span class=c1># Uso total normalizado</span>
<a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a>        <span class=k>if</span> <span class=nb>all</span><span class=p>(</span><span class=n>col</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;calls&quot;</span><span class=p>,</span> <span class=s2>&quot;messages&quot;</span><span class=p>,</span> <span class=s2>&quot;mb_used&quot;</span><span class=p>]):</span>
<a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a>            <span class=n>X</span><span class=p>[</span><span class=s2>&quot;total_usage&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=s2>&quot;calls&quot;</span><span class=p>]</span> <span class=o>+</span> <span class=n>X</span><span class=p>[</span><span class=s2>&quot;messages&quot;</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=s2>&quot;mb_used&quot;</span><span class=p>]</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>)</span>
<a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a>
<a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a>        <span class=k>return</span> <span class=n>X</span>
<a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a>
<a id=__codelineno-24-33 name=__codelineno-24-33 href=#__codelineno-24-33></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_feature_names_out</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_features</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-24-34 name=__codelineno-24-34 href=#__codelineno-24-34></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Retorna nombres de features creadas.&quot;&quot;&quot;</span>
<a id=__codelineno-24-35 name=__codelineno-24-35 href=#__codelineno-24-35></a>        <span class=k>return</span> <span class=p>[</span><span class=s2>&quot;minutes_per_call&quot;</span><span class=p>,</span> <span class=s2>&quot;mb_per_message&quot;</span><span class=p>,</span> <span class=s2>&quot;total_usage&quot;</span><span class=p>]</span>
<a id=__codelineno-24-36 name=__codelineno-24-36 href=#__codelineno-24-36></a>
<a id=__codelineno-24-37 name=__codelineno-24-37 href=#__codelineno-24-37></a>
<a id=__codelineno-24-38 name=__codelineno-24-38 href=#__codelineno-24-38></a><span class=c1># Verificar</span>
<a id=__codelineno-24-39 name=__codelineno-24-39 href=#__codelineno-24-39></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-24-40 name=__codelineno-24-40 href=#__codelineno-24-40></a>
<a id=__codelineno-24-41 name=__codelineno-24-41 href=#__codelineno-24-41></a><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
<a id=__codelineno-24-42 name=__codelineno-24-42 href=#__codelineno-24-42></a>    <span class=s2>&quot;calls&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span>
<a id=__codelineno-24-43 name=__codelineno-24-43 href=#__codelineno-24-43></a>    <span class=s2>&quot;minutes&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>200</span><span class=p>,</span> <span class=mi>500</span><span class=p>],</span>
<a id=__codelineno-24-44 name=__codelineno-24-44 href=#__codelineno-24-44></a>    <span class=s2>&quot;messages&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
<a id=__codelineno-24-45 name=__codelineno-24-45 href=#__codelineno-24-45></a>    <span class=s2>&quot;mb_used&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5000</span><span class=p>,</span> <span class=mi>10000</span><span class=p>]</span>
<a id=__codelineno-24-46 name=__codelineno-24-46 href=#__codelineno-24-46></a><span class=p>})</span>
<a id=__codelineno-24-47 name=__codelineno-24-47 href=#__codelineno-24-47></a>
<a id=__codelineno-24-48 name=__codelineno-24-48 href=#__codelineno-24-48></a><span class=n>fe</span> <span class=o>=</span> <span class=n>TelecomFeatureEngineer</span><span class=p>()</span>
<a id=__codelineno-24-49 name=__codelineno-24-49 href=#__codelineno-24-49></a><span class=n>df_transformed</span> <span class=o>=</span> <span class=n>fe</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
<a id=__codelineno-24-50 name=__codelineno-24-50 href=#__codelineno-24-50></a><span class=nb>print</span><span class=p>(</span><span class=n>df_transformed</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>
<a id=__codelineno-24-51 name=__codelineno-24-51 href=#__codelineno-24-51></a><span class=c1># Output incluye: minutes_per_call, mb_per_message, total_usage</span>
</code></pre></div> </details> <hr> <h3 id=ejercicio-3-pipeline-completo-para-telecomai>Ejercicio 3: Pipeline Completo para TelecomAI<a class=headerlink href=#ejercicio-3-pipeline-completo-para-telecomai title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=c1># Tu tarea: Construye un pipeline completo para TelecomAI</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=c1># </span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=c1># Estructura:</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=c1># 1. TelecomFeatureEngineer (del ejercicio anterior)</span>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=c1># 2. ColumnTransformer para preprocessing</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=c1># 3. LogisticRegression como modelo</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=c1>#</span>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=c1># El pipeline debe ser guardable con joblib</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a>
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=c1># Tu cÃ³digo aquÃ­:</span>
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=k>def</span><span class=w> </span><span class=nf>build_telecom_pipeline</span><span class=p>():</span>
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a>    <span class=k>pass</span>
</code></pre></div> <details> <summary>ğŸ“ Ver SoluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=k>def</span><span class=w> </span><span class=nf>build_telecom_pipeline</span><span class=p>(</span><span class=n>config</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Construye pipeline completo para TelecomAI.&quot;&quot;&quot;</span>
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a>
<a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a>    <span class=c1># ConfiguraciÃ³n por defecto</span>
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a>    <span class=k>if</span> <span class=n>config</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a>        <span class=n>config</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a>            <span class=s2>&quot;num_cols&quot;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&quot;calls&quot;</span><span class=p>,</span> <span class=s2>&quot;minutes&quot;</span><span class=p>,</span> <span class=s2>&quot;messages&quot;</span><span class=p>,</span> <span class=s2>&quot;mb_used&quot;</span><span class=p>,</span> 
<a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a>                        <span class=s2>&quot;minutes_per_call&quot;</span><span class=p>,</span> <span class=s2>&quot;mb_per_message&quot;</span><span class=p>,</span> <span class=s2>&quot;total_usage&quot;</span><span class=p>],</span>
<a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a>            <span class=s2>&quot;cat_cols&quot;</span><span class=p>:</span> <span class=p>[],</span>
<a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a>            <span class=s2>&quot;random_state&quot;</span><span class=p>:</span> <span class=mi>42</span>
<a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a>        <span class=p>}</span>
<a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a>
<a id=__codelineno-26-21 name=__codelineno-26-21 href=#__codelineno-26-21></a>    <span class=n>num_cols</span> <span class=o>=</span> <span class=n>config</span><span class=p>[</span><span class=s2>&quot;num_cols&quot;</span><span class=p>]</span>
<a id=__codelineno-26-22 name=__codelineno-26-22 href=#__codelineno-26-22></a>    <span class=n>cat_cols</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;cat_cols&quot;</span><span class=p>,</span> <span class=p>[])</span>
<a id=__codelineno-26-23 name=__codelineno-26-23 href=#__codelineno-26-23></a>
<a id=__codelineno-26-24 name=__codelineno-26-24 href=#__codelineno-26-24></a>    <span class=c1># Etapa 1: Feature Engineering</span>
<a id=__codelineno-26-25 name=__codelineno-26-25 href=#__codelineno-26-25></a>    <span class=n>feature_engineer</span> <span class=o>=</span> <span class=n>TelecomFeatureEngineer</span><span class=p>()</span>
<a id=__codelineno-26-26 name=__codelineno-26-26 href=#__codelineno-26-26></a>
<a id=__codelineno-26-27 name=__codelineno-26-27 href=#__codelineno-26-27></a>    <span class=c1># Etapa 2: Preprocessing</span>
<a id=__codelineno-26-28 name=__codelineno-26-28 href=#__codelineno-26-28></a>    <span class=n>transformers</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-26-29 name=__codelineno-26-29 href=#__codelineno-26-29></a>        <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-26-30 name=__codelineno-26-30 href=#__codelineno-26-30></a>            <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
<a id=__codelineno-26-31 name=__codelineno-26-31 href=#__codelineno-26-31></a>            <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>
<a id=__codelineno-26-32 name=__codelineno-26-32 href=#__codelineno-26-32></a>        <span class=p>]),</span> <span class=n>num_cols</span><span class=p>)</span>
<a id=__codelineno-26-33 name=__codelineno-26-33 href=#__codelineno-26-33></a>    <span class=p>]</span>
<a id=__codelineno-26-34 name=__codelineno-26-34 href=#__codelineno-26-34></a>
<a id=__codelineno-26-35 name=__codelineno-26-35 href=#__codelineno-26-35></a>    <span class=k>if</span> <span class=n>cat_cols</span><span class=p>:</span>
<a id=__codelineno-26-36 name=__codelineno-26-36 href=#__codelineno-26-36></a>        <span class=n>transformers</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
<a id=__codelineno-26-37 name=__codelineno-26-37 href=#__codelineno-26-37></a>            <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-26-38 name=__codelineno-26-38 href=#__codelineno-26-38></a>                <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;most_frequent&#39;</span><span class=p>)),</span>
<a id=__codelineno-26-39 name=__codelineno-26-39 href=#__codelineno-26-39></a>                <span class=p>(</span><span class=s1>&#39;encoder&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>))</span>
<a id=__codelineno-26-40 name=__codelineno-26-40 href=#__codelineno-26-40></a>            <span class=p>]),</span> <span class=n>cat_cols</span><span class=p>)</span>
<a id=__codelineno-26-41 name=__codelineno-26-41 href=#__codelineno-26-41></a>        <span class=p>)</span>
<a id=__codelineno-26-42 name=__codelineno-26-42 href=#__codelineno-26-42></a>
<a id=__codelineno-26-43 name=__codelineno-26-43 href=#__codelineno-26-43></a>    <span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
<a id=__codelineno-26-44 name=__codelineno-26-44 href=#__codelineno-26-44></a>        <span class=n>transformers</span><span class=o>=</span><span class=n>transformers</span><span class=p>,</span>
<a id=__codelineno-26-45 name=__codelineno-26-45 href=#__codelineno-26-45></a>        <span class=n>remainder</span><span class=o>=</span><span class=s1>&#39;drop&#39;</span>
<a id=__codelineno-26-46 name=__codelineno-26-46 href=#__codelineno-26-46></a>    <span class=p>)</span>
<a id=__codelineno-26-47 name=__codelineno-26-47 href=#__codelineno-26-47></a>
<a id=__codelineno-26-48 name=__codelineno-26-48 href=#__codelineno-26-48></a>    <span class=c1># Etapa 3: Modelo</span>
<a id=__codelineno-26-49 name=__codelineno-26-49 href=#__codelineno-26-49></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span>
<a id=__codelineno-26-50 name=__codelineno-26-50 href=#__codelineno-26-50></a>        <span class=n>random_state</span><span class=o>=</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;random_state&quot;</span><span class=p>,</span> <span class=mi>42</span><span class=p>),</span>
<a id=__codelineno-26-51 name=__codelineno-26-51 href=#__codelineno-26-51></a>        <span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span>
<a id=__codelineno-26-52 name=__codelineno-26-52 href=#__codelineno-26-52></a>    <span class=p>)</span>
<a id=__codelineno-26-53 name=__codelineno-26-53 href=#__codelineno-26-53></a>
<a id=__codelineno-26-54 name=__codelineno-26-54 href=#__codelineno-26-54></a>    <span class=c1># Pipeline completo</span>
<a id=__codelineno-26-55 name=__codelineno-26-55 href=#__codelineno-26-55></a>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-26-56 name=__codelineno-26-56 href=#__codelineno-26-56></a>        <span class=p>(</span><span class=s1>&#39;features&#39;</span><span class=p>,</span> <span class=n>feature_engineer</span><span class=p>),</span>
<a id=__codelineno-26-57 name=__codelineno-26-57 href=#__codelineno-26-57></a>        <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
<a id=__codelineno-26-58 name=__codelineno-26-58 href=#__codelineno-26-58></a>        <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>model</span><span class=p>)</span>
<a id=__codelineno-26-59 name=__codelineno-26-59 href=#__codelineno-26-59></a>    <span class=p>])</span>
<a id=__codelineno-26-60 name=__codelineno-26-60 href=#__codelineno-26-60></a>
<a id=__codelineno-26-61 name=__codelineno-26-61 href=#__codelineno-26-61></a>    <span class=k>return</span> <span class=n>pipeline</span>
<a id=__codelineno-26-62 name=__codelineno-26-62 href=#__codelineno-26-62></a>
<a id=__codelineno-26-63 name=__codelineno-26-63 href=#__codelineno-26-63></a>
<a id=__codelineno-26-64 name=__codelineno-26-64 href=#__codelineno-26-64></a><span class=c1># Uso</span>
<a id=__codelineno-26-65 name=__codelineno-26-65 href=#__codelineno-26-65></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>build_telecom_pipeline</span><span class=p>()</span>
<a id=__codelineno-26-66 name=__codelineno-26-66 href=#__codelineno-26-66></a><span class=c1># pipeline.fit(X_train, y_train)</span>
<a id=__codelineno-26-67 name=__codelineno-26-67 href=#__codelineno-26-67></a><span class=c1># joblib.dump(pipeline, &quot;artifacts/model.joblib&quot;)</span>
</code></pre></div> </details> <hr> <p><a id=76-ingenieria-inversa-pipelines></a></p> <h2 id=76-ingenieria-inversa-pedagogica-columntransformer-real>7.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ColumnTransformer Real<a class=headerlink href=#76-ingenieria-inversa-pedagogica-columntransformer-real title="Permanent link">&para;</a></h2> <blockquote> <p><strong>Objetivo</strong>: Entender las decisiones del preprocesamiento del portafolio.</p> </blockquote> <h3 id=761-el-por-que-arquitectonico>7.6.1 ğŸ¯ El "Por QuÃ©" ArquitectÃ³nico<a class=headerlink href=#761-el-por-que-arquitectonico title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>â”‚  PROBLEMA 1: Â¿CÃ³mo manejo NaN en categÃ³ricas vs numÃ©ricas?                      â”‚
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>â”‚  DECISIÃ“N: Pipeline separado: median para num, &quot;missing&quot; para cat               â”‚
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a>â”‚                                                                                 â”‚
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>â”‚  PROBLEMA 2: Â¿QuÃ© pasa si llega una categorÃ­a nueva en producciÃ³n?              â”‚
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>â”‚  DECISIÃ“N: OneHotEncoder(handle_unknown=&quot;ignore&quot;) â†’ ceros                       â”‚
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>â”‚                                                                                 â”‚
<a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>â”‚  PROBLEMA 3: Â¿CÃ³mo guardo preprocesador + modelo juntos?                        â”‚
<a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>â”‚  DECISIÃ“N: Pipeline(preprocessor + classifier) como unidad atÃ³mica              â”‚
<a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div> <h3 id=762-anatomia-del-columntransformer>7.6.2 ğŸ” AnatomÃ­a del ColumnTransformer<a class=headerlink href=#762-anatomia-del-columntransformer title="Permanent link">&para;</a></h3> <p><strong>Archivo</strong>: <code>ML-MLOps-Portfolio/BankChurn-Predictor/src/bankchurn/training.py</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1># Pipeline CATEGÃ“RICO: maneja variables como Geography, Gender, etc.</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=k>def</span><span class=w> </span><span class=nf>_build_categorical_pipeline</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a>    <span class=k>return</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a>        <span class=p>(</span><span class=s2>&quot;imputer&quot;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span>                <span class=c1># Paso 1: Imputar NaN.</span>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>            <span class=n>strategy</span><span class=o>=</span><span class=s2>&quot;constant&quot;</span><span class=p>,</span>                  <span class=c1># Estrategia: valor constante.</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>            <span class=n>fill_value</span><span class=o>=</span><span class=s2>&quot;missing&quot;</span>                  <span class=c1># NaN â†’ &quot;missing&quot; (nueva categorÃ­a).</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>        <span class=p>)),</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a>        <span class=p>(</span><span class=s2>&quot;onehot&quot;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span>                 <span class=c1># Paso 2: One-hot encoding.</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a>            <span class=n>drop</span><span class=o>=</span><span class=s2>&quot;first&quot;</span><span class=p>,</span>                         <span class=c1># Evita dummy variable trap.</span>
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a>            <span class=n>handle_unknown</span><span class=o>=</span><span class=s2>&quot;ignore&quot;</span><span class=p>,</span>              <span class=c1># CRÃTICO: categorÃ­as nuevas â†’ ceros.</span>
<a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a>        <span class=p>)),</span>
<a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a>    <span class=p>])</span>
<a id=__codelineno-28-13 name=__codelineno-28-13 href=#__codelineno-28-13></a>
<a id=__codelineno-28-14 name=__codelineno-28-14 href=#__codelineno-28-14></a><span class=c1># Pipeline NUMÃ‰RICO: maneja variables como Age, Balance, CreditScore.</span>
<a id=__codelineno-28-15 name=__codelineno-28-15 href=#__codelineno-28-15></a><span class=k>def</span><span class=w> </span><span class=nf>_build_numerical_pipeline</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
<a id=__codelineno-28-16 name=__codelineno-28-16 href=#__codelineno-28-16></a>    <span class=k>return</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-28-17 name=__codelineno-28-17 href=#__codelineno-28-17></a>        <span class=p>(</span><span class=s2>&quot;imputer&quot;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span>                <span class=c1># Paso 1: Imputar NaN.</span>
<a id=__codelineno-28-18 name=__codelineno-28-18 href=#__codelineno-28-18></a>            <span class=n>strategy</span><span class=o>=</span><span class=s2>&quot;median&quot;</span>                     <span class=c1># Mediana: robusta a outliers.</span>
<a id=__codelineno-28-19 name=__codelineno-28-19 href=#__codelineno-28-19></a>        <span class=p>)),</span>
<a id=__codelineno-28-20 name=__codelineno-28-20 href=#__codelineno-28-20></a>        <span class=p>(</span><span class=s2>&quot;scaler&quot;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>             <span class=c1># Paso 2: Normalizar a media=0, std=1.</span>
<a id=__codelineno-28-21 name=__codelineno-28-21 href=#__codelineno-28-21></a>    <span class=p>])</span>
<a id=__codelineno-28-22 name=__codelineno-28-22 href=#__codelineno-28-22></a>
<a id=__codelineno-28-23 name=__codelineno-28-23 href=#__codelineno-28-23></a><span class=c1># ColumnTransformer: aplica pipelines a columnas especÃ­ficas.</span>
<a id=__codelineno-28-24 name=__codelineno-28-24 href=#__codelineno-28-24></a><span class=k>return</span> <span class=n>ColumnTransformer</span><span class=p>(</span>
<a id=__codelineno-28-25 name=__codelineno-28-25 href=#__codelineno-28-25></a>    <span class=n>transformers</span><span class=o>=</span><span class=n>transformers</span><span class=p>,</span>                    <span class=c1># Lista de (nombre, pipeline, columnas).</span>
<a id=__codelineno-28-26 name=__codelineno-28-26 href=#__codelineno-28-26></a>    <span class=n>remainder</span><span class=o>=</span><span class=s2>&quot;drop&quot;</span>                              <span class=c1># IMPORTANTE: ignora columnas no listadas.</span>
<a id=__codelineno-28-27 name=__codelineno-28-27 href=#__codelineno-28-27></a><span class=p>)</span>
</code></pre></div> <h3 id=763-troubleshooting>7.6.3 ğŸš¨ Troubleshooting<a class=headerlink href=#763-troubleshooting title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>SÃ­ntoma</th> <th>SoluciÃ³n</th> </tr> </thead> <tbody> <tr> <td><strong>"X has N features, expecting M"</strong></td> <td><code>remainder="drop"</code> + orden fijo</td> </tr> <tr> <td><strong>"unknown categories"</strong></td> <td><code>handle_unknown="ignore"</code></td> </tr> </tbody> </table> <hr> <p><a id=errores-habituales></a></p> <h2 id=errores-habituales-y-como-depurarlos-en-sklearn-pipelines>ğŸ§¨ Errores habituales y cÃ³mo depurarlos en sklearn Pipelines<a class=headerlink href=#errores-habituales-y-como-depurarlos-en-sklearn-pipelines title="Permanent link">&para;</a></h2> <p>Los errores en este mÃ³dulo rara vez son â€œfallos exÃ³ticosâ€ del algoritmo; casi siempre son <strong>desalineaciones</strong> entre datos, columnas, transformers y cÃ³mo guardas/cargas el pipeline.</p> <p>Si alguno de estos errores te tomÃ³ <strong>&gt;15 minutos</strong>, regÃ­stralo en el <strong><a href=../study_tools/DIARIO_ERRORES/ >Diario de Errores</a></strong> y aplica el flujo de <strong>rescate cognitivo</strong> de <strong><a href=../study_tools/PROTOCOLO_E/ >Protocolo E</a></strong>.</p> <h3 id=1-valueerror-number-of-features-does-not-match-mismatch-entre-train-e-inference>1) <code>ValueError: number of features does not match</code> (mismatch entre train e inference)<a class=headerlink href=#1-valueerror-number-of-features-does-not-match-mismatch-entre-train-e-inference title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li>En entrenamiento todo bien, pero al predecir obtienes: <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>ValueError: X has 15 features, but StandardScaler is expecting 12 features as input.
</code></pre></div></li> <li>O bien errores de Ã­ndice similares en <code>OneHotEncoder</code>.</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Verifica que usas <strong>el mismo pipeline serializado</strong> en training e inference:</li> <li>Â¿Guardas y cargas <code>pipeline.pkl</code>/<code>model.joblib</code>, o solo el modelo suelto?</li> <li>Comprueba que las columnas de entrada en producciÃ³n tienen el mismo orden y nombres que en entrenamiento.</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>En el portafolio, <strong>siempre</strong> serializa el pipeline completo: <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipeline</span><span class=p>,</span> <span class=s2>&quot;artifacts/model.joblib&quot;</span><span class=p>)</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;artifacts/model.joblib&quot;</span><span class=p>)</span>
</code></pre></div></li> <li>AsegÃºrate de que el orden y nombres de columnas que construyes en la API/Streamlit coincidan con las listas <code>num_cols</code> y <code>cat_cols</code> del pipeline.</li> </ul> <hr> <h3 id=2-data-leakage-por-features-que-usan-el-target-especialmente-en-carvision>2) Data leakage por features que usan el target (especialmente en CarVision)<a class=headerlink href=#2-data-leakage-por-features-que-usan-el-target-especialmente-en-carvision title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li>MÃ©tricas en training/validation son <strong>sospechosamente altas</strong>, pero en producciÃ³n caen.</li> <li>Features como <code>price_per_mile</code> o <code>price_category</code> dependen de la variable objetivo (<code>price</code>).</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Examina tu <code>FeatureEngineer</code> y lista de columnas que entran al modelo:</li> <li>Â¿EstÃ¡s incluyendo columnas derivadas del target en el <code>ColumnTransformer</code>?</li> <li>Revisa tu config (<code>cfg["preprocessing"]["numeric_features"]</code>, etc.) y confirma que solo incluyes features vÃ¡lidos.</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>AsegÃºrate de que features que dependen del target <strong>no</strong> se usen como input del modelo.</li> <li>En CarVision, por ejemplo, <code>price_per_mile</code> y <code>price_category</code> se calculan solo para anÃ¡lisis, pero se excluyen de <code>num_cols</code> para el pipeline.</li> </ul> <hr> <h3 id=3-custom-transformers-que-modifican-el-input-in-place-o-no-respetan-la-api-sklearn>3) Custom transformers que modifican el input in-place o no respetan la API sklearn<a class=headerlink href=#3-custom-transformers-que-modifican-el-input-in-place-o-no-respetan-la-api-sklearn title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li>Errores del tipo: <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a>TypeError: __init__() takes 1 positional argument but 2 were given
</code></pre></div> o <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a>AttributeError: &#39;MiTransformer&#39; object has no attribute &#39;fit&#39;
</code></pre></div></li> <li>Comportamientos raros donde un transformer â€œensuciaâ€ los datos para otros steps.</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Revisa que tu transformer:</li> <li>Herede de <code>BaseEstimator</code> y <code>TransformerMixin</code>.</li> <li>Tenga <code>__init__</code>, <code>fit</code>, <code>transform</code> con las firmas estÃ¡ndar.</li> <li>Use <code>X = X.copy()</code> dentro de <code>transform</code>.</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>Usa la plantilla de este mÃ³dulo (<code>MiTransformer</code>) como referencia.</li> <li>Evita lÃ³gica pesada en <code>__init__</code>; ahÃ­ solo se guardan parÃ¡metros.</li> <li>AÃ±ade tests unitarios simples (<code>fit_transform</code> sobre un <code>DataFrame</code> pequeÃ±o) para validar que mantiene columnas esperadas.</li> </ul> <hr> <h3 id=4-pipelines-diferentes-en-training-y-en-la-api>4) Pipelines diferentes en training y en la API<a class=headerlink href=#4-pipelines-diferentes-en-training-y-en-la-api title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li>El pipeline usado en <code>training.py</code> no coincide con el que se monta en <code>fastapi_app.py</code> o <code>streamlit_app.py</code>.</li> <li>Bugs donde la API aplica transformaciones manuales <strong>ademÃ¡s</strong> del pipeline.</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Busca en el proyecto si estÃ¡s construyendo pipelines duplicados:</li> <li>En CarVision, la Ãºnica fuente de verdad debe ser <code>build_pipeline</code> en <code>src/carvision/training.py</code>.</li> <li>La API y Streamlit solo deberÃ­an <strong>cargar</strong> el pipeline serializado, no recrearlo a mano.</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>Centraliza la construcciÃ³n del pipeline en una funciÃ³n (<code>build_pipeline</code> / <code>build_telecom_pipeline</code>).</li> <li>En la API/Streamlit, no replicar lÃ³gicas de preprocesado; limitarse a cargar y usar el pipeline.</li> </ul> <hr> <h3 id=5-patron-general-de-debugging-para-pipelines>5) PatrÃ³n general de debugging para pipelines<a class=headerlink href=#5-patron-general-de-debugging-para-pipelines title="Permanent link">&para;</a></h3> <ol> <li><strong>Reproduce el error</strong> con un input mÃ­nimo (1â€“2 filas de <code>DataFrame</code>).</li> <li><strong>Inspecciona shapes y columnas</strong> tras cada etapa:</li> <li>Usa <code>pipeline.named_steps["pre"].transform(X_sample)</code> o similares.</li> <li><strong>Verifica la serializaciÃ³n</strong>: guarda, vuelve a cargar, y compara predicciones en un mismo batch.</li> <li><strong>Conecta el problema</strong> con el concepto del mÃ³dulo:</li> <li>Training-serving skew â†’ pipeline parcial o mal serializado.</li> <li>Mismatch de columnas â†’ listas <code>num_cols</code>/<code>cat_cols</code> desincronizadas.</li> <li>Transformers rotos â†’ no respetan <code>fit</code>/<code>transform</code>.</li> </ol> <p>Con este enfoque, los pipelines dejan de ser una â€œcaja negra mÃ¡gicaâ€ y se convierten en una lÃ­nea de ensamblaje transparente y depurable.</p> <hr> <p><a id=checkpoint></a></p> <h2 id=checkpoint-completaste-el-modulo>âœ… Checkpoint: Â¿Completaste el MÃ³dulo?<a class=headerlink href=#checkpoint-completaste-el-modulo title="Permanent link">&para;</a></h2> <h3 id=checklist>Checklist<a class=headerlink href=#checklist title="Permanent link">&para;</a></h3> <ul> <li>[ ] Sabes usar ColumnTransformer para diferentes tipos de columnas</li> <li>[ ] Puedes crear un Custom Transformer con fit/transform</li> <li>[ ] Has construido un pipeline de 3 etapas (features â†’ preprocessing â†’ model)</li> <li>[ ] Puedes guardar y cargar un pipeline completo con joblib</li> </ul> <hr> <h2 id=adr-decisiones-de-arquitectura>ğŸ”— ADR: Decisiones de Arquitectura<a class=headerlink href=#adr-decisiones-de-arquitectura title="Permanent link">&para;</a></h2> <h3 id=adr-007-pipeline-unificado-obligatorio>ADR-007: Pipeline Unificado Obligatorio<a class=headerlink href=#adr-007-pipeline-unificado-obligatorio title="Permanent link">&para;</a></h3> <p><strong>Contexto</strong>: Transformaciones separadas causan inconsistencias en producciÃ³n.</p> <p><strong>DecisiÃ³n</strong>: Todo el flujo (features â†’ preprocessing â†’ model) debe estar en un solo Pipeline.</p> <p><strong>Consecuencias</strong>: - âœ… Una sola serializaciÃ³n guarda todo - âœ… Imposible olvidar una transformaciÃ³n - âœ… Reproducibilidad garantizada - âŒ MÃ¡s complejo de debuggear (caja negra) - âŒ Requiere entender sklearn profundamente</p> <h3 id=adr-008-custom-transformers-para-feature-engineering>ADR-008: Custom Transformers para Feature Engineering<a class=headerlink href=#adr-008-custom-transformers-para-feature-engineering title="Permanent link">&para;</a></h3> <p><strong>Contexto</strong>: sklearn no tiene transformers para lÃ³gica de negocio especÃ­fica.</p> <p><strong>DecisiÃ³n</strong>: Crear FeatureEngineer como TransformerMixin.</p> <p><strong>Consecuencias</strong>: - âœ… Reutilizable en train, API, y dashboard - âœ… Testeable unitariamente - âœ… DocumentaciÃ³n clara de features derivadas - âŒ MÃ¡s cÃ³digo que escribir - âŒ Requiere entender BaseEstimator/TransformerMixin</p> <hr> <h2 id=como-se-uso-en-el-portafolio>ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio<a class=headerlink href=#como-se-uso-en-el-portafolio title="Permanent link">&para;</a></h2> <p>Los pipelines sklearn son el corazÃ³n de los 3 proyectos del portafolio:</p> <h3 id=pipeline-unificado-de-bankchurn>Pipeline Unificado de BankChurn<a class=headerlink href=#pipeline-unificado-de-bankchurn title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=c1># BankChurn-Predictor/src/bankchurn/pipeline.py (estructura real)</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=k>def</span><span class=w> </span><span class=nf>build_pipeline</span><span class=p>(</span><span class=n>config</span><span class=p>:</span> <span class=n>BankChurnConfig</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Pipeline completo de 3 etapas.&quot;&quot;&quot;</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>    <span class=k>return</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>        <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>ColumnTransformer</span><span class=p>([</span>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>            <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>                <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>                <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>            <span class=p>]),</span> <span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>numerical_features</span><span class=p>),</span>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>            <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a>                <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;constant&#39;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=s1>&#39;missing&#39;</span><span class=p>)),</span>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a>                <span class=p>(</span><span class=s1>&#39;encoder&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>))</span>
<a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a>            <span class=p>]),</span> <span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>categorical_features</span><span class=p>)</span>
<a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a>        <span class=p>])),</span>
<a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a>        <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>get_model</span><span class=p>(</span><span class=n>config</span><span class=p>))</span>
<a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a>    <span class=p>])</span>
</code></pre></div> <h3 id=featureengineer-de-carvision>FeatureEngineer de CarVision<a class=headerlink href=#featureengineer-de-carvision title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=c1># CarVision-Market-Intelligence/src/carvision/features.py</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=k>class</span><span class=w> </span><span class=nc>FeatureEngineer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Custom transformer para features de autos.&quot;&quot;&quot;</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>current_year</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>current_year</span> <span class=o>=</span> <span class=n>current_year</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>
<a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a>        <span class=c1># vehicle_age, brand, mileage_category, etc.</span>
<a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a>        <span class=k>return</span> <span class=n>X</span>
</code></pre></div> <h3 id=archivos-clave-por-proyecto>Archivos Clave por Proyecto<a class=headerlink href=#archivos-clave-por-proyecto title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Proyecto</th> <th>Pipeline</th> <th>Features</th> <th>Artefacto</th> </tr> </thead> <tbody> <tr> <td>BankChurn</td> <td><code>src/bankchurn/pipeline.py</code></td> <td>En preprocessor</td> <td><code>artifacts/pipeline.joblib</code></td> </tr> <tr> <td>CarVision</td> <td><code>src/carvision/pipeline.py</code></td> <td><code>src/carvision/features.py</code></td> <td><code>artifacts/pipeline.joblib</code></td> </tr> <tr> <td>TelecomAI</td> <td><code>src/telecomai/training.py</code></td> <td>En pipeline</td> <td><code>artifacts/model.joblib</code></td> </tr> </tbody> </table> <h3 id=ejercicio-explora-los-pipelines-reales>ğŸ”§ Ejercicio: Explora los Pipelines Reales<a class=headerlink href=#ejercicio-explora-los-pipelines-reales title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=c1># 1. Ve a BankChurn y carga el pipeline</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=nb>cd</span><span class=w> </span>BankChurn-Predictor
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>python<span class=w> </span>-c<span class=w> </span><span class=s2>&quot;</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a><span class=s2>import joblib</span>
<a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=s2>pipe = joblib.load(&#39;artifacts/pipeline.joblib&#39;)</span>
<a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a><span class=s2>print(&#39;Steps:&#39;, [name for name, _ in pipe.steps])</span>
<a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=s2>print(&#39;Preprocessor:&#39;, pipe.named_steps[&#39;preprocessor&#39;])</span>
<a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a><span class=s2>&quot;</span>
<a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a>
<a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a><span class=c1># 2. Inspecciona el FeatureEngineer de CarVision</span>
<a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a>cat<span class=w> </span>CarVision-Market-Intelligence/src/carvision/features.py
</code></pre></div> <hr> <h2 id=consejos-profesionales>ğŸ’¼ Consejos Profesionales<a class=headerlink href=#consejos-profesionales title="Permanent link">&para;</a></h2> <blockquote> <p><strong>Recomendaciones para destacar en entrevistas y proyectos reales</strong></p> </blockquote> <h3 id=para-entrevistas>Para Entrevistas<a class=headerlink href=#para-entrevistas title="Permanent link">&para;</a></h3> <ol> <li> <p><strong>Â¿Por quÃ© Pipelines?</strong>: Evitan data leakage, garantizan reproducibilidad, simplifican deployment.</p> </li> <li> <p><strong>Custom Transformers</strong>: Demuestra que puedes crear transformadores con <code>fit()</code> y <code>transform()</code>.</p> </li> <li> <p><strong>ColumnTransformer</strong>: Explica cÃ³mo aplicar diferentes transformaciones a diferentes columnas.</p> </li> </ol> <h3 id=para-proyectos-reales>Para Proyectos Reales<a class=headerlink href=#para-proyectos-reales title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>SituaciÃ³n</th> <th>Consejo</th> </tr> </thead> <tbody> <tr> <td>Features nuevas</td> <td>AÃ±ade transformadores al pipeline, no cÃ³digo suelto</td> </tr> <tr> <td>Debugging</td> <td>Usa <code>pipeline.named_steps</code> para inspeccionar etapas</td> </tr> <tr> <td>ProducciÃ³n</td> <td>Serializa el pipeline completo, no solo el modelo</td> </tr> <tr> <td>Testing</td> <td>Testea cada transformador individualmente</td> </tr> </tbody> </table> <h3 id=patrones-avanzados>Patrones Avanzados<a class=headerlink href=#patrones-avanzados title="Permanent link">&para;</a></h3> <ul> <li><strong>FeatureUnion</strong>: Combinar features de diferentes fuentes</li> <li><strong>Pipeline dentro de Pipeline</strong>: Para transformaciones complejas</li> <li><strong>make_pipeline</strong>: Sintaxis simplificada sin nombres</li> <li><strong>clone</strong>: Para cross-validation sin modificar original</li> </ul> <hr> <h2 id=recursos-externos-del-modulo>ğŸ“º Recursos Externos del MÃ³dulo<a class=headerlink href=#recursos-externos-del-modulo title="Permanent link">&para;</a></h2> <blockquote> <p>ğŸ·ï¸ Sistema: ğŸ”´ Obligatorio | ğŸŸ¡ Recomendado | ğŸŸ¢ Complementario</p> </blockquote> <h3 id=videos>ğŸ¬ Videos<a class=headerlink href=#videos title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th style="text-align: center;">ğŸ·ï¸</th> <th style="text-align: left;">TÃ­tulo</th> <th style="text-align: left;">Canal</th> <th style="text-align: center;">DuraciÃ³n</th> <th style="text-align: left;">Link</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">ğŸ”´</td> <td style="text-align: left;"><strong>Sklearn Pipeline Tutorial</strong></td> <td style="text-align: left;">Data School</td> <td style="text-align: center;">28 min</td> <td style="text-align: left;"><a href="https://www.youtube.com/watch?v=irHhDMbw3xo">YouTube</a></td> </tr> <tr> <td style="text-align: center;">ğŸ”´</td> <td style="text-align: left;"><strong>ColumnTransformer Explained</strong></td> <td style="text-align: left;">Data School</td> <td style="text-align: center;">35 min</td> <td style="text-align: left;"><a href="https://www.youtube.com/watch?v=NGq8wnH5VSo">YouTube</a></td> </tr> <tr> <td style="text-align: center;">ğŸŸ¡</td> <td style="text-align: left;"><strong>Custom Transformers in Sklearn</strong></td> <td style="text-align: left;">PyData</td> <td style="text-align: center;">32 min</td> <td style="text-align: left;"><a href="https://www.youtube.com/watch?v=BFaadIqWlAg">YouTube</a></td> </tr> <tr> <td style="text-align: center;">ğŸŸ¢</td> <td style="text-align: left;"><strong>Sklearn Pipeline Best Practices</strong></td> <td style="text-align: left;">PyData Berlin</td> <td style="text-align: center;">45 min</td> <td style="text-align: left;"><a href="https://www.youtube.com/watch?v=0UWXCAYn8rk">YouTube</a></td> </tr> </tbody> </table> <h3 id=cursos>ğŸ“š Cursos<a class=headerlink href=#cursos title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th style="text-align: center;">ğŸ·ï¸</th> <th style="text-align: left;">TÃ­tulo</th> <th style="text-align: left;">Plataforma</th> <th style="text-align: center;">DuraciÃ³n</th> <th style="text-align: left;">Link</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">ğŸ”´</td> <td style="text-align: left;">ML Pipelines with scikit-learn</td> <td style="text-align: left;">DataCamp</td> <td style="text-align: center;">4h</td> <td style="text-align: left;"><a href=https://www.datacamp.com/courses/machine-learning-with-scikit-learn>DataCamp</a></td> </tr> <tr> <td style="text-align: center;">ğŸŸ¡</td> <td style="text-align: left;">Feature Engineering for ML</td> <td style="text-align: left;">Coursera (Google)</td> <td style="text-align: center;">5 weeks</td> <td style="text-align: left;"><a href=https://www.coursera.org/learn/feature-engineering>Coursera</a></td> </tr> </tbody> </table> <h3 id=documentacion>ğŸ“„ DocumentaciÃ³n<a class=headerlink href=#documentacion title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th style="text-align: center;">ğŸ·ï¸</th> <th style="text-align: left;">Recurso</th> <th style="text-align: left;">DescripciÃ³n</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">ğŸ”´</td> <td style="text-align: left;"><a href=https://scikit-learn.org/stable/modules/compose.html>sklearn Pipeline User Guide</a></td> <td style="text-align: left;">GuÃ­a oficial de pipelines</td> </tr> <tr> <td style="text-align: center;">ğŸŸ¡</td> <td style="text-align: left;"><a href=https://scikit-learn.org/stable/developers/develop.html>Custom Transformers</a></td> <td style="text-align: left;">CÃ³mo crear transformers custom</td> </tr> </tbody> </table> <hr> <h2 id=decision-tecnica-adr-002-scikit-learn>âš–ï¸ DecisiÃ³n TÃ©cnica: ADR-002 scikit-learn<a class=headerlink href=#decision-tecnica-adr-002-scikit-learn title="Permanent link">&para;</a></h2> <p><strong>Contexto</strong>: Necesitamos un framework ML para clasificaciÃ³n/regresiÃ³n tabular.</p> <p><strong>DecisiÃ³n</strong>: Usar scikit-learn como framework principal.</p> <p><strong>Alternativas Consideradas</strong>: - <strong>XGBoost/LightGBM</strong>: MÃ¡s performance, menos integraciÃ³n con pipelines - <strong>PyTorch</strong>: Overkill para datos tabulares</p> <p><strong>Consecuencias</strong>: - âœ… Pipelines unificados con <code>Pipeline</code> y <code>ColumnTransformer</code> - âœ… FÃ¡cil de testear y serializar - âœ… DocumentaciÃ³n excelente - âŒ Menos performance que gradient boosting dedicado</p> <hr> <h2 id=ejercicios-del-modulo>ğŸ”§ Ejercicios del MÃ³dulo<a class=headerlink href=#ejercicios-del-modulo title="Permanent link">&para;</a></h2> <h3 id=ejercicio-71-pipeline-basico>Ejercicio 7.1: Pipeline BÃ¡sico<a class=headerlink href=#ejercicio-71-pipeline-basico title="Permanent link">&para;</a></h3> <p><strong>Objetivo</strong>: Crear un pipeline con preprocesamiento. <strong>Dificultad</strong>: â­â­</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<a id=__codelineno-36-4 name=__codelineno-36-4 href=#__codelineno-36-4></a>
<a id=__codelineno-36-5 name=__codelineno-36-5 href=#__codelineno-36-5></a><span class=c1># TU TAREA: Crear pipeline con:</span>
<a id=__codelineno-36-6 name=__codelineno-36-6 href=#__codelineno-36-6></a><span class=c1># 1. StandardScaler para features numÃ©ricas</span>
<a id=__codelineno-36-7 name=__codelineno-36-7 href=#__codelineno-36-7></a><span class=c1># 2. RandomForestClassifier</span>
<a id=__codelineno-36-8 name=__codelineno-36-8 href=#__codelineno-36-8></a>
<a id=__codelineno-36-9 name=__codelineno-36-9 href=#__codelineno-36-9></a><span class=n>pipe</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-36-10 name=__codelineno-36-10 href=#__codelineno-36-10></a>    <span class=c1># TU CÃ“DIGO</span>
<a id=__codelineno-36-11 name=__codelineno-36-11 href=#__codelineno-36-11></a><span class=p>])</span>
</code></pre></div> <details> <summary>ğŸ’¡ Ver soluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=n>pipe</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a>    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a>        <span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>        <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>    <span class=p>))</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a><span class=p>])</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a><span class=c1># Uso:</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a><span class=n>pipe</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a><span class=n>predictions</span> <span class=o>=</span> <span class=n>pipe</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a>
<a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a><span class=c1># SerializaciÃ³n:</span>
<a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a><span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>
<a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipe</span><span class=p>,</span> <span class=s1>&#39;artifacts/pipeline.joblib&#39;</span><span class=p>)</span>
</code></pre></div> </details> <hr> <h3 id=ejercicio-72-columntransformer>Ejercicio 7.2: ColumnTransformer<a class=headerlink href=#ejercicio-72-columntransformer title="Permanent link">&para;</a></h3> <p><strong>Objetivo</strong>: Procesar columnas numÃ©ricas y categÃ³ricas por separado. <strong>Dificultad</strong>: â­â­â­</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=c1># Dado un DataFrame con:</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=c1># - numeric_cols = [&#39;age&#39;, &#39;balance&#39;, &#39;salary&#39;]</span>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=c1># - categorical_cols = [&#39;geography&#39;, &#39;gender&#39;]</span>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a><span class=c1># TU TAREA: Crear ColumnTransformer que:</span>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=c1># - Aplique StandardScaler a numÃ©ricas</span>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=c1># - Aplique OneHotEncoder a categÃ³ricas</span>
<a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a>
<a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>
<a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a>
<a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>([</span>
<a id=__codelineno-38-13 name=__codelineno-38-13 href=#__codelineno-38-13></a>    <span class=c1># TU CÃ“DIGO</span>
<a id=__codelineno-38-14 name=__codelineno-38-14 href=#__codelineno-38-14></a><span class=p>])</span>
</code></pre></div> <details> <summary>ğŸ’¡ Ver soluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span>
<a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a>
<a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=n>numeric_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>,</span> <span class=s1>&#39;balance&#39;</span><span class=p>,</span> <span class=s1>&#39;salary&#39;</span><span class=p>]</span>
<a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=n>categorical_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;geography&#39;</span><span class=p>,</span> <span class=s1>&#39;gender&#39;</span><span class=p>]</span>
<a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a>
<a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a><span class=c1># Pipelines individuales para cada tipo</span>
<a id=__codelineno-39-10 name=__codelineno-39-10 href=#__codelineno-39-10></a><span class=n>numeric_transformer</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-39-11 name=__codelineno-39-11 href=#__codelineno-39-11></a>    <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>
<a id=__codelineno-39-12 name=__codelineno-39-12 href=#__codelineno-39-12></a>    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>
<a id=__codelineno-39-13 name=__codelineno-39-13 href=#__codelineno-39-13></a><span class=p>])</span>
<a id=__codelineno-39-14 name=__codelineno-39-14 href=#__codelineno-39-14></a>
<a id=__codelineno-39-15 name=__codelineno-39-15 href=#__codelineno-39-15></a><span class=n>categorical_transformer</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-39-16 name=__codelineno-39-16 href=#__codelineno-39-16></a>    <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;constant&#39;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=s1>&#39;missing&#39;</span><span class=p>)),</span>
<a id=__codelineno-39-17 name=__codelineno-39-17 href=#__codelineno-39-17></a>    <span class=p>(</span><span class=s1>&#39;encoder&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>))</span>
<a id=__codelineno-39-18 name=__codelineno-39-18 href=#__codelineno-39-18></a><span class=p>])</span>
<a id=__codelineno-39-19 name=__codelineno-39-19 href=#__codelineno-39-19></a>
<a id=__codelineno-39-20 name=__codelineno-39-20 href=#__codelineno-39-20></a><span class=c1># ColumnTransformer combina ambos</span>
<a id=__codelineno-39-21 name=__codelineno-39-21 href=#__codelineno-39-21></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>([</span>
<a id=__codelineno-39-22 name=__codelineno-39-22 href=#__codelineno-39-22></a>    <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>numeric_transformer</span><span class=p>,</span> <span class=n>numeric_cols</span><span class=p>),</span>
<a id=__codelineno-39-23 name=__codelineno-39-23 href=#__codelineno-39-23></a>    <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>categorical_transformer</span><span class=p>,</span> <span class=n>categorical_cols</span><span class=p>)</span>
<a id=__codelineno-39-24 name=__codelineno-39-24 href=#__codelineno-39-24></a><span class=p>])</span>
<a id=__codelineno-39-25 name=__codelineno-39-25 href=#__codelineno-39-25></a>
<a id=__codelineno-39-26 name=__codelineno-39-26 href=#__codelineno-39-26></a><span class=c1># Pipeline completo con modelo</span>
<a id=__codelineno-39-27 name=__codelineno-39-27 href=#__codelineno-39-27></a><span class=n>full_pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-39-28 name=__codelineno-39-28 href=#__codelineno-39-28></a>    <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
<a id=__codelineno-39-29 name=__codelineno-39-29 href=#__codelineno-39-29></a>    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>))</span>
<a id=__codelineno-39-30 name=__codelineno-39-30 href=#__codelineno-39-30></a><span class=p>])</span>
</code></pre></div> </details> <hr> <h3 id=ejercicio-73-custom-transformer>Ejercicio 7.3: Custom Transformer<a class=headerlink href=#ejercicio-73-custom-transformer title="Permanent link">&para;</a></h3> <p><strong>Objetivo</strong>: Crear un transformer personalizado. <strong>Dificultad</strong>: â­â­â­</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=c1># TU TAREA: Crear AgeGroupTransformer que:</span>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=c1># - AÃ±ada columna &#39;age_group&#39; basada en rangos de edad</span>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=c1># - 0-30: &#39;young&#39;, 31-50: &#39;middle&#39;, 51+: &#39;senior&#39;</span>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=k>class</span><span class=w> </span><span class=nc>AgeGroupTransformer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a>        <span class=c1># TU CÃ“DIGO</span>
<a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a>
<a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<a id=__codelineno-40-13 name=__codelineno-40-13 href=#__codelineno-40-13></a>        <span class=c1># TU CÃ“DIGO</span>
<a id=__codelineno-40-14 name=__codelineno-40-14 href=#__codelineno-40-14></a>        <span class=k>pass</span>
</code></pre></div> <details> <summary>ğŸ’¡ Ver soluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a><span class=k>class</span><span class=w> </span><span class=nc>AgeGroupTransformer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Transformer que aÃ±ade categorÃ­a de edad.&quot;&quot;&quot;</span>
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a>
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>age_column</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;age&#39;</span><span class=p>):</span>
<a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a>        <span class=bp>self</span><span class=o>.</span><span class=n>age_column</span> <span class=o>=</span> <span class=n>age_column</span>
<a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a>
<a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-41-12 name=__codelineno-41-12 href=#__codelineno-41-12></a>        <span class=c1># No hay nada que aprender</span>
<a id=__codelineno-41-13 name=__codelineno-41-13 href=#__codelineno-41-13></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-41-14 name=__codelineno-41-14 href=#__codelineno-41-14></a>
<a id=__codelineno-41-15 name=__codelineno-41-15 href=#__codelineno-41-15></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<a id=__codelineno-41-16 name=__codelineno-41-16 href=#__codelineno-41-16></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-41-17 name=__codelineno-41-17 href=#__codelineno-41-17></a>
<a id=__codelineno-41-18 name=__codelineno-41-18 href=#__codelineno-41-18></a>        <span class=c1># Crear bins de edad</span>
<a id=__codelineno-41-19 name=__codelineno-41-19 href=#__codelineno-41-19></a>        <span class=n>bins</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span><span class=p>]</span>
<a id=__codelineno-41-20 name=__codelineno-41-20 href=#__codelineno-41-20></a>        <span class=n>labels</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;young&#39;</span><span class=p>,</span> <span class=s1>&#39;middle&#39;</span><span class=p>,</span> <span class=s1>&#39;senior&#39;</span><span class=p>]</span>
<a id=__codelineno-41-21 name=__codelineno-41-21 href=#__codelineno-41-21></a>
<a id=__codelineno-41-22 name=__codelineno-41-22 href=#__codelineno-41-22></a>        <span class=n>X</span><span class=p>[</span><span class=s1>&#39;age_group&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span>
<a id=__codelineno-41-23 name=__codelineno-41-23 href=#__codelineno-41-23></a>            <span class=n>X</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>age_column</span><span class=p>],</span>
<a id=__codelineno-41-24 name=__codelineno-41-24 href=#__codelineno-41-24></a>            <span class=n>bins</span><span class=o>=</span><span class=n>bins</span><span class=p>,</span>
<a id=__codelineno-41-25 name=__codelineno-41-25 href=#__codelineno-41-25></a>            <span class=n>labels</span><span class=o>=</span><span class=n>labels</span>
<a id=__codelineno-41-26 name=__codelineno-41-26 href=#__codelineno-41-26></a>        <span class=p>)</span>
<a id=__codelineno-41-27 name=__codelineno-41-27 href=#__codelineno-41-27></a>        <span class=k>return</span> <span class=n>X</span>
<a id=__codelineno-41-28 name=__codelineno-41-28 href=#__codelineno-41-28></a>
<a id=__codelineno-41-29 name=__codelineno-41-29 href=#__codelineno-41-29></a>    <span class=k>def</span><span class=w> </span><span class=nf>get_feature_names_out</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_features</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-41-30 name=__codelineno-41-30 href=#__codelineno-41-30></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Para compatibilidad con sklearn &gt;= 1.0&quot;&quot;&quot;</span>
<a id=__codelineno-41-31 name=__codelineno-41-31 href=#__codelineno-41-31></a>        <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=n>input_features</span><span class=p>)</span> <span class=o>+</span> <span class=p>[</span><span class=s1>&#39;age_group&#39;</span><span class=p>]</span>
<a id=__codelineno-41-32 name=__codelineno-41-32 href=#__codelineno-41-32></a>
<a id=__codelineno-41-33 name=__codelineno-41-33 href=#__codelineno-41-33></a>
<a id=__codelineno-41-34 name=__codelineno-41-34 href=#__codelineno-41-34></a><span class=c1># Uso en pipeline:</span>
<a id=__codelineno-41-35 name=__codelineno-41-35 href=#__codelineno-41-35></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-41-36 name=__codelineno-41-36 href=#__codelineno-41-36></a>    <span class=p>(</span><span class=s1>&#39;age_groups&#39;</span><span class=p>,</span> <span class=n>AgeGroupTransformer</span><span class=p>(</span><span class=n>age_column</span><span class=o>=</span><span class=s1>&#39;age&#39;</span><span class=p>)),</span>
<a id=__codelineno-41-37 name=__codelineno-41-37 href=#__codelineno-41-37></a>    <span class=p>(</span><span class=s1>&#39;preprocessor&#39;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
<a id=__codelineno-41-38 name=__codelineno-41-38 href=#__codelineno-41-38></a>    <span class=p>(</span><span class=s1>&#39;classifier&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<a id=__codelineno-41-39 name=__codelineno-41-39 href=#__codelineno-41-39></a><span class=p>])</span>
</code></pre></div> </details> <hr> <h2 id=glosario-del-modulo>ğŸ”— Glosario del MÃ³dulo<a class=headerlink href=#glosario-del-modulo title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>TÃ©rmino</th> <th>DefiniciÃ³n</th> </tr> </thead> <tbody> <tr> <td><strong>Pipeline</strong></td> <td>Cadena de transformaciones + modelo que se serializa como unidad</td> </tr> <tr> <td><strong>ColumnTransformer</strong></td> <td>Aplica diferentes transformaciones a diferentes columnas en paralelo</td> </tr> <tr> <td><strong>Data Leakage</strong></td> <td>FiltraciÃ³n de informaciÃ³n del target al training, causando mÃ©tricas infladas</td> </tr> <tr> <td><strong>fit_transform</strong></td> <td>MÃ©todo que aprende parÃ¡metros y transforma en un solo paso</td> </tr> </tbody> </table> <hr> <h2 id=la-trampa-errores-comunes-de-este-modulo>ğŸª¤ La Trampa â€” Errores Comunes de Este MÃ³dulo<a class=headerlink href=#la-trampa-errores-comunes-de-este-modulo title="Permanent link">&para;</a></h2> <h3 id=trampa-1-data-leakage-con-fit_transform-en-todo-el-dataset>Trampa 1: Data leakage con fit_transform en todo el dataset<a class=headerlink href=#trampa-1-data-leakage-con-fit_transform-en-todo-el-dataset title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntoma</strong>: MÃ©tricas de cross-validation: 0.95, mÃ©tricas en producciÃ³n: 0.72</p> <p><strong>Causa raÃ­z</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=c1># âŒ LEAKAGE</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=n>X_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># fit en TODO X (incluye test)</span>
<a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X_scaled</span><span class=p>)</span>
</code></pre></div></p> <p><strong>SoluciÃ³n</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=c1># âœ… SIN LEAKAGE</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>  <span class=c1># Split PRIMERO</span>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a>    <span class=p>(</span><span class=s2>&quot;scaler&quot;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a>    <span class=p>(</span><span class=s2>&quot;model&quot;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=p>])</span>
<a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=n>pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>  <span class=c1># fit SOLO en train</span>
</code></pre></div></p> <hr> <h3 id=trampa-2-columntransformer-pierde-nombres-de-columnas>Trampa 2: ColumnTransformer pierde nombres de columnas<a class=headerlink href=#trampa-2-columntransformer-pierde-nombres-de-columnas title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntoma</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=n>X_transformed</span> <span class=o>=</span> <span class=n>preprocessor</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=nb>print</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>X_transformed</span><span class=p>))</span>  <span class=c1># numpy.ndarray â† Â¡PerdÃ­ los nombres!</span>
</code></pre></div></p> <p><strong>SoluciÃ³n</strong> (sklearn &gt;= 1.2): <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=n>preprocessor</span><span class=o>.</span><span class=n>set_output</span><span class=p>(</span><span class=n>transform</span><span class=o>=</span><span class=s2>&quot;pandas&quot;</span><span class=p>)</span>  <span class=c1># â† Retorna DataFrame</span>
</code></pre></div></p> <hr> <h3 id=trampa-3-custom-transformer-sin-retornar-self-en-fit>Trampa 3: Custom Transformer sin retornar self en fit<a class=headerlink href=#trampa-3-custom-transformer-sin-retornar-self-en-fit title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntoma</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a>    <span class=bp>self</span><span class=o>.</span><span class=n>mean_</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
<a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a>    <span class=c1># â† OlvidÃ© return self</span>
<a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a>
<a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a><span class=c1># AttributeError: &#39;NoneType&#39; object has no attribute &#39;transform&#39;</span>
</code></pre></div></p> <p><strong>SoluciÃ³n</strong>: Siempre <code>return self</code> en el mÃ©todo <code>fit()</code>.</p> <hr> <h2 id=quiz-del-modulo-semanas-7-8>ğŸ“ Quiz del MÃ³dulo â€” Semanas 7-8<a class=headerlink href=#quiz-del-modulo-semanas-7-8 title="Permanent link">&para;</a></h2> <h3 id=quiz-semana-7-sklearn-pipelines>Quiz Semana 7: sklearn Pipelines<a class=headerlink href=#quiz-semana-7-sklearn-pipelines title="Permanent link">&para;</a></h3> <h4 id=pregunta-1-25-pts>Pregunta 1 (25 pts)<a class=headerlink href=#pregunta-1-25-pts title="Permanent link">&para;</a></h4> <p>Â¿QuÃ© problema resuelve sklearn <code>Pipeline</code>?</p> <details> <summary>âœ… Respuesta</summary> 1. **Data leakage**: Encapsula fit/transform para que siempre se apliquen correctamente 2. **Reproducibilidad**: Un solo objeto `.pkl` contiene todo el preprocesamiento + modelo 3. **CÃ³digo mÃ¡s limpio**: Una llamada a `pipeline.predict()` en lugar de 10 lÃ­neas 4. **Cross-validation correcto**: `cross_val_score(pipeline, X, y)` hace fit/transform por fold </details> <h4 id=pregunta-2-25-pts>Pregunta 2 (25 pts)<a class=headerlink href=#pregunta-2-25-pts title="Permanent link">&para;</a></h4> <p>Â¿Por quÃ© <code>ColumnTransformer</code> es necesario?</p> <details> <summary>âœ… Respuesta</summary> Columnas diferentes necesitan transformaciones diferentes: - **NumÃ©ricas**: Imputar â†’ Escalar - **CategÃ³ricas**: Imputar â†’ OneHot/Target Encode ColumnTransformer aplica cada pipeline al subset correcto de columnas. </details> <h4 id=pregunta-3-25-pts>Pregunta 3 (25 pts)<a class=headerlink href=#pregunta-3-25-pts title="Permanent link">&para;</a></h4> <p>Â¿QuÃ© hace <code>handle_unknown="ignore"</code> en <code>OneHotEncoder</code>?</p> <details> <summary>âœ… Respuesta</summary> En producciÃ³n pueden llegar categorÃ­as no vistas en training: - `"error"` (default): Lanza error si ve categorÃ­a nueva - `"ignore"`: Pone 0 en todas las columnas one-hot - **RecomendaciÃ³n**: Siempre usar `"ignore"` para producciÃ³n. </details> <h4 id=ejercicio-practico-25-pts>ğŸ”§ Ejercicio PrÃ¡ctico (25 pts)<a class=headerlink href=#ejercicio-practico-25-pts title="Permanent link">&para;</a></h4> <p>Crea un Pipeline que impute numÃ©ricas con mediana, escale, impute categÃ³ricas con moda, one-hot encode, y use RandomForestClassifier.</p> <details> <summary>âœ… SoluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.compose</span><span class=w> </span><span class=kn>import</span> <span class=n>ColumnTransformer</span>
<a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.impute</span><span class=w> </span><span class=kn>import</span> <span class=n>SimpleImputer</span>
<a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>
<a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a>
<a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a><span class=n>num_pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a>    <span class=p>(</span><span class=s2>&quot;imputer&quot;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s2>&quot;median&quot;</span><span class=p>)),</span>
<a id=__codelineno-47-9 name=__codelineno-47-9 href=#__codelineno-47-9></a>    <span class=p>(</span><span class=s2>&quot;scaler&quot;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>
<a id=__codelineno-47-10 name=__codelineno-47-10 href=#__codelineno-47-10></a><span class=p>])</span>
<a id=__codelineno-47-11 name=__codelineno-47-11 href=#__codelineno-47-11></a>
<a id=__codelineno-47-12 name=__codelineno-47-12 href=#__codelineno-47-12></a><span class=n>cat_pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-47-13 name=__codelineno-47-13 href=#__codelineno-47-13></a>    <span class=p>(</span><span class=s2>&quot;imputer&quot;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s2>&quot;most_frequent&quot;</span><span class=p>)),</span>
<a id=__codelineno-47-14 name=__codelineno-47-14 href=#__codelineno-47-14></a>    <span class=p>(</span><span class=s2>&quot;encoder&quot;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s2>&quot;ignore&quot;</span><span class=p>))</span>
<a id=__codelineno-47-15 name=__codelineno-47-15 href=#__codelineno-47-15></a><span class=p>])</span>
<a id=__codelineno-47-16 name=__codelineno-47-16 href=#__codelineno-47-16></a>
<a id=__codelineno-47-17 name=__codelineno-47-17 href=#__codelineno-47-17></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>([</span>
<a id=__codelineno-47-18 name=__codelineno-47-18 href=#__codelineno-47-18></a>    <span class=p>(</span><span class=s2>&quot;num&quot;</span><span class=p>,</span> <span class=n>num_pipeline</span><span class=p>,</span> <span class=n>numerical_cols</span><span class=p>),</span>
<a id=__codelineno-47-19 name=__codelineno-47-19 href=#__codelineno-47-19></a>    <span class=p>(</span><span class=s2>&quot;cat&quot;</span><span class=p>,</span> <span class=n>cat_pipeline</span><span class=p>,</span> <span class=n>categorical_cols</span><span class=p>)</span>
<a id=__codelineno-47-20 name=__codelineno-47-20 href=#__codelineno-47-20></a><span class=p>])</span>
<a id=__codelineno-47-21 name=__codelineno-47-21 href=#__codelineno-47-21></a>
<a id=__codelineno-47-22 name=__codelineno-47-22 href=#__codelineno-47-22></a><span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-47-23 name=__codelineno-47-23 href=#__codelineno-47-23></a>    <span class=p>(</span><span class=s2>&quot;preprocessor&quot;</span><span class=p>,</span> <span class=n>preprocessor</span><span class=p>),</span>
<a id=__codelineno-47-24 name=__codelineno-47-24 href=#__codelineno-47-24></a>    <span class=p>(</span><span class=s2>&quot;classifier&quot;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>class_weight</span><span class=o>=</span><span class=s2>&quot;balanced&quot;</span><span class=p>))</span>
<a id=__codelineno-47-25 name=__codelineno-47-25 href=#__codelineno-47-25></a><span class=p>])</span>
</code></pre></div> </details> <hr> <div align=center> **Siguiente mÃ³dulo** â†’ [08. IngenierÃ­a de Features](08_INGENIERIA_FEATURES.md) --- [â† Volver al Ãndice](00_INDICE.md) </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Volver al principio </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 DuqueOM â€” GuÃ­a MLOps v2 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/DuqueOM target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://linkedin.com/in/duqueom target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>