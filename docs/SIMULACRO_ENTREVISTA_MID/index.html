<!doctype html><html lang=es class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Curso end-to-end para construir un portafolio ML/MLOps profesional desde cero"><meta name=author content=DuqueOM><link href=https://duqueom.github.io/Guia_MLOps/docs/SIMULACRO_ENTREVISTA_MID/ rel=canonical><link href=../SIMULACRO_ENTREVISTA_JUNIOR/ rel=prev><link href=../SIMULACRO_ENTREVISTA_SENIOR_PARTE1/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Mid - Gu√≠a MLOps ‚Äî Portfolio Edition v2</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#simulacro-de-entrevista-mid-level-ml-engineer class=md-skip> Saltar a contenido </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabecera> <a href=../.. title="Gu√≠a MLOps ‚Äî Portfolio Edition v2" class="md-header__button md-logo" aria-label="Gu√≠a MLOps ‚Äî Portfolio Edition v2" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Gu√≠a MLOps ‚Äî Portfolio Edition v2 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Mid </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Cambiar a modo oscuro" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Cambiar a modo claro" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Cambiar a modo claro" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=B√∫squeda placeholder=B√∫squeda autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Buscar> <button type=reset class="md-search__icon md-icon" title=Limpiar aria-label=Limpiar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando b√∫squeda </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/DuqueOM/Guia_MLOps title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Guia_MLOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Pesta√±as data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../ class=md-tabs__link> Inicio </a> </li> <li class=md-tabs__item> <a href=../00_INDICE/ class=md-tabs__link> √çndice Principal </a> </li> <li class=md-tabs__item> <a href=../SYLLABUS/ class=md-tabs__link> Syllabus </a> </li> <li class=md-tabs__item> <a href=../MAPA_PORTAFOLIO_1TO1/ class=md-tabs__link> Mapa 1:1 Portafolio </a> </li> <li class=md-tabs__item> <a href=../PLAN_ESTUDIOS/ class=md-tabs__link> Plan de Estudios </a> </li> <li class=md-tabs__item> <a href=../01_PYTHON_MODERNO/ class=md-tabs__link> Fase 1 - Fundamentos </a> </li> <li class=md-tabs__item> <a href=../07_SKLEARN_PIPELINES/ class=md-tabs__link> Fase 2 - ML Engineering </a> </li> <li class=md-tabs__item> <a href=../11_TESTING_ML/ class=md-tabs__link> Fase 3 - MLOps Core </a> </li> <li class=md-tabs__item> <a href=../17_DESPLIEGUE/ class=md-tabs__link> Fase 4 - Producci√≥n </a> </li> <li class=md-tabs__item> <a href=../19_DOCUMENTACION/ class=md-tabs__link> Fase 5 - Senior/Staff </a> </li> <li class=md-tabs__item> <a href=../apoyo/ class=md-tabs__link> Material de Apoyo </a> </li> <li class=md-tabs__item> <a href=../study_tools/ class=md-tabs__link> Herramientas de Estudio </a> </li> <li class=md-tabs__item> <a href=../../exams/EXAM_01_SETUP/ class=md-tabs__link> Ex√°menes </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../SIMULACRO_ENTREVISTA_JUNIOR/ class=md-tabs__link> Simulacros de Entrevista </a> </li> <li class=md-tabs__item> <a href=../../notebooks/labs/LAB_01_DOCKER_DEBUG/ class=md-tabs__link> Laboratorios </a> </li> <li class=md-tabs__item> <a href=../templates/ class=md-tabs__link> Plantillas </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navegaci√≥n data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Gu√≠a MLOps ‚Äî Portfolio Edition v2" class="md-nav__button md-logo" aria-label="Gu√≠a MLOps ‚Äî Portfolio Edition v2" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Gu√≠a MLOps ‚Äî Portfolio Edition v2 </label> <div class=md-nav__source> <a href=https://github.com/DuqueOM/Guia_MLOps title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Guia_MLOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Inicio </span> </a> </li> <li class=md-nav__item> <a href=../00_INDICE/ class=md-nav__link> <span class=md-ellipsis> √çndice Principal </span> </a> </li> <li class=md-nav__item> <a href=../SYLLABUS/ class=md-nav__link> <span class=md-ellipsis> Syllabus </span> </a> </li> <li class=md-nav__item> <a href=../MAPA_PORTAFOLIO_1TO1/ class=md-nav__link> <span class=md-ellipsis> Mapa 1:1 Portafolio </span> </a> </li> <li class=md-nav__item> <a href=../PLAN_ESTUDIOS/ class=md-nav__link> <span class=md-ellipsis> Plan de Estudios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Fase 1 - Fundamentos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Fase 1 - Fundamentos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01_PYTHON_MODERNO/ class=md-nav__link> <span class=md-ellipsis> 01 ‚Äî Python Moderno </span> </a> </li> <li class=md-nav__item> <a href=../02_DISENO_SISTEMAS/ class=md-nav__link> <span class=md-ellipsis> 02 ‚Äî Dise√±o de Sistemas </span> </a> </li> <li class=md-nav__item> <a href=../03_ESTRUCTURA_PROYECTO/ class=md-nav__link> <span class=md-ellipsis> 03 ‚Äî Estructura de Proyecto </span> </a> </li> <li class=md-nav__item> <a href=../04_ENTORNOS/ class=md-nav__link> <span class=md-ellipsis> 04 ‚Äî Entornos </span> </a> </li> <li class=md-nav__item> <a href=../05_GIT_PROFESIONAL/ class=md-nav__link> <span class=md-ellipsis> 05 ‚Äî Git Profesional </span> </a> </li> <li class=md-nav__item> <a href=../06_VERSIONADO_DATOS/ class=md-nav__link> <span class=md-ellipsis> 06 ‚Äî Versionado de Datos </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Fase 2 - ML Engineering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Fase 2 - ML Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../07_SKLEARN_PIPELINES/ class=md-nav__link> <span class=md-ellipsis> 07 ‚Äî sklearn Pipelines </span> </a> </li> <li class=md-nav__item> <a href=../08_INGENIERIA_FEATURES/ class=md-nav__link> <span class=md-ellipsis> 08 ‚Äî Ingenier√≠a de Features </span> </a> </li> <li class=md-nav__item> <a href=../09_TRAINING_PROFESIONAL/ class=md-nav__link> <span class=md-ellipsis> 09 ‚Äî Training Profesional </span> </a> </li> <li class=md-nav__item> <a href=../10_EXPERIMENT_TRACKING/ class=md-nav__link> <span class=md-ellipsis> 10 ‚Äî Experiment Tracking </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Fase 3 - MLOps Core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Fase 3 - MLOps Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../11_TESTING_ML/ class=md-nav__link> <span class=md-ellipsis> 11 ‚Äî Testing ML </span> </a> </li> <li class=md-nav__item> <a href=../12_CI_CD/ class=md-nav__link> <span class=md-ellipsis> 12 ‚Äî CI/CD </span> </a> </li> <li class=md-nav__item> <a href=../13_DOCKER/ class=md-nav__link> <span class=md-ellipsis> 13 ‚Äî Docker </span> </a> </li> <li class=md-nav__item> <a href=../14_FASTAPI/ class=md-nav__link> <span class=md-ellipsis> 14 ‚Äî FastAPI </span> </a> </li> <li class=md-nav__item> <a href=../15_STREAMLIT/ class=md-nav__link> <span class=md-ellipsis> 15 ‚Äî Streamlit </span> </a> </li> <li class=md-nav__item> <a href=../16_OBSERVABILIDAD/ class=md-nav__link> <span class=md-ellipsis> 16 ‚Äî Observabilidad </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Fase 4 - Producci√≥n </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Fase 4 - Producci√≥n </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../17_DESPLIEGUE/ class=md-nav__link> <span class=md-ellipsis> 17 ‚Äî Despliegue </span> </a> </li> <li class=md-nav__item> <a href=../18_INFRAESTRUCTURA/ class=md-nav__link> <span class=md-ellipsis> 18 ‚Äî Infraestructura </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0> <span class=md-ellipsis> Fase 5 - Senior/Staff </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Fase 5 - Senior/Staff </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../19_DOCUMENTACION/ class=md-nav__link> <span class=md-ellipsis> 19 ‚Äî Documentaci√≥n </span> </a> </li> <li class=md-nav__item> <a href=../20_OBSERVABILIDAD_AVANZADA_DRIFT/ class=md-nav__link> <span class=md-ellipsis> 20 ‚Äî Observabilidad Avanzada </span> </a> </li> <li class=md-nav__item> <a href=../21_CLOUD_FINOPS/ class=md-nav__link> <span class=md-ellipsis> 21 ‚Äî Cloud FinOps </span> </a> </li> <li class=md-nav__item> <a href=../22_IAC_EMPRESARIAL/ class=md-nav__link> <span class=md-ellipsis> 22 ‚Äî IaC Empresarial </span> </a> </li> <li class=md-nav__item> <a href=../23_PROYECTO_INTEGRADOR/ class=md-nav__link> <span class=md-ellipsis> 23 ‚Äî Proyecto Integrador </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0> <span class=md-ellipsis> Material de Apoyo </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Material de Apoyo </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../apoyo/ class=md-nav__link> <span class=md-ellipsis> √çndice Apoyo </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GLOSARIO/ class=md-nav__link> <span class=md-ellipsis> Glosario MLOps </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/CHECKLIST/ class=md-nav__link> <span class=md-ellipsis> Checklist Profesional </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/RECURSOS/ class=md-nav__link> <span class=md-ellipsis> Recursos Externos </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/RUBRICA_EVALUACION/ class=md-nav__link> <span class=md-ellipsis> R√∫brica de Evaluaci√≥n </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/PLANTILLAS/ class=md-nav__link> <span class=md-ellipsis> Plantillas </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GUIA_AUDIOVISUAL/ class=md-nav__link> <span class=md-ellipsis> Gu√≠a Audiovisual </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/MAINTENANCE_GUIDE/ class=md-nav__link> <span class=md-ellipsis> Gu√≠a de Mantenimiento </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GUIA_SCRIPTS_OPERACIONALES/ class=md-nav__link> <span class=md-ellipsis> Scripts Operacionales </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_12> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex=0> <span class=md-ellipsis> Herramientas de Estudio </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_12_label aria-expanded=false> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Herramientas de Estudio </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../study_tools/ class=md-nav__link> <span class=md-ellipsis> √çndice </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/PROTOCOLO_E/ class=md-nav__link> <span class=md-ellipsis> Protocolo E </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/DIARIO_ERRORES/ class=md-nav__link> <span class=md-ellipsis> Diario de Errores </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/CIERRE_SEMANAL/ class=md-nav__link> <span class=md-ellipsis> Cierre Semanal </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13> <label class=md-nav__link for=__nav_13 id=__nav_13_label tabindex=0> <span class=md-ellipsis> Ex√°menes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_13_label aria-expanded=false> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> Ex√°menes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../exams/EXAM_01_SETUP/ class=md-nav__link> <span class=md-ellipsis> Exam 01 ‚Äî Setup </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_02_PIPELINE/ class=md-nav__link> <span class=md-ellipsis> Exam 02 ‚Äî Pipeline </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_03_TESTING/ class=md-nav__link> <span class=md-ellipsis> Exam 03 ‚Äî Testing </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_04_DEPLOYMENT/ class=md-nav__link> <span class=md-ellipsis> Exam 04 ‚Äî Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_05_PRODUCTION/ class=md-nav__link> <span class=md-ellipsis> Exam 05 ‚Äî Production </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_06_INTEGRATION/ class=md-nav__link> <span class=md-ellipsis> Exam 06 ‚Äî Integration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_14 checked> <label class=md-nav__link for=__nav_14 id=__nav_14_label tabindex> <span class=md-ellipsis> Simulacros de Entrevista </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_14_label aria-expanded=true> <label class=md-nav__title for=__nav_14> <span class="md-nav__icon md-icon"></span> Simulacros de Entrevista </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_JUNIOR/ class=md-nav__link> <span class=md-ellipsis> Junior </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Mid </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Mid </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#portafolio-mlops-60-preguntas-tecnicas class=md-nav__link> <span class=md-ellipsis> Portafolio MLOps ‚Äî 60 Preguntas T√©cnicas </span> </a> </li> <li class=md-nav__item> <a href=#indice class=md-nav__link> <span class=md-ellipsis> üìã √çndice </span> </a> </li> <li class=md-nav__item> <a href=#que-se-espera-de-un-mid-level class=md-nav__link> <span class=md-ellipsis> üéØ ¬øQu√© se espera de un Mid-Level? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_SENIOR_PARTE1/ class=md-nav__link> <span class=md-ellipsis> Senior Parte 1 </span> </a> </li> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_SENIOR_PARTE2/ class=md-nav__link> <span class=md-ellipsis> Senior Parte 2 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_15> <label class=md-nav__link for=__nav_15 id=__nav_15_label tabindex=0> <span class=md-ellipsis> Laboratorios </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_15_label aria-expanded=false> <label class=md-nav__title for=__nav_15> <span class="md-nav__icon md-icon"></span> Laboratorios </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_01_DOCKER_DEBUG/ class=md-nav__link> <span class=md-ellipsis> LAB 01 ‚Äî Docker Debug </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_02_PANDAS_PERFORMANCE/ class=md-nav__link> <span class=md-ellipsis> LAB 02 ‚Äî Pandas Performance </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_03_DEPENDENCY_CONFLICTS/ class=md-nav__link> <span class=md-ellipsis> LAB 03 ‚Äî Dependency Conflicts </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/07_08_sklearn_pipelines/ class=md-nav__link> <span class=md-ellipsis> üîß Notebook Interactivo: sklearn Pipelines y Feature Engineering </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_16> <label class=md-nav__link for=__nav_16 id=__nav_16_label tabindex=0> <span class=md-ellipsis> Plantillas </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_16_label aria-expanded=false> <label class=md-nav__title for=__nav_16> <span class="md-nav__icon md-icon"></span> Plantillas </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../templates/ class=md-nav__link> <span class=md-ellipsis> √çndice Plantillas </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#portafolio-mlops-60-preguntas-tecnicas class=md-nav__link> <span class=md-ellipsis> Portafolio MLOps ‚Äî 60 Preguntas T√©cnicas </span> </a> </li> <li class=md-nav__item> <a href=#indice class=md-nav__link> <span class=md-ellipsis> üìã √çndice </span> </a> </li> <li class=md-nav__item> <a href=#que-se-espera-de-un-mid-level class=md-nav__link> <span class=md-ellipsis> üéØ ¬øQu√© se espera de un Mid-Level? </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=simulacro-de-entrevista-mid-level-ml-engineer>üéØ Simulacro de Entrevista Mid-Level ML Engineer<a class=headerlink href=#simulacro-de-entrevista-mid-level-ml-engineer title="Permanent link">&para;</a></h1> <h2 id=portafolio-mlops-60-preguntas-tecnicas>Portafolio MLOps ‚Äî 60 Preguntas T√©cnicas<a class=headerlink href=#portafolio-mlops-60-preguntas-tecnicas title="Permanent link">&para;</a></h2> <p><strong>Nivel</strong>: Mid (2-4 a√±os de experiencia)<br> <strong>Versi√≥n</strong>: 1.0 | Diciembre 2025</p> <hr> <h2 id=indice>üìã √çndice<a class=headerlink href=#indice title="Permanent link">&para;</a></h2> <ol> <li><a href=#1-pipelines-y-arquitectura-preguntas-1-15>Pipelines y Arquitectura</a></li> <li><a href=#2-mlops-pr√°ctico-preguntas-16-30>MLOps Pr√°ctico</a></li> <li><a href=#3-testing-y-calidad-preguntas-31-40>Testing y Calidad</a></li> <li><a href=#4-deployment-y-apis-preguntas-41-50>Deployment y APIs</a></li> <li><a href=#5-escenarios-pr√°cticos-preguntas-51-60>Escenarios Pr√°cticos</a></li> </ol> <hr> <h2 id=que-se-espera-de-un-mid-level>üéØ ¬øQu√© se espera de un Mid-Level?<a class=headerlink href=#que-se-espera-de-un-mid-level title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>S√≠ se espera</th> <th>No se espera (a√∫n)</th> </tr> </thead> <tbody> <tr> <td>Dise√±ar pipelines end-to-end</td> <td>Arquitecturas distribuidas complejas</td> </tr> <tr> <td>Implementar CI/CD funcional</td> <td>Optimizaci√≥n de infraestructura a escala</td> </tr> <tr> <td>Debugging aut√≥nomo</td> <td>Mentoring de equipos</td> </tr> <tr> <td>Code reviews</td> <td>Decisiones de arquitectura cr√≠ticas</td> </tr> <tr> <td>Escribir tests comprehensivos</td> <td>Dise√±o de sistemas desde cero</td> </tr> </tbody> </table> <hr> <h1 id=1-pipelines-y-arquitectura-preguntas-1-15>1. Pipelines y Arquitectura (Preguntas 1-15)<a class=headerlink href=#1-pipelines-y-arquitectura-preguntas-1-15 title="Permanent link">&para;</a></h1> <h2 id=pregunta-1-pipeline-unificado>Pregunta 1: Pipeline Unificado<a class=headerlink href=#pregunta-1-pipeline-unificado title="Permanent link">&para;</a></h2> <p><strong>¬øPor qu√© usar un Pipeline unificado en lugar de artefactos separados?</strong></p> <h3 id=respuesta>Respuesta:<a class=headerlink href=#respuesta title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># ‚ùå Antes: artefactos separados</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;preprocessor.pkl&quot;</span><span class=p>)</span>  <span class=c1># Cargar preprocesador.</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>model</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;model.pkl&quot;</span><span class=p>)</span>                <span class=c1># Cargar modelo por separado.</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=n>X</span> <span class=o>=</span> <span class=n>preprocessor</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>                   <span class=c1># Transformar manualmente.</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=n>pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>                         <span class=c1># Predecir.</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># ‚úÖ Despu√©s: pipeline unificado</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=n>pipe</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;pipeline.joblib&quot;</span><span class=p>)</span>           <span class=c1># TODO en un archivo.</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=n>pred</span> <span class=o>=</span> <span class=n>pipe</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>                          <span class=c1># Una llamada hace todo.</span>
</code></pre></div> <p><strong>Beneficios</strong>: 1. Elimina training-serving skew 2. Single source of truth 3. Versionado simple 4. Deploy m√°s limpio</p> <hr> <h2 id=pregunta-2-columntransformer>Pregunta 2: ColumnTransformer<a class=headerlink href=#pregunta-2-columntransformer title="Permanent link">&para;</a></h2> <p><strong>Explica el ColumnTransformer del portafolio.</strong></p> <h3 id=respuesta_1>Respuesta:<a class=headerlink href=#respuesta_1 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>preprocessor</span> <span class=o>=</span> <span class=n>ColumnTransformer</span><span class=p>([</span>               <span class=c1># Aplica transformaciones por tipo de columna.</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>                           <span class=c1># Pipeline para num√©ricas.</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>        <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;median&#39;</span><span class=p>)),</span>  <span class=c1># Imputa con mediana.</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>        <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>())</span>             <span class=c1># Estandariza.</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>    <span class=p>]),</span> <span class=n>numerical_cols</span><span class=p>),</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=p>(</span><span class=s1>&#39;cat&#39;</span><span class=p>,</span> <span class=n>Pipeline</span><span class=p>([</span>                           <span class=c1># Pipeline para categ√≥ricas.</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>        <span class=p>(</span><span class=s1>&#39;imputer&#39;</span><span class=p>,</span> <span class=n>SimpleImputer</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s1>&#39;constant&#39;</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=s1>&#39;Unknown&#39;</span><span class=p>)),</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>        <span class=p>(</span><span class=s1>&#39;encoder&#39;</span><span class=p>,</span> <span class=n>OneHotEncoder</span><span class=p>(</span><span class=n>handle_unknown</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>))</span>  <span class=c1># One-hot encoding.</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=p>]),</span> <span class=n>categorical_cols</span><span class=p>),</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=p>],</span> <span class=n>remainder</span><span class=o>=</span><span class=s1>&#39;drop&#39;</span><span class=p>)</span>                             <span class=c1># Elimina columnas no especificadas.</span>
</code></pre></div> <p><strong>Procesa columnas en paralelo</strong>: num√©ricas y categ√≥ricas tienen transformaciones distintas.</p> <hr> <h2 id=pregunta-3-custom-transformer>Pregunta 3: Custom Transformer<a class=headerlink href=#pregunta-3-custom-transformer title="Permanent link">&para;</a></h2> <p><strong>¬øCu√°ndo crear un transformer personalizado?</strong></p> <h3 id=respuesta_2>Respuesta:<a class=headerlink href=#respuesta_2 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>class</span><span class=w> </span><span class=nc>FeatureEngineer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>  <span class=c1># Hereda para compatibilidad con Pipeline.</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>    <span class=k>def</span><span class=w> </span><span class=nf>fit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>                    <span class=c1># fit: aprende de datos (aqu√≠ no hace nada).</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>        <span class=k>return</span> <span class=bp>self</span>                              <span class=c1># Retorna self para encadenar.</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>                      <span class=c1># transform: aplica transformaci√≥n.</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>                             <span class=c1># Copia para no modificar original.</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>        <span class=n>X</span><span class=p>[</span><span class=s1>&#39;vehicle_age&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2024</span> <span class=o>-</span> <span class=n>X</span><span class=p>[</span><span class=s1>&#39;model_year&#39;</span><span class=p>]</span>  <span class=c1># Crea feature derivada.</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>        <span class=k>return</span> <span class=n>X</span>
</code></pre></div> <p><strong>Cu√°ndo usar</strong>: - L√≥gica de negocio espec√≠fica - Features derivadas - Transformaciones no est√°ndar</p> <hr> <h2 id=pregunta-4-estratified-split>Pregunta 4: Estratified Split<a class=headerlink href=#pregunta-4-estratified-split title="Permanent link">&para;</a></h2> <p><strong>¬øPor qu√© stratify=y en train_test_split?</strong></p> <h3 id=respuesta_3>Respuesta:<a class=headerlink href=#respuesta_3 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>  <span class=c1># stratify: mantiene proporci√≥n de clases.</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=p>)</span>
</code></pre></div> <p>Con clases desbalanceadas (80/20 churn), <code>stratify=y</code> garantiza que train y test mantengan la misma proporci√≥n. Sin esto, un split aleatorio podr√≠a dar 85/15 en train y 70/30 en test.</p> <hr> <h2 id=pregunta-5-hyperparameter-tuning>Pregunta 5: Hyperparameter Tuning<a class=headerlink href=#pregunta-5-hyperparameter-tuning title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo optimizas hiperpar√°metros?</strong></p> <h3 id=respuesta_4>Respuesta:<a class=headerlink href=#respuesta_4 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomizedSearchCV</span>  <span class=c1># B√∫squeda aleatoria de hiperpar√°metros.</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>param_dist</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>    <span class=s1>&#39;model__n_estimators&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>200</span><span class=p>],</span>       <span class=c1># model__: accede a params del paso &#39;model&#39;.</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>    <span class=s1>&#39;model__max_depth&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=p>}</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>search</span> <span class=o>=</span> <span class=n>RandomizedSearchCV</span><span class=p>(</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>    <span class=n>pipe</span><span class=p>,</span> <span class=n>param_dist</span><span class=p>,</span> <span class=n>n_iter</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;f1&#39;</span>  <span class=c1># n_iter: 20 combinaciones aleatorias.</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=p>)</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=n>search</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>                     <span class=c1># Prueba combinaciones con CV.</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=nb>print</span><span class=p>(</span><span class=n>search</span><span class=o>.</span><span class=n>best_params_</span><span class=p>)</span>                       <span class=c1># Mejores hiperpar√°metros encontrados.</span>
</code></pre></div> <p><strong>GridSearch vs RandomizedSearch</strong>: Random es m√°s eficiente con muchos par√°metros.</p> <hr> <h2 id=pregunta-6-metricas-de-negocio>Pregunta 6: M√©tricas de Negocio<a class=headerlink href=#pregunta-6-metricas-de-negocio title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo traduces m√©tricas ML a valor de negocio?</strong></p> <h3 id=respuesta_5>Respuesta:<a class=headerlink href=#respuesta_5 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1># Costo de falsos negativos (cliente que churns sin detectar)</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>cost_fn</span> <span class=o>=</span> <span class=mi>500</span>                                    <span class=c1># Costo de adquirir cliente nuevo.</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=c1># Costo de falsos positivos (retenci√≥n innecesaria)</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=n>cost_fp</span> <span class=o>=</span> <span class=mi>50</span>                                     <span class=c1># Costo de campa√±a de retenci√≥n.</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=c1># Costo total</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=n>total_cost</span> <span class=o>=</span> <span class=p>(</span><span class=n>FN</span> <span class=o>*</span> <span class=n>cost_fn</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>FP</span> <span class=o>*</span> <span class=n>cost_fp</span><span class=p>)</span>     <span class=c1># M√©trica de negocio: minimizar esto.</span>
</code></pre></div> <p>Optimizar para <strong>minimizar costo total</strong>, no solo accuracy.</p> <hr> <h2 id=pregunta-7-ensemble-methods>Pregunta 7: Ensemble Methods<a class=headerlink href=#pregunta-7-ensemble-methods title="Permanent link">&para;</a></h2> <p><strong>Explica VotingClassifier con soft voting.</strong></p> <h3 id=respuesta_6>Respuesta:<a class=headerlink href=#respuesta_6 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>ensemble</span> <span class=o>=</span> <span class=n>VotingClassifier</span><span class=p>([</span>                    <span class=c1># Combina m√∫ltiples modelos.</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>    <span class=p>(</span><span class=s1>&#39;lr&#39;</span><span class=p>,</span> <span class=n>LogisticRegression</span><span class=p>()),</span>                <span class=c1># Modelo lineal.</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    <span class=p>(</span><span class=s1>&#39;rf&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>             <span class=c1># Modelo no-lineal.</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=p>],</span> <span class=n>voting</span><span class=o>=</span><span class=s1>&#39;soft&#39;</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=p>[</span><span class=mf>0.4</span><span class=p>,</span> <span class=mf>0.6</span><span class=p>])</span>            <span class=c1># soft: promedia probabilidades. weights: RF pesa m√°s.</span>
</code></pre></div> <ul> <li><strong>Soft voting</strong>: Promedia probabilidades (mejor que votos binarios)</li> <li><strong>Weights</strong>: RF tiene m√°s peso porque tiene mejor AUC individual</li> <li><strong>Complementariedad</strong>: LR lineal + RF no-lineal = menor varianza</li> </ul> <hr> <h2 id=pregunta-8-cross-validation-avanzado>Pregunta 8: Cross-Validation Avanzado<a class=headerlink href=#pregunta-8-cross-validation-avanzado title="Permanent link">&para;</a></h2> <p><strong>¬øCu√°ndo usar TimeSeriesSplit vs StratifiedKFold?</strong></p> <h3 id=respuesta_7>Respuesta:<a class=headerlink href=#respuesta_7 title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Tipo</th> <th>Usar cuando</th> </tr> </thead> <tbody> <tr> <td>StratifiedKFold</td> <td>Clasificaci√≥n con clases desbalanceadas</td> </tr> <tr> <td>TimeSeriesSplit</td> <td>Datos temporales (evitar data leakage temporal)</td> </tr> <tr> <td>GroupKFold</td> <td>Datos con grupos (ej: m√∫ltiples muestras por paciente)</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>TimeSeriesSplit</span>  <span class=c1># CV para datos temporales.</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=n>tscv</span> <span class=o>=</span> <span class=n>TimeSeriesSplit</span><span class=p>(</span><span class=n>n_splits</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>               <span class=c1># 5 splits temporales.</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=c1># Train: [1,2,3], Test: [4]                      # Nunca usa datos futuros para entrenar.</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=c1># Train: [1,2,3,4], Test: [5]                    # El train crece, test siempre es &quot;futuro&quot;.</span>
</code></pre></div> <hr> <h2 id=pregunta-9-feature-importance>Pregunta 9: Feature Importance<a class=headerlink href=#pregunta-9-feature-importance title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo explicas qu√© features son importantes?</strong></p> <h3 id=respuesta_8>Respuesta:<a class=headerlink href=#respuesta_8 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># 1. Importancia de RF</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=n>importances</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>feature_importances_</span>         <span class=c1># Importancia basada en reducci√≥n de impureza.</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1># 2. Permutation importance (m√°s robusto)</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.inspection</span><span class=w> </span><span class=kn>import</span> <span class=n>permutation_importance</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=n>perm</span> <span class=o>=</span> <span class=n>permutation_importance</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>  <span class=c1># Permuta features y mide impacto.</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=c1># 3. SHAP (m√°s interpretable)</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=kn>import</span><span class=w> </span><span class=nn>shap</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=n>explainer</span> <span class=o>=</span> <span class=n>shap</span><span class=o>.</span><span class=n>TreeExplainer</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>            <span class=c1># Explainer para modelos de √°rboles.</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=n>shap_values</span> <span class=o>=</span> <span class=n>explainer</span><span class=o>.</span><span class=n>shap_values</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>      <span class=c1># Contribuci√≥n de cada feature por predicci√≥n.</span>
</code></pre></div> <hr> <h2 id=pregunta-10-handling-categorical-high-cardinality>Pregunta 10: Handling Categorical High Cardinality<a class=headerlink href=#pregunta-10-handling-categorical-high-cardinality title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo manejas categor√≠as con muchos valores √∫nicos?</strong></p> <h3 id=respuesta_9>Respuesta:<a class=headerlink href=#respuesta_9 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># 1. Target encoding (con cuidado de leakage)</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=kn>from</span><span class=w> </span><span class=nn>category_encoders</span><span class=w> </span><span class=kn>import</span> <span class=n>TargetEncoder</span>      <span class=c1># Codifica con media del target.</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=n>encoder</span> <span class=o>=</span> <span class=n>TargetEncoder</span><span class=p>()</span>                        <span class=c1># ‚ö†Ô∏è Usar solo en train para evitar leakage.</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=c1># 2. Frequency encoding</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=n>X</span><span class=p>[</span><span class=s1>&#39;brand_freq&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=s1>&#39;brand&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=s1>&#39;brand&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>(</span><span class=n>normalize</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>  <span class=c1># Frecuencia relativa.</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=c1># 3. Grouping rare categories</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=n>X</span><span class=p>[</span><span class=s1>&#39;brand&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=s1>&#39;brand&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=k>if</span> <span class=n>freq</span><span class=p>[</span><span class=n>x</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mf>0.01</span> <span class=k>else</span> <span class=s1>&#39;Other&#39;</span><span class=p>)</span>  <span class=c1># Agrupa raras en &#39;Other&#39;.</span>
</code></pre></div> <hr> <h2 id=pregunta-11-reproducibilidad>Pregunta 11: Reproducibilidad<a class=headerlink href=#pregunta-11-reproducibilidad title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo garantizas experimentos reproducibles?</strong></p> <h3 id=respuesta_10>Respuesta:<a class=headerlink href=#respuesta_10 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># 1. Seeds</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=n>SEED</span> <span class=o>=</span> <span class=mi>42</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=n>SEED</span><span class=p>)</span>                             <span class=c1># Seed numpy.</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=n>SEED</span><span class=p>)</span>                                <span class=c1># Seed random.</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=c1># 2. Config versionada</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=n>config</span> <span class=o>=</span> <span class=n>BankChurnConfig</span><span class=o>.</span><span class=n>from_yaml</span><span class=p>(</span><span class=s2>&quot;configs/config.yaml&quot;</span><span class=p>)</span>  <span class=c1># Pydantic valida.</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=c1># 3. MLflow tracking</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=n>mlflow</span><span class=o>.</span><span class=n>log_params</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>dict</span><span class=p>())</span>           <span class=c1># Guarda hiperpar√°metros.</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=n>mlflow</span><span class=o>.</span><span class=n>log_artifact</span><span class=p>(</span><span class=s2>&quot;configs/config.yaml&quot;</span><span class=p>)</span>       <span class=c1># Guarda archivo de config.</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=c1># 4. Dependencias fijas</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=c1># pyproject.toml con versiones espec√≠ficas       # sklearn==1.3.0, no sklearn.</span>
</code></pre></div> <hr> <h2 id=pregunta-12-data-validation>Pregunta 12: Data Validation<a class=headerlink href=#pregunta-12-data-validation title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo validas datos de entrada en producci√≥n?</strong></p> <h3 id=respuesta_11>Respuesta:<a class=headerlink href=#respuesta_11 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseModel</span><span class=p>,</span> <span class=n>Field</span><span class=p>,</span> <span class=n>validator</span>  <span class=c1># Pydantic para validaci√≥n.</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=k>class</span><span class=w> </span><span class=nc>PredictionInput</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>                <span class=c1># Schema de entrada.</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>    <span class=n>credit_score</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>le</span><span class=o>=</span><span class=mi>850</span><span class=p>)</span>    <span class=c1># ge/le: rangos v√°lidos.</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>    <span class=n>age</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>le</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>    <span class=n>geography</span><span class=p>:</span> <span class=nb>str</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>    <span class=nd>@validator</span><span class=p>(</span><span class=s1>&#39;geography&#39;</span><span class=p>)</span>                      <span class=c1># Validador custom.</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>    <span class=k>def</span><span class=w> </span><span class=nf>validate_geography</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>v</span><span class=p>):</span>              <span class=c1># v: valor a validar.</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>        <span class=n>valid</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;France&#39;</span><span class=p>,</span> <span class=s1>&#39;Germany&#39;</span><span class=p>,</span> <span class=s1>&#39;Spain&#39;</span><span class=p>]</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>        <span class=k>if</span> <span class=n>v</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>valid</span><span class=p>:</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Must be one of </span><span class=si>{</span><span class=n>valid</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>  <span class=c1># Error descriptivo.</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>        <span class=k>return</span> <span class=n>v</span>                                 <span class=c1># Retorna valor validado.</span>
</code></pre></div> <p>Pydantic valida antes de que llegue al modelo.</p> <hr> <h2 id=pregunta-13-config-management>Pregunta 13: Config Management<a class=headerlink href=#pregunta-13-config-management title="Permanent link">&para;</a></h2> <p><strong>¬øPor qu√© Pydantic para configuraci√≥n?</strong></p> <h3 id=respuesta_12>Respuesta:<a class=headerlink href=#respuesta_12 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>class</span><span class=w> </span><span class=nc>ModelConfig</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>    <span class=n>model_type</span><span class=p>:</span> <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;rf&quot;</span><span class=p>,</span> <span class=s2>&quot;lr&quot;</span><span class=p>,</span> <span class=s2>&quot;xgb&quot;</span><span class=p>]</span>        <span class=c1># Solo estos valores permitidos.</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>    <span class=n>n_estimators</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=n>Field</span><span class=p>(</span><span class=n>ge</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>le</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>     <span class=c1># Rango v√°lido.</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>    <span class=nd>@validator</span><span class=p>(</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>)</span>                    <span class=c1># Validaci√≥n cross-field.</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>    <span class=k>def</span><span class=w> </span><span class=nf>validate_estimators</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>values</span><span class=p>):</span>     <span class=c1># values: otros campos ya validados.</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>        <span class=k>if</span> <span class=n>values</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;model_type&#39;</span><span class=p>)</span> <span class=o>==</span> <span class=s1>&#39;lr&#39;</span> <span class=ow>and</span> <span class=n>v</span> <span class=o>!=</span> <span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s1>&#39;LR no usa n_estimators&#39;</span><span class=p>)</span>  <span class=c1># L√≥gica de negocio.</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>        <span class=k>return</span> <span class=n>v</span>
</code></pre></div> <p><strong>Beneficios</strong>: Validaci√≥n autom√°tica, tipos claros, errores descriptivos, documentaci√≥n impl√≠cita.</p> <hr> <h2 id=pregunta-14-artifact-management>Pregunta 14: Artifact Management<a class=headerlink href=#pregunta-14-artifact-management title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo organizas artefactos del modelo?</strong></p> <h3 id=respuesta_13>Respuesta:<a class=headerlink href=#respuesta_13 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>artifacts/
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>‚îú‚îÄ‚îÄ pipeline.joblib       # Modelo + preprocessor
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>‚îú‚îÄ‚îÄ training_results.json # M√©tricas
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>‚îú‚îÄ‚îÄ config.yaml          # Config usada
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>‚îî‚îÄ‚îÄ feature_names.json   # Features esperadas
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># Guardar</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipe</span><span class=p>,</span> <span class=s1>&#39;artifacts/pipeline.joblib&#39;</span><span class=p>)</span>   <span class=c1># Serializa pipeline completo.</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;artifacts/training_results.json&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>metrics</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>                        <span class=c1># Guarda m√©tricas como JSON.</span>
</code></pre></div> <hr> <h2 id=pregunta-15-model-versioning>Pregunta 15: Model Versioning<a class=headerlink href=#pregunta-15-model-versioning title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo versionas modelos?</strong></p> <h3 id=respuesta_14>Respuesta:<a class=headerlink href=#respuesta_14 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=c1># 1. MLflow Model Registry</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=n>mlflow</span><span class=o>.</span><span class=n>sklearn</span><span class=o>.</span><span class=n>log_model</span><span class=p>(</span><span class=n>pipe</span><span class=p>,</span> <span class=s2>&quot;model&quot;</span><span class=p>)</span>          <span class=c1># Guarda modelo en MLflow.</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=c1># Registrar como v1, v2, etc.                    # UI permite promover a staging/production.</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=c1># 2. Naming convention</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=n>model_name</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;bankchurn_v</span><span class=si>{</span><span class=n>version</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>.joblib&quot;</span>  <span class=c1># Nombre descriptivo.</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=c1># 3. Git tags</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=n>git</span> <span class=n>tag</span> <span class=o>-</span><span class=n>a</span> <span class=n>v1</span><span class=mf>.0.0</span> <span class=o>-</span><span class=n>m</span> <span class=s2>&quot;Model v1.0.0: AUC 0.85&quot;</span>   <span class=c1># Asocia versi√≥n de c√≥digo con modelo.</span>
</code></pre></div> <hr> <h1 id=2-mlops-pr√°ctico-preguntas-16-30>2. MLOps Pr√°ctico (Preguntas 16-30)<a class=headerlink href=#2-mlops-pr√°ctico-preguntas-16-30 title="Permanent link">&para;</a></h1> <h2 id=pregunta-16-mlflow-tracking>Pregunta 16: MLflow Tracking<a class=headerlink href=#pregunta-16-mlflow-tracking title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo usas MLflow para tracking?</strong></p> <h3 id=respuesta_15>Respuesta:<a class=headerlink href=#respuesta_15 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>import</span><span class=w> </span><span class=nn>mlflow</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=k>with</span> <span class=n>mlflow</span><span class=o>.</span><span class=n>start_run</span><span class=p>():</span>                         <span class=c1># Context manager: crea y cierra run.</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>    <span class=n>mlflow</span><span class=o>.</span><span class=n>log_params</span><span class=p>({</span><span class=s2>&quot;n_estimators&quot;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>10</span><span class=p>})</span>  <span class=c1># Hiperpar√°metros.</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>    <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metrics</span><span class=p>({</span><span class=s2>&quot;auc&quot;</span><span class=p>:</span> <span class=mf>0.85</span><span class=p>,</span> <span class=s2>&quot;f1&quot;</span><span class=p>:</span> <span class=mf>0.78</span><span class=p>})</span>  <span class=c1># M√©tricas de evaluaci√≥n.</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>    <span class=n>mlflow</span><span class=o>.</span><span class=n>sklearn</span><span class=o>.</span><span class=n>log_model</span><span class=p>(</span><span class=n>pipe</span><span class=p>,</span> <span class=s2>&quot;model&quot;</span><span class=p>)</span>      <span class=c1># Guarda modelo serializado.</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>    <span class=n>mlflow</span><span class=o>.</span><span class=n>log_artifact</span><span class=p>(</span><span class=s2>&quot;configs/config.yaml&quot;</span><span class=p>)</span>   <span class=c1># Guarda archivos adicionales.</span>
</code></pre></div> <hr> <h2 id=pregunta-17-dvc>Pregunta 17: DVC<a class=headerlink href=#pregunta-17-dvc title="Permanent link">&para;</a></h2> <p><strong>¬øPara qu√© usas DVC?</strong></p> <h3 id=respuesta_16>Respuesta:<a class=headerlink href=#respuesta_16 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c1># Trackear datos</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>dvc<span class=w> </span>add<span class=w> </span>data/raw/Churn.csv<span class=w>                       </span><span class=c1># Crea .dvc file, a√±ade datos a .gitignore.</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=c1># Push a remote</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>dvc<span class=w> </span>push<span class=w>                                         </span><span class=c1># Sube datos a remote (S3, GCS, etc.).</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=c1># Pull datos</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>dvc<span class=w> </span>pull<span class=w>                                         </span><span class=c1># Descarga datos del remote.</span>
</code></pre></div> <p><strong>Beneficio</strong>: Versionar datos grandes sin subirlos a Git.</p> <hr> <h2 id=pregunta-18-github-actions-ci>Pregunta 18: GitHub Actions CI<a class=headerlink href=#pregunta-18-github-actions-ci title="Permanent link">&para;</a></h2> <p><strong>Explica el workflow CI del portafolio.</strong></p> <h3 id=respuesta_17>Respuesta:<a class=headerlink href=#respuesta_17 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">CI</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=nt>on</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=nv>push</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>pull_request</span><span class="p p-Indicator">]</span><span class=w>                         </span><span class=c1># Triggers del workflow.</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=nt>jobs</span><span class=p>:</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=w>  </span><span class=nt>test</span><span class=p>:</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span><span class=w>                       </span><span class=c1># Runner de GitHub.</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span><span class=w>                </span><span class=c1># Clona el repo.</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pip install -e &quot;.[dev]&quot;</span><span class=w>             </span><span class=c1># Instala dependencias.</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pytest tests/ --cov=src</span><span class=w>             </span><span class=c1># Ejecuta tests con coverage.</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ruff check src/</span><span class=w>                     </span><span class=c1># Linting.</span>
</code></pre></div> <p><strong>Flujo</strong>: Push ‚Üí Install ‚Üí Test ‚Üí Lint ‚Üí Pass/Fail badge.</p> <hr> <h2 id=pregunta-19-pre-commit-hooks>Pregunta 19: Pre-commit Hooks<a class=headerlink href=#pregunta-19-pre-commit-hooks title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© hooks usas?</strong></p> <h3 id=respuesta_18>Respuesta:<a class=headerlink href=#respuesta_18 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># .pre-commit-config.yaml</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=nt>repos</span><span class=p>:</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/astral-sh/ruff-pre-commit</span><span class=w>  </span><span class=c1># Linter r√°pido.</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>    </span><span class=nt>hooks</span><span class=p>:</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ruff</span><span class=w>                                 </span><span class=c1># Verifica estilo.</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ruff-format</span><span class=w>                          </span><span class=c1># Auto-formatea.</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/pre-commit/mirrors-mypy</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>    </span><span class=nt>hooks</span><span class=p>:</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mypy</span><span class=w>                                 </span><span class=c1># Verificaci√≥n de tipos.</span>
</code></pre></div> <p>Ejecutan autom√°ticamente antes de cada commit.</p> <hr> <h2 id=pregunta-20-docker-multi-stage>Pregunta 20: Docker Multi-stage<a class=headerlink href=#pregunta-20-docker-multi-stage title="Permanent link">&para;</a></h2> <p><strong>Explica el Dockerfile del portafolio.</strong></p> <h3 id=respuesta_19>Respuesta:<a class=headerlink href=#respuesta_19 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c># Build stage</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=k>FROM</span><span class=w> </span><span class=s>python:3.11-slim</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s>builder</span><span class=w>                </span>#<span class=w> </span>Stage<span class=w> </span>de<span class=w> </span>compilaci√≥n.
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=k>COPY</span><span class=w> </span>requirements.txt<span class=w> </span>.
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=k>RUN</span><span class=w> </span>pip<span class=w> </span>wheel<span class=w> </span>--no-cache-dir<span class=w> </span>-w<span class=w> </span>/wheels<span class=w> </span>-r<span class=w> </span>requirements.txt<span class=w>  </span>#<span class=w> </span>Genera<span class=w> </span>wheels.
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=c># Runtime stage</span>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=k>FROM</span><span class=w> </span><span class=s>python:3.11-slim</span><span class=w>                           </span><span class=c># Imagen limpia, sin herramientas de build.</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=k>COPY</span><span class=w> </span>--from<span class=o>=</span>builder<span class=w> </span>/wheels<span class=w> </span>/wheels<span class=w>             </span>#<span class=w> </span>Copia<span class=w> </span>solo<span class=w> </span>wheels<span class=w> </span>del<span class=w> </span>builder.
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=k>RUN</span><span class=w> </span>pip<span class=w> </span>install<span class=w> </span>--no-cache<span class=w> </span>/wheels/*<span class=w>            </span>#<span class=w> </span>Instala<span class=w> </span>sin<span class=w> </span>compilar.
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=k>COPY</span><span class=w> </span>.<span class=w> </span>/app
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=k>USER</span><span class=w> </span><span class=s>nonroot                                    # Seguridad: no root.</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;uvicorn&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;app:app&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;--host&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;0.0.0.0&quot;</span><span class=p>]</span><span class=w> </span>#<span class=w> </span>Comando<span class=w> </span>de<span class=w> </span>inicio.
</code></pre></div> <p><strong>Multi-stage</strong>: Build pesado en stage 1, runtime ligero en stage 2.</p> <hr> <h2 id=pregunta-21-training-serving-skew>Pregunta 21: Training-Serving Skew<a class=headerlink href=#pregunta-21-training-serving-skew title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© es training-serving skew y c√≥mo lo evitas?</strong></p> <h3 id=respuesta_20>Respuesta:<a class=headerlink href=#respuesta_20 title="Permanent link">&para;</a></h3> <p>Training-serving skew ocurre cuando el modelo ve datos diferentes en producci√≥n vs entrenamiento.</p> <p><strong>Causas comunes</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># ‚ùå MAL: Preprocesamiento diferente</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=c1># Training</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=n>X_train</span><span class=p>[</span><span class=s1>&#39;age_normalized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>X_train</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>X_train</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span> <span class=o>/</span> <span class=n>X_train</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>  <span class=c1># Stats de train.</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=c1># Serving (usa stats de producci√≥n, no de training!)</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=n>X_prod</span><span class=p>[</span><span class=s1>&#39;age_normalized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>X_prod</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>X_prod</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span> <span class=o>/</span> <span class=n>X_prod</span><span class=p>[</span><span class=s1>&#39;age&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>  <span class=c1># Stats de prod ‚Üí SKEW.</span>
</code></pre></div></p> <p><strong>Soluci√≥n: Pipeline unificado</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=c1># ‚úÖ BIEN: Todo en un pipeline</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=n>pipe</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>    <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>                <span class=c1># Guarda mean/std de training internamente.</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>    <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>())</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=p>])</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=n>pipe</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>                       <span class=c1># fit: aprende stats de train.</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>pipe</span><span class=p>,</span> <span class=s1>&#39;model.joblib&#39;</span><span class=p>)</span>                <span class=c1># Serializa TODO junto.</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=c1># En producci√≥n: mismo pipeline</span>
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a><span class=n>pipe</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;model.joblib&#39;</span><span class=p>)</span>               <span class=c1># Carga con stats de train.</span>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=n>pred</span> <span class=o>=</span> <span class=n>pipe</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_new</span><span class=p>)</span>                       <span class=c1># transform usa stats originales.</span>
</code></pre></div></p> <hr> <h2 id=pregunta-22-data-drift-detection>Pregunta 22: Data Drift Detection<a class=headerlink href=#pregunta-22-data-drift-detection title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo detectas data drift en producci√≥n?</strong></p> <h3 id=respuesta_21>Respuesta:<a class=headerlink href=#respuesta_21 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=kn>from</span><span class=w> </span><span class=nn>evidently.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>DataDriftTable</span>     <span class=c1># Evidently: librer√≠a de monitoreo ML.</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=kn>from</span><span class=w> </span><span class=nn>evidently.report</span><span class=w> </span><span class=kn>import</span> <span class=n>Report</span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=c1># Comparar distribuciones</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=n>report</span> <span class=o>=</span> <span class=n>Report</span><span class=p>(</span><span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=n>DataDriftTable</span><span class=p>()])</span>      <span class=c1># M√©trica de drift.</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=n>report</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>reference_data</span><span class=o>=</span><span class=n>X_train</span><span class=p>,</span> <span class=n>current_data</span><span class=o>=</span><span class=n>X_prod</span><span class=p>)</span>  <span class=c1># Compara train vs producci√≥n.</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=n>report</span><span class=o>.</span><span class=n>save_html</span><span class=p>(</span><span class=s2>&quot;drift_report.html&quot;</span><span class=p>)</span>            <span class=c1># Genera reporte visual.</span>
</code></pre></div> <p><strong>M√©todos estad√≠sticos</strong>: | M√©todo | Uso | Umbral t√≠pico | |--------|-----|---------------| | <strong>PSI</strong> (Population Stability Index) | Categ√≥ricas | &gt;0.2 = drift significativo | | <strong>KS-test</strong> (Kolmogorov-Smirnov) | Num√©ricas | p-value &lt; 0.05 | | <strong>JS Divergence</strong> | Distribuciones | &gt;0.1 = drift |</p> <p><strong>En el portafolio</strong>: Configurable en <code>16_OBSERVABILIDAD.md</code>.</p> <hr> <h2 id=pregunta-23-metricas-de-produccion>Pregunta 23: M√©tricas de Producci√≥n<a class=headerlink href=#pregunta-23-metricas-de-produccion title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© m√©tricas monitoreas en producci√≥n?</strong></p> <h3 id=respuesta_22>Respuesta:<a class=headerlink href=#respuesta_22 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=c1># Prometheus metrics en FastAPI</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=kn>from</span><span class=w> </span><span class=nn>prometheus_client</span><span class=w> </span><span class=kn>import</span> <span class=n>Counter</span><span class=p>,</span> <span class=n>Histogram</span>  <span class=c1># Cliente Prometheus para Python.</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=n>PREDICTIONS</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=s1>&#39;predictions_total&#39;</span><span class=p>,</span> <span class=s1>&#39;Total predictions&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;model_version&#39;</span><span class=p>])</span>  <span class=c1># Contador.</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=n>LATENCY</span> <span class=o>=</span> <span class=n>Histogram</span><span class=p>(</span><span class=s1>&#39;prediction_latency_seconds&#39;</span><span class=p>,</span> <span class=s1>&#39;Prediction latency&#39;</span><span class=p>)</span>  <span class=c1># Histograma.</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>)</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>Input</span><span class=p>):</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>    <span class=k>with</span> <span class=n>LATENCY</span><span class=o>.</span><span class=n>time</span><span class=p>():</span>                         <span class=c1># Mide tiempo autom√°ticamente.</span>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>    <span class=n>PREDICTIONS</span><span class=o>.</span><span class=n>labels</span><span class=p>(</span><span class=n>model_version</span><span class=o>=</span><span class=s2>&quot;v1.2&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>  <span class=c1># Incrementa contador con label.</span>
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>    <span class=k>return</span> <span class=n>result</span>
</code></pre></div> <p><strong>M√©tricas clave</strong>: | Categor√≠a | M√©tricas | |-----------|----------| | <strong>Rendimiento</strong> | Latencia p50/p95/p99, throughput | | <strong>Disponibilidad</strong> | Error rate, uptime | | <strong>ML espec√≠ficas</strong> | Prediction distribution, feature distributions | | <strong>Negocio</strong> | Conversiones, costos evitados |</p> <hr> <h2 id=pregunta-24-rollback-de-modelos>Pregunta 24: Rollback de Modelos<a class=headerlink href=#pregunta-24-rollback-de-modelos title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo haces rollback si un modelo falla?</strong></p> <h3 id=respuesta_23>Respuesta:<a class=headerlink href=#respuesta_23 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=c1># 1. Versionado de modelos</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=n>models</span><span class=o>/</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=err>‚îú‚îÄ‚îÄ</span> <span class=n>v1</span><span class=mf>.0.0</span><span class=o>/</span><span class=n>pipeline</span><span class=o>.</span><span class=n>joblib</span>  <span class=c1># ‚Üê Rollback aqu√≠</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=err>‚îú‚îÄ‚îÄ</span> <span class=n>v1</span><span class=mf>.1.0</span><span class=o>/</span><span class=n>pipeline</span><span class=o>.</span><span class=n>joblib</span>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=err>‚îî‚îÄ‚îÄ</span> <span class=n>v1</span><span class=mf>.2.0</span><span class=o>/</span><span class=n>pipeline</span><span class=o>.</span><span class=n>joblib</span>  <span class=c1># Actual (fallando)</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=c1># 2. Blue-Green deployment</span>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=c1># deployment.yaml</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=n>spec</span><span class=p>:</span>
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>  <span class=n>replicas</span><span class=p>:</span> <span class=mi>2</span>
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a>  <span class=n>selector</span><span class=p>:</span>
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a>    <span class=n>matchLabels</span><span class=p>:</span>
<a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a>      <span class=n>version</span><span class=p>:</span> <span class=n>v1</span><span class=mf>.1.0</span>  <span class=c1># Cambiar a versi√≥n anterior</span>
<a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a>
<a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a><span class=c1># 3. Con MLflow</span>
<a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=n>client</span> <span class=o>=</span> <span class=n>MlflowClient</span><span class=p>()</span>
<a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=n>client</span><span class=o>.</span><span class=n>transition_model_version_stage</span><span class=p>(</span>
<a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a>    <span class=n>name</span><span class=o>=</span><span class=s2>&quot;bankchurn&quot;</span><span class=p>,</span>
<a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a>    <span class=n>version</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
<a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a>    <span class=n>stage</span><span class=o>=</span><span class=s2>&quot;Production&quot;</span>  <span class=c1># Promover versi√≥n anterior</span>
<a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a><span class=p>)</span>
</code></pre></div> <p><strong>Proceso de rollback</strong>: 1. Detectar degradaci√≥n (alertas de m√©tricas) 2. Cambiar variable de entorno o config 3. Reiniciar pods / recargar modelo 4. Verificar m√©tricas post-rollback</p> <hr> <h2 id=pregunta-25-ab-testing-en-ml>Pregunta 25: A/B Testing en ML<a class=headerlink href=#pregunta-25-ab-testing-en-ml title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo implementas A/B testing para modelos?</strong></p> <h3 id=respuesta_24>Respuesta:<a class=headerlink href=#respuesta_24 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>)</span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>Input</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a>    <span class=c1># Asignar bucket consistente por usuario</span>
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a>    <span class=n>bucket</span> <span class=o>=</span> <span class=nb>hash</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span> <span class=o>%</span> <span class=mi>100</span>                 <span class=c1># Hash determinista: mismo user = mismo bucket.</span>
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a>
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a>    <span class=k>if</span> <span class=n>bucket</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>:</span>                              <span class=c1># 10% tr√°fico al challenger.</span>
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>model_v2</span>                         <span class=c1># Challenger: modelo nuevo.</span>
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a>        <span class=n>version</span> <span class=o>=</span> <span class=s2>&quot;v2&quot;</span>
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>model_v1</span>                         <span class=c1># Champion: modelo actual.</span>
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a>        <span class=n>version</span> <span class=o>=</span> <span class=s2>&quot;v1&quot;</span>
<a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a>
<a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=__codelineno-26-16 name=__codelineno-26-16 href=#__codelineno-26-16></a>
<a id=__codelineno-26-17 name=__codelineno-26-17 href=#__codelineno-26-17></a>    <span class=c1># Logging para an√°lisis</span>
<a id=__codelineno-26-18 name=__codelineno-26-18 href=#__codelineno-26-18></a>    <span class=n>log_prediction</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>version</span><span class=p>,</span> <span class=n>result</span><span class=p>)</span>     <span class=c1># Guarda para comparar m√©tricas.</span>
<a id=__codelineno-26-19 name=__codelineno-26-19 href=#__codelineno-26-19></a>
<a id=__codelineno-26-20 name=__codelineno-26-20 href=#__codelineno-26-20></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>&quot;prediction&quot;</span><span class=p>:</span> <span class=n>result</span><span class=p>,</span> <span class=s2>&quot;model_version&quot;</span><span class=p>:</span> <span class=n>version</span><span class=p>}</span>
</code></pre></div> <p><strong>M√©tricas a comparar</strong>: - Accuracy/F1 en cohortes - M√©tricas de negocio (conversi√≥n, revenue) - Latencia y error rate</p> <hr> <h2 id=pregunta-26-manejo-de-secrets>Pregunta 26: Manejo de Secrets<a class=headerlink href=#pregunta-26-manejo-de-secrets title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo manejas secrets y credenciales?</strong></p> <h3 id=respuesta_25>Respuesta:<a class=headerlink href=#respuesta_25 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=c1># ‚ùå MAL: Hardcoded</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=n>API_KEY</span> <span class=o>=</span> <span class=s2>&quot;TU_API_KEY_AQUI&quot;</span>                      <span class=c1># NUNCA hacer esto: queda en Git.</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=c1># ‚úÖ BIEN: Variables de entorno</span>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a><span class=n>API_KEY</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;API_KEY&quot;</span><span class=p>)</span>                   <span class=c1># Lee de variable de entorno.</span>
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>
<a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a><span class=c1># ‚úÖ MEJOR: python-dotenv</span>
<a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a><span class=kn>from</span><span class=w> </span><span class=nn>dotenv</span><span class=w> </span><span class=kn>import</span> <span class=n>load_dotenv</span>
<a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a><span class=n>load_dotenv</span><span class=p>()</span>                                    <span class=c1># Carga variables de .env al entorno.</span>
<a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a><span class=n>API_KEY</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;API_KEY&quot;</span><span class=p>)</span>                   <span class=c1># Ahora disponible.</span>
</code></pre></div> <p><strong>.env (nunca en Git)</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=c1># .env (valores de ejemplo)</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=nv>API_KEY</span><span class=o>=</span>REEMPLAZAR_EN_ENTORNO_REAL
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=nv>DB_PASSWORD</span><span class=o>=</span>REEMPLAZAR_EN_ENTORNO_REAL
</code></pre></div></p> <p><strong>.gitignore</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a>.env
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>.env.*
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a>!.env.example
</code></pre></div></p> <p><strong>En CI/CD</strong>: GitHub Secrets ‚Üí <code>${{ secrets.API_KEY }}</code></p> <hr> <h2 id=pregunta-27-feature-store>Pregunta 27: Feature Store<a class=headerlink href=#pregunta-27-feature-store title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© es un feature store y cu√°ndo usarlo?</strong></p> <h3 id=respuesta_26>Respuesta:<a class=headerlink href=#respuesta_26 title="Permanent link">&para;</a></h3> <p>Feature store = repositorio centralizado de features reutilizables.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=c1># Sin feature store (problema)</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=c1># Equipo A: calcula age_bucket de una forma</span>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=c1># Equipo B: calcula age_bucket de otra forma</span>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=c1># ‚Üí Inconsistencia                              # Cada equipo tiene su versi√≥n.</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=c1># Con feature store (soluci√≥n)</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=kn>from</span><span class=w> </span><span class=nn>feast</span><span class=w> </span><span class=kn>import</span> <span class=n>FeatureStore</span>                   <span class=c1># Feast: feature store open source.</span>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a><span class=n>store</span> <span class=o>=</span> <span class=n>FeatureStore</span><span class=p>(</span><span class=n>repo_path</span><span class=o>=</span><span class=s2>&quot;.&quot;</span><span class=p>)</span>              <span class=c1># Conecta al store.</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=n>features</span> <span class=o>=</span> <span class=n>store</span><span class=o>.</span><span class=n>get_online_features</span><span class=p>(</span>            <span class=c1># Obtiene features en tiempo real.</span>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>    <span class=n>features</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;customer:age_bucket&quot;</span><span class=p>,</span> <span class=s2>&quot;customer:tenure_months&quot;</span><span class=p>],</span>  <span class=c1># Formato: tabla:feature.</span>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a>    <span class=n>entity_rows</span><span class=o>=</span><span class=p>[{</span><span class=s2>&quot;customer_id&quot;</span><span class=p>:</span> <span class=s2>&quot;C123&quot;</span><span class=p>}]</span>        <span class=c1># Entidad a buscar.</span>
<a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a><span class=p>)</span>
</code></pre></div> <p><strong>Cu√°ndo usar</strong>: | Situaci√≥n | Feature Store | |-----------|---------------| | 1-2 modelos, equipo peque√±o | No necesario | | M√∫ltiples modelos, features compartidas | Recomendado | | Features en tiempo real | Muy recomendado |</p> <hr> <h2 id=pregunta-28-escalado-de-inferencia>Pregunta 28: Escalado de Inferencia<a class=headerlink href=#pregunta-28-escalado-de-inferencia title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo escalas inferencia para alto tr√°fico?</strong></p> <h3 id=respuesta_27>Respuesta:<a class=headerlink href=#respuesta_27 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=c1># Kubernetes HPA (Horizontal Pod Autoscaler)</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling/v2</span>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">HorizontalPodAutoscaler</span><span class=w>               </span><span class=c1># Escala pods autom√°ticamente.</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api</span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=w>  </span><span class=nt>scaleTargetRef</span><span class=p>:</span><span class=w>                           </span><span class=c1># Deployment a escalar.</span>
<a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api</span>
<a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=w>  </span><span class=nt>minReplicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class=w>                            </span><span class=c1># M√≠nimo 2 pods siempre.</span>
<a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a><span class=w>  </span><span class=nt>maxReplicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class=w>                           </span><span class=c1># M√°ximo 10 pods.</span>
<a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a><span class=w>  </span><span class=nt>metrics</span><span class=p>:</span>
<a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Resource</span>
<a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a><span class=w>    </span><span class=nt>resource</span><span class=p>:</span>
<a id=__codelineno-31-16 name=__codelineno-31-16 href=#__codelineno-31-16></a><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cpu</span>
<a id=__codelineno-31-17 name=__codelineno-31-17 href=#__codelineno-31-17></a><span class=w>      </span><span class=nt>target</span><span class=p>:</span>
<a id=__codelineno-31-18 name=__codelineno-31-18 href=#__codelineno-31-18></a><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Utilization</span>
<a id=__codelineno-31-19 name=__codelineno-31-19 href=#__codelineno-31-19></a><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">70</span><span class=w>              </span><span class=c1># Escala cuando CPU &gt; 70%.</span>
</code></pre></div> <p><strong>Estrategias</strong>: | Estrategia | Cu√°ndo | |------------|--------| | <strong>HPA</strong> | Tr√°fico variable, latencia cr√≠tica | | <strong>Batch processing</strong> | Alto volumen, latencia flexible | | <strong>Caching</strong> | Inputs repetidos frecuentes | | <strong>Model optimization</strong> | Latencia muy baja requerida |</p> <hr> <h2 id=pregunta-29-logging-en-ml>Pregunta 29: Logging en ML<a class=headerlink href=#pregunta-29-logging-en-ml title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© informaci√≥n loggeas en producci√≥n?</strong></p> <h3 id=respuesta_28>Respuesta:<a class=headerlink href=#respuesta_28 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=kn>import</span><span class=w> </span><span class=nn>json</span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>             <span class=c1># Logger por m√≥dulo.</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>)</span>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>Input</span><span class=p>):</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a>    <span class=n>request_id</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>               <span class=c1># ID √∫nico para trazar request.</span>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>
<a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a>    <span class=c1># Log de entrada</span>
<a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span>                     <span class=c1># JSON estructurado para an√°lisis.</span>
<a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a>        <span class=s2>&quot;event&quot;</span><span class=p>:</span> <span class=s2>&quot;prediction_request&quot;</span><span class=p>,</span>
<a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a>        <span class=s2>&quot;request_id&quot;</span><span class=p>:</span> <span class=n>request_id</span><span class=p>,</span>
<a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a>        <span class=s2>&quot;features&quot;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>dict</span><span class=p>(),</span>                 <span class=c1># Features de entrada.</span>
<a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a>        <span class=s2>&quot;timestamp&quot;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
<a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a>    <span class=p>}))</span>
<a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a>
<a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>                          <span class=c1># Medir latencia.</span>
<a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a>    <span class=n>latency</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start</span>
<a id=__codelineno-32-21 name=__codelineno-32-21 href=#__codelineno-32-21></a>
<a id=__codelineno-32-22 name=__codelineno-32-22 href=#__codelineno-32-22></a>    <span class=c1># Log de salida</span>
<a id=__codelineno-32-23 name=__codelineno-32-23 href=#__codelineno-32-23></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span>
<a id=__codelineno-32-24 name=__codelineno-32-24 href=#__codelineno-32-24></a>        <span class=s2>&quot;event&quot;</span><span class=p>:</span> <span class=s2>&quot;prediction_response&quot;</span><span class=p>,</span>
<a id=__codelineno-32-25 name=__codelineno-32-25 href=#__codelineno-32-25></a>        <span class=s2>&quot;request_id&quot;</span><span class=p>:</span> <span class=n>request_id</span><span class=p>,</span>                <span class=c1># Mismo ID para correlacionar.</span>
<a id=__codelineno-32-26 name=__codelineno-32-26 href=#__codelineno-32-26></a>        <span class=s2>&quot;prediction&quot;</span><span class=p>:</span> <span class=n>result</span><span class=p>,</span>
<a id=__codelineno-32-27 name=__codelineno-32-27 href=#__codelineno-32-27></a>        <span class=s2>&quot;probability&quot;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>proba</span><span class=p>),</span>
<a id=__codelineno-32-28 name=__codelineno-32-28 href=#__codelineno-32-28></a>        <span class=s2>&quot;latency_ms&quot;</span><span class=p>:</span> <span class=n>latency</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span>            <span class=c1># Latencia en ms.</span>
<a id=__codelineno-32-29 name=__codelineno-32-29 href=#__codelineno-32-29></a>        <span class=s2>&quot;model_version&quot;</span><span class=p>:</span> <span class=s2>&quot;v1.2.0&quot;</span>                <span class=c1># Versi√≥n para debugging.</span>
<a id=__codelineno-32-30 name=__codelineno-32-30 href=#__codelineno-32-30></a>    <span class=p>}))</span>
<a id=__codelineno-32-31 name=__codelineno-32-31 href=#__codelineno-32-31></a>
<a id=__codelineno-32-32 name=__codelineno-32-32 href=#__codelineno-32-32></a>    <span class=k>return</span> <span class=n>result</span>
</code></pre></div> <p><strong>Logs esenciales</strong>: request_id, inputs, outputs, latencia, versi√≥n, errores.</p> <hr> <h2 id=pregunta-30-retraining-automatico>Pregunta 30: Retraining Autom√°tico<a class=headerlink href=#pregunta-30-retraining-automatico title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo automatizas el retraining?</strong></p> <h3 id=respuesta_29>Respuesta:<a class=headerlink href=#respuesta_29 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=c1># GitHub Actions scheduled workflow</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Weekly Retrain</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=nt>on</span><span class=p>:</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=w>  </span><span class=nt>schedule</span><span class=p>:</span>
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>cron</span><span class=p>:</span><span class=w> </span><span class=s>&#39;0</span><span class=nv> </span><span class=s>2</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>*</span><span class=nv> </span><span class=s>0&#39;</span><span class=w>                         </span><span class=c1># Domingos 2am UTC.</span>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a><span class=w>  </span><span class=nt>workflow_dispatch</span><span class=p>:</span><span class=w>                            </span><span class=c1># Permite trigger manual.</span>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a><span class=nt>jobs</span><span class=p>:</span>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a><span class=w>  </span><span class=nt>retrain</span><span class=p>:</span>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a><span class=w>    </span><span class=nt>steps</span><span class=p>:</span>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pip install -e &quot;.[dev]&quot;</span>
<a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">python main.py --config configs/config.yaml</span><span class=w>  </span><span class=c1># Entrena modelo.</span>
<a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">python scripts/evaluate.py --threshold 0.80</span><span class=w>  </span><span class=c1># Valida m√©tricas.</span>
<a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">|</span><span class=w>                                  </span><span class=c1># Deploy condicional.</span>
<a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a><span class=w>          </span><span class=no>if [ $? -eq 0 ]; then                 # Si evaluaci√≥n pas√≥.</span>
<a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a><span class=w>            </span><span class=no>echo &quot;Model passed threshold, deploying...&quot;</span>
<a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a><span class=w>            </span><span class=no># Deploy logic</span>
<a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a><span class=w>          </span><span class=no>fi</span>
</code></pre></div> <p><strong>Triggers de retraining</strong>: | Trigger | Implementaci√≥n | |---------|----------------| | <strong>Scheduled</strong> | Cron jobs, Airflow | | <strong>Data drift</strong> | Alerta ‚Üí trigger workflow | | <strong>Performance degradation</strong> | M√©tricas bajo umbral | | <strong>New data volume</strong> | X nuevos registros |</p> <hr> <h1 id=3-testing-y-calidad-preguntas-31-40>3. Testing y Calidad (Preguntas 31-40)<a class=headerlink href=#3-testing-y-calidad-preguntas-31-40 title="Permanent link">&para;</a></h1> <h2 id=pregunta-31-tipos-de-tests>Pregunta 31: Tipos de Tests<a class=headerlink href=#pregunta-31-tipos-de-tests title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© tipos de tests tiene el portafolio?</strong></p> <h3 id=respuesta_30>Respuesta:<a class=headerlink href=#respuesta_30 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=c1># Unit test - prueba una funci√≥n aislada</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=k>def</span><span class=w> </span><span class=nf>test_feature_engineer</span><span class=p>():</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>    <span class=n>fe</span> <span class=o>=</span> <span class=n>FeatureEngineer</span><span class=p>()</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>fe</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>sample_df</span><span class=p>)</span>             <span class=c1># Prueba transform.</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>    <span class=k>assert</span> <span class=s1>&#39;vehicle_age&#39;</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>columns</span>       <span class=c1># Verifica output esperado.</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=c1># Integration test - prueba m√∫ltiples componentes juntos</span>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=k>def</span><span class=w> </span><span class=nf>test_training_pipeline</span><span class=p>():</span>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>    <span class=n>trainer</span> <span class=o>=</span> <span class=n>Trainer</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>    <span class=n>trainer</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>                            <span class=c1># Prueba flujo completo.</span>
<a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>    <span class=k>assert</span> <span class=n>trainer</span><span class=o>.</span><span class=n>model_</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>            <span class=c1># Verifica que modelo existe.</span>
<a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a>
<a id=__codelineno-34-13 name=__codelineno-34-13 href=#__codelineno-34-13></a><span class=c1># API test - prueba endpoint HTTP</span>
<a id=__codelineno-34-14 name=__codelineno-34-14 href=#__codelineno-34-14></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict_endpoint</span><span class=p>():</span>
<a id=__codelineno-34-15 name=__codelineno-34-15 href=#__codelineno-34-15></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>sample_input</span><span class=p>)</span>  <span class=c1># Request HTTP.</span>
<a id=__codelineno-34-16 name=__codelineno-34-16 href=#__codelineno-34-16></a>    <span class=k>assert</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span>           <span class=c1># Verifica respuesta exitosa.</span>
</code></pre></div> <hr> <h2 id=pregunta-32-fixtures>Pregunta 32: Fixtures<a class=headerlink href=#pregunta-32-fixtures title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo usas fixtures en pytest?</strong></p> <h3 id=respuesta_31>Respuesta:<a class=headerlink href=#respuesta_31 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=nd>@pytest</span><span class=o>.</span><span class=n>fixture</span>                                  <span class=c1># Fixture: setup reutilizable.</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=k>def</span><span class=w> </span><span class=nf>sample_data</span><span class=p>():</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a>    <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>                        <span class=c1># Datos de prueba.</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>        <span class=s1>&#39;CreditScore&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>650</span><span class=p>,</span> <span class=mi>700</span><span class=p>],</span>
<a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>        <span class=s1>&#39;Age&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>35</span><span class=p>,</span> <span class=mi>45</span><span class=p>],</span>
<a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>        <span class=s1>&#39;Exited&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a>    <span class=p>})</span>
<a id=__codelineno-35-8 name=__codelineno-35-8 href=#__codelineno-35-8></a>
<a id=__codelineno-35-9 name=__codelineno-35-9 href=#__codelineno-35-9></a><span class=nd>@pytest</span><span class=o>.</span><span class=n>fixture</span>
<a id=__codelineno-35-10 name=__codelineno-35-10 href=#__codelineno-35-10></a><span class=k>def</span><span class=w> </span><span class=nf>trained_model</span><span class=p>(</span><span class=n>sample_data</span><span class=p>):</span>                  <span class=c1># Fixture puede usar otra fixture.</span>
<a id=__codelineno-35-11 name=__codelineno-35-11 href=#__codelineno-35-11></a>    <span class=n>trainer</span> <span class=o>=</span> <span class=n>Trainer</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
<a id=__codelineno-35-12 name=__codelineno-35-12 href=#__codelineno-35-12></a>    <span class=n>trainer</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>sample_data</span><span class=p>)</span>                     <span class=c1># Entrena con datos de prueba.</span>
<a id=__codelineno-35-13 name=__codelineno-35-13 href=#__codelineno-35-13></a>    <span class=k>return</span> <span class=n>trainer</span>
<a id=__codelineno-35-14 name=__codelineno-35-14 href=#__codelineno-35-14></a>
<a id=__codelineno-35-15 name=__codelineno-35-15 href=#__codelineno-35-15></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict</span><span class=p>(</span><span class=n>trained_model</span><span class=p>,</span> <span class=n>sample_data</span><span class=p>):</span>    <span class=c1># Test recibe fixtures como args.</span>
<a id=__codelineno-35-16 name=__codelineno-35-16 href=#__codelineno-35-16></a>    <span class=n>preds</span> <span class=o>=</span> <span class=n>trained_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>sample_data</span><span class=p>)</span>
<a id=__codelineno-35-17 name=__codelineno-35-17 href=#__codelineno-35-17></a>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>preds</span><span class=p>)</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>sample_data</span><span class=p>)</span>        <span class=c1># Verifica cantidad de predicciones.</span>
</code></pre></div> <hr> <h2 id=pregunta-33-coverage>Pregunta 33: Coverage<a class=headerlink href=#pregunta-33-coverage title="Permanent link">&para;</a></h2> <p><strong>¬øCu√°nto coverage es suficiente?</strong></p> <h3 id=respuesta_32>Respuesta:<a class=headerlink href=#respuesta_32 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a>pytest<span class=w> </span>tests/<span class=w> </span>--cov<span class=o>=</span>src<span class=w> </span>--cov-report<span class=o>=</span>html<span class=w>       </span><span class=c1># --cov: mide coverage de src/. --cov-report: genera HTML.</span>
</code></pre></div> <table> <thead> <tr> <th>Nivel</th> <th>Coverage</th> <th>Comentario</th> </tr> </thead> <tbody> <tr> <td>M√≠nimo</td> <td>70%</td> <td>Lo b√°sico</td> </tr> <tr> <td>Bueno</td> <td>80%</td> <td>Est√°ndar industria</td> </tr> <tr> <td>Excelente</td> <td>90%+</td> <td>C√≥digo cr√≠tico</td> </tr> </tbody> </table> <p><strong>El portafolio tiene 79% en BankChurn.</strong></p> <hr> <h2 id=pregunta-34-property-based-testing>Pregunta 34: Property-Based Testing<a class=headerlink href=#pregunta-34-property-based-testing title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© es property-based testing?</strong></p> <h3 id=respuesta_33>Respuesta:<a class=headerlink href=#respuesta_33 title="Permanent link">&para;</a></h3> <p>En lugar de casos espec√≠ficos, defines <strong>propiedades</strong> que siempre deben cumplirse.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=kn>from</span><span class=w> </span><span class=nn>hypothesis</span><span class=w> </span><span class=kn>import</span> <span class=n>given</span><span class=p>,</span> <span class=n>strategies</span> <span class=k>as</span> <span class=n>st</span>   <span class=c1># Hypothesis: property-based testing.</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=nd>@given</span><span class=p>(</span>                                          <span class=c1># @given genera casos de prueba autom√°ticos.</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>    <span class=n>credit_score</span><span class=o>=</span><span class=n>st</span><span class=o>.</span><span class=n>integers</span><span class=p>(</span><span class=n>min_value</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span> <span class=n>max_value</span><span class=o>=</span><span class=mi>850</span><span class=p>),</span>  <span class=c1># Estrategia: enteros en rango.</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>    <span class=n>age</span><span class=o>=</span><span class=n>st</span><span class=o>.</span><span class=n>integers</span><span class=p>(</span><span class=n>min_value</span><span class=o>=</span><span class=mi>18</span><span class=p>,</span> <span class=n>max_value</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=p>)</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=k>def</span><span class=w> </span><span class=nf>test_prediction_is_valid</span><span class=p>(</span><span class=n>credit_score</span><span class=p>,</span> <span class=n>age</span><span class=p>):</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Propiedad: la predicci√≥n siempre es 0 o 1.&quot;&quot;&quot;</span>  <span class=c1># Define invariante.</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>    <span class=n>input_data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;credit_score&quot;</span><span class=p>:</span> <span class=n>credit_score</span><span class=p>,</span> <span class=s2>&quot;age&quot;</span><span class=p>:</span> <span class=n>age</span><span class=p>}</span>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>    <span class=n>pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span><span class=n>input_data</span><span class=p>]))</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>    <span class=k>assert</span> <span class=n>pred</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>                     <span class=c1># Debe cumplirse para TODOS los inputs.</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a><span class=nd>@given</span><span class=p>(</span><span class=n>df</span><span class=o>=</span><span class=n>st</span><span class=o>.</span><span class=n>data</span><span class=p>())</span>                             <span class=c1># st.data(): permite draw din√°mico.</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a><span class=k>def</span><span class=w> </span><span class=nf>test_feature_engineer_preserves_rows</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Propiedad: FeatureEngineer no cambia n√∫mero de filas.&quot;&quot;&quot;</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a>    <span class=n>sample</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>st</span><span class=o>.</span><span class=n>dataframes</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>[</span>     <span class=c1># Genera DataFrame aleatorio.</span>
<a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a>        <span class=n>st</span><span class=o>.</span><span class=n>column</span><span class=p>(</span><span class=s2>&quot;age&quot;</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>),</span>
<a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a>        <span class=n>st</span><span class=o>.</span><span class=n>column</span><span class=p>(</span><span class=s2>&quot;salary&quot;</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>float</span><span class=p>)</span>
<a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a>    <span class=p>]))</span>
<a id=__codelineno-37-20 name=__codelineno-37-20 href=#__codelineno-37-20></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>fe</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>sample</span><span class=p>)</span>
<a id=__codelineno-37-21 name=__codelineno-37-21 href=#__codelineno-37-21></a>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=p>)</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>sample</span><span class=p>)</span>            <span class=c1># Filas deben preservarse.</span>
</code></pre></div> <p><strong>Ventaja</strong>: Encuentra edge cases que no pensaste.</p> <hr> <h2 id=pregunta-35-testing-de-modelos-ml>Pregunta 35: Testing de Modelos ML<a class=headerlink href=#pregunta-35-testing-de-modelos-ml title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo testeas que un modelo funciona correctamente?</strong></p> <h3 id=respuesta_34>Respuesta:<a class=headerlink href=#respuesta_34 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=c1># 1. Test de smoke: modelo carga y predice</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=k>def</span><span class=w> </span><span class=nf>test_model_loads_and_predicts</span><span class=p>():</span>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;artifacts/pipeline.joblib&quot;</span><span class=p>)</span>  <span class=c1># Carga modelo.</span>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>    <span class=n>sample</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([{</span><span class=s2>&quot;CreditScore&quot;</span><span class=p>:</span> <span class=mi>650</span><span class=p>,</span> <span class=s2>&quot;Age&quot;</span><span class=p>:</span> <span class=mi>35</span><span class=p>}])</span>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a>    <span class=n>pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>sample</span><span class=p>)</span>                 <span class=c1># Debe poder predecir.</span>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>pred</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span>                        <span class=c1># Una predicci√≥n por fila.</span>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a>
<a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a><span class=c1># 2. Test de formato de salida</span>
<a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a><span class=k>def</span><span class=w> </span><span class=nf>test_prediction_format</span><span class=p>():</span>
<a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a>    <span class=n>pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a>    <span class=k>assert</span> <span class=n>pred</span><span class=o>.</span><span class=n>shape</span> <span class=o>==</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>X_test</span><span class=p>),)</span>          <span class=c1># Shape correcto.</span>
<a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a>    <span class=k>assert</span> <span class=nb>set</span><span class=p>(</span><span class=n>pred</span><span class=p>)</span><span class=o>.</span><span class=n>issubset</span><span class=p>({</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>})</span>            <span class=c1># Solo valores v√°lidos.</span>
<a id=__codelineno-38-13 name=__codelineno-38-13 href=#__codelineno-38-13></a>
<a id=__codelineno-38-14 name=__codelineno-38-14 href=#__codelineno-38-14></a><span class=c1># 3. Test de rendimiento m√≠nimo</span>
<a id=__codelineno-38-15 name=__codelineno-38-15 href=#__codelineno-38-15></a><span class=k>def</span><span class=w> </span><span class=nf>test_model_performance</span><span class=p>():</span>
<a id=__codelineno-38-16 name=__codelineno-38-16 href=#__codelineno-38-16></a>    <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<a id=__codelineno-38-17 name=__codelineno-38-17 href=#__codelineno-38-17></a>    <span class=n>accuracy</span> <span class=o>=</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
<a id=__codelineno-38-18 name=__codelineno-38-18 href=#__codelineno-38-18></a>    <span class=k>assert</span> <span class=n>accuracy</span> <span class=o>&gt;=</span> <span class=mf>0.75</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;Accuracy </span><span class=si>{</span><span class=n>accuracy</span><span class=si>}</span><span class=s2> below threshold&quot;</span>  <span class=c1># Umbral m√≠nimo.</span>
<a id=__codelineno-38-19 name=__codelineno-38-19 href=#__codelineno-38-19></a>
<a id=__codelineno-38-20 name=__codelineno-38-20 href=#__codelineno-38-20></a><span class=c1># 4. Test de invarianza</span>
<a id=__codelineno-38-21 name=__codelineno-38-21 href=#__codelineno-38-21></a><span class=k>def</span><span class=w> </span><span class=nf>test_prediction_deterministic</span><span class=p>():</span>
<a id=__codelineno-38-22 name=__codelineno-38-22 href=#__codelineno-38-22></a>    <span class=n>pred1</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<a id=__codelineno-38-23 name=__codelineno-38-23 href=#__codelineno-38-23></a>    <span class=n>pred2</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<a id=__codelineno-38-24 name=__codelineno-38-24 href=#__codelineno-38-24></a>    <span class=k>assert</span> <span class=n>np</span><span class=o>.</span><span class=n>array_equal</span><span class=p>(</span><span class=n>pred1</span><span class=p>,</span> <span class=n>pred2</span><span class=p>)</span>          <span class=c1># Misma entrada = misma salida.</span>
</code></pre></div> <hr> <h2 id=pregunta-36-mocking>Pregunta 36: Mocking<a class=headerlink href=#pregunta-36-mocking title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© es mocking y cu√°ndo usarlo?</strong></p> <h3 id=respuesta_35>Respuesta:<a class=headerlink href=#respuesta_35 title="Permanent link">&para;</a></h3> <p>Mocking = reemplazar dependencias reales con objetos simulados.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=kn>from</span><span class=w> </span><span class=nn>unittest.mock</span><span class=w> </span><span class=kn>import</span> <span class=n>Mock</span><span class=p>,</span> <span class=n>patch</span>           <span class=c1># Mock: simula objetos. patch: reemplaza.</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=c1># Mockear llamada a API externa</span>
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=nd>@patch</span><span class=p>(</span><span class=s1>&#39;myapp.external_api.get_customer_data&#39;</span><span class=p>)</span>  <span class=c1># Reemplaza esta funci√≥n.</span>
<a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict_with_external_data</span><span class=p>(</span><span class=n>mock_api</span><span class=p>):</span>  <span class=c1># mock_api: objeto mock.</span>
<a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a>    <span class=c1># Configurar mock</span>
<a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a>    <span class=n>mock_api</span><span class=o>.</span><span class=n>return_value</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;credit_score&quot;</span><span class=p>:</span> <span class=mi>700</span><span class=p>,</span> <span class=s2>&quot;age&quot;</span><span class=p>:</span> <span class=mi>45</span><span class=p>}</span>  <span class=c1># Respuesta simulada.</span>
<a id=__codelineno-39-8 name=__codelineno-39-8 href=#__codelineno-39-8></a>
<a id=__codelineno-39-9 name=__codelineno-39-9 href=#__codelineno-39-9></a>    <span class=c1># Test usa el mock en lugar de API real</span>
<a id=__codelineno-39-10 name=__codelineno-39-10 href=#__codelineno-39-10></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>predict_for_customer</span><span class=p>(</span><span class=s2>&quot;C123&quot;</span><span class=p>)</span>       <span class=c1># No llama API real.</span>
<a id=__codelineno-39-11 name=__codelineno-39-11 href=#__codelineno-39-11></a>
<a id=__codelineno-39-12 name=__codelineno-39-12 href=#__codelineno-39-12></a>    <span class=c1># Verificar que se llam√≥</span>
<a id=__codelineno-39-13 name=__codelineno-39-13 href=#__codelineno-39-13></a>    <span class=n>mock_api</span><span class=o>.</span><span class=n>assert_called_once_with</span><span class=p>(</span><span class=s2>&quot;C123&quot;</span><span class=p>)</span>    <span class=c1># Verifica argumentos.</span>
<a id=__codelineno-39-14 name=__codelineno-39-14 href=#__codelineno-39-14></a>    <span class=k>assert</span> <span class=n>result</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
<a id=__codelineno-39-15 name=__codelineno-39-15 href=#__codelineno-39-15></a>
<a id=__codelineno-39-16 name=__codelineno-39-16 href=#__codelineno-39-16></a><span class=c1># Mockear modelo para test de API</span>
<a id=__codelineno-39-17 name=__codelineno-39-17 href=#__codelineno-39-17></a><span class=nd>@patch</span><span class=p>(</span><span class=s1>&#39;app.fastapi_app.model&#39;</span><span class=p>)</span>                 <span class=c1># Reemplaza el modelo.</span>
<a id=__codelineno-39-18 name=__codelineno-39-18 href=#__codelineno-39-18></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict_endpoint</span><span class=p>(</span><span class=n>mock_model</span><span class=p>):</span>
<a id=__codelineno-39-19 name=__codelineno-39-19 href=#__codelineno-39-19></a>    <span class=n>mock_model</span><span class=o>.</span><span class=n>predict</span><span class=o>.</span><span class=n>return_value</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># Simula predicci√≥n.</span>
<a id=__codelineno-39-20 name=__codelineno-39-20 href=#__codelineno-39-20></a>    <span class=n>mock_model</span><span class=o>.</span><span class=n>predict_proba</span><span class=o>.</span><span class=n>return_value</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.8</span><span class=p>]])</span>
<a id=__codelineno-39-21 name=__codelineno-39-21 href=#__codelineno-39-21></a>
<a id=__codelineno-39-22 name=__codelineno-39-22 href=#__codelineno-39-22></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>sample_input</span><span class=p>)</span>
<a id=__codelineno-39-23 name=__codelineno-39-23 href=#__codelineno-39-23></a>    <span class=k>assert</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s2>&quot;prediction&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span>   <span class=c1># Usa valor del mock.</span>
</code></pre></div> <p><strong>Cu√°ndo usar</strong>: APIs externas, base de datos, servicios lentos.</p> <hr> <h2 id=pregunta-37-testing-de-apis>Pregunta 37: Testing de APIs<a class=headerlink href=#pregunta-37-testing-de-apis title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo testeas endpoints de FastAPI?</strong></p> <h3 id=respuesta_36>Respuesta:<a class=headerlink href=#respuesta_36 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=kn>from</span><span class=w> </span><span class=nn>fastapi.testclient</span><span class=w> </span><span class=kn>import</span> <span class=n>TestClient</span>       <span class=c1># Cliente para tests sin servidor.</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=kn>from</span><span class=w> </span><span class=nn>app.fastapi_app</span><span class=w> </span><span class=kn>import</span> <span class=n>app</span>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=n>client</span> <span class=o>=</span> <span class=n>TestClient</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>                        <span class=c1># Crea cliente de prueba.</span>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=k>def</span><span class=w> </span><span class=nf>test_health_endpoint</span><span class=p>():</span>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/health&quot;</span><span class=p>)</span>            <span class=c1># GET request.</span>
<a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a>    <span class=k>assert</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span>          <span class=c1># 200 OK.</span>
<a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a>    <span class=k>assert</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s2>&quot;status&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&quot;healthy&quot;</span>  <span class=c1># Verifica contenido.</span>
<a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a>
<a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict_valid_input</span><span class=p>():</span>
<a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=p>{</span>   <span class=c1># POST con JSON body.</span>
<a id=__codelineno-40-13 name=__codelineno-40-13 href=#__codelineno-40-13></a>        <span class=s2>&quot;credit_score&quot;</span><span class=p>:</span> <span class=mi>650</span><span class=p>,</span>
<a id=__codelineno-40-14 name=__codelineno-40-14 href=#__codelineno-40-14></a>        <span class=s2>&quot;age&quot;</span><span class=p>:</span> <span class=mi>35</span><span class=p>,</span>
<a id=__codelineno-40-15 name=__codelineno-40-15 href=#__codelineno-40-15></a>        <span class=s2>&quot;geography&quot;</span><span class=p>:</span> <span class=s2>&quot;France&quot;</span>
<a id=__codelineno-40-16 name=__codelineno-40-16 href=#__codelineno-40-16></a>    <span class=p>})</span>
<a id=__codelineno-40-17 name=__codelineno-40-17 href=#__codelineno-40-17></a>    <span class=k>assert</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span>
<a id=__codelineno-40-18 name=__codelineno-40-18 href=#__codelineno-40-18></a>    <span class=k>assert</span> <span class=s2>&quot;prediction&quot;</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>      <span class=c1># Verifica campos de respuesta.</span>
<a id=__codelineno-40-19 name=__codelineno-40-19 href=#__codelineno-40-19></a>    <span class=k>assert</span> <span class=s2>&quot;probability&quot;</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
<a id=__codelineno-40-20 name=__codelineno-40-20 href=#__codelineno-40-20></a>
<a id=__codelineno-40-21 name=__codelineno-40-21 href=#__codelineno-40-21></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict_invalid_input</span><span class=p>():</span>
<a id=__codelineno-40-22 name=__codelineno-40-22 href=#__codelineno-40-22></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-40-23 name=__codelineno-40-23 href=#__codelineno-40-23></a>        <span class=s2>&quot;credit_score&quot;</span><span class=p>:</span> <span class=mi>9999</span><span class=p>,</span>                   <span class=c1># Fuera de rango: Pydantic rechaza.</span>
<a id=__codelineno-40-24 name=__codelineno-40-24 href=#__codelineno-40-24></a>        <span class=s2>&quot;age&quot;</span><span class=p>:</span> <span class=mi>35</span>
<a id=__codelineno-40-25 name=__codelineno-40-25 href=#__codelineno-40-25></a>    <span class=p>})</span>
<a id=__codelineno-40-26 name=__codelineno-40-26 href=#__codelineno-40-26></a>    <span class=k>assert</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>422</span>          <span class=c1># 422: Validation error.</span>
<a id=__codelineno-40-27 name=__codelineno-40-27 href=#__codelineno-40-27></a>
<a id=__codelineno-40-28 name=__codelineno-40-28 href=#__codelineno-40-28></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict_missing_field</span><span class=p>():</span>
<a id=__codelineno-40-29 name=__codelineno-40-29 href=#__codelineno-40-29></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-40-30 name=__codelineno-40-30 href=#__codelineno-40-30></a>        <span class=s2>&quot;credit_score&quot;</span><span class=p>:</span> <span class=mi>650</span>                     <span class=c1># Falta age: campo requerido.</span>
<a id=__codelineno-40-31 name=__codelineno-40-31 href=#__codelineno-40-31></a>    <span class=p>})</span>
<a id=__codelineno-40-32 name=__codelineno-40-32 href=#__codelineno-40-32></a>    <span class=k>assert</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>422</span>
</code></pre></div> <hr> <h2 id=pregunta-38-parametrized-tests>Pregunta 38: Parametrized Tests<a class=headerlink href=#pregunta-38-parametrized-tests title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo evitas duplicaci√≥n en tests?</strong></p> <h3 id=respuesta_37>Respuesta:<a class=headerlink href=#respuesta_37 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pytest</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=nd>@pytest</span><span class=o>.</span><span class=n>mark</span><span class=o>.</span><span class=n>parametrize</span><span class=p>(</span><span class=s2>&quot;credit_score,age,expected&quot;</span><span class=p>,</span> <span class=p>[</span>  <span class=c1># Lista de casos.</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a>    <span class=p>(</span><span class=mi>300</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>                               <span class=c1># M√≠nimos v√°lidos.</span>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a>    <span class=p>(</span><span class=mi>850</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>                              <span class=c1># M√°ximos v√°lidos.</span>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a>    <span class=p>(</span><span class=mi>650</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>                               <span class=c1># Caso t√≠pico.</span>
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=p>])</span>
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a><span class=k>def</span><span class=w> </span><span class=nf>test_prediction_cases</span><span class=p>(</span><span class=n>credit_score</span><span class=p>,</span> <span class=n>age</span><span class=p>,</span> <span class=n>expected</span><span class=p>):</span>  <span class=c1># Se ejecuta 3 veces.</span>
<a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a>    <span class=n>input_data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;credit_score&quot;</span><span class=p>:</span> <span class=n>credit_score</span><span class=p>,</span> <span class=s2>&quot;age&quot;</span><span class=p>:</span> <span class=n>age</span><span class=p>}</span>
<a id=__codelineno-41-10 name=__codelineno-41-10 href=#__codelineno-41-10></a>    <span class=n>pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span><span class=n>input_data</span><span class=p>]))</span>
<a id=__codelineno-41-11 name=__codelineno-41-11 href=#__codelineno-41-11></a>    <span class=k>assert</span> <span class=n>pred</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>                    <span class=c1># Verificamos formato, no valor exacto.</span>
<a id=__codelineno-41-12 name=__codelineno-41-12 href=#__codelineno-41-12></a>
<a id=__codelineno-41-13 name=__codelineno-41-13 href=#__codelineno-41-13></a><span class=nd>@pytest</span><span class=o>.</span><span class=n>mark</span><span class=o>.</span><span class=n>parametrize</span><span class=p>(</span><span class=s2>&quot;invalid_input,expected_error&quot;</span><span class=p>,</span> <span class=p>[</span>  <span class=c1># Casos de error.</span>
<a id=__codelineno-41-14 name=__codelineno-41-14 href=#__codelineno-41-14></a>    <span class=p>({</span><span class=s2>&quot;credit_score&quot;</span><span class=p>:</span> <span class=o>-</span><span class=mi>1</span><span class=p>},</span> <span class=s2>&quot;greater than or equal to 300&quot;</span><span class=p>),</span>
<a id=__codelineno-41-15 name=__codelineno-41-15 href=#__codelineno-41-15></a>    <span class=p>({</span><span class=s2>&quot;credit_score&quot;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>},</span> <span class=s2>&quot;less than or equal to 850&quot;</span><span class=p>),</span>
<a id=__codelineno-41-16 name=__codelineno-41-16 href=#__codelineno-41-16></a>    <span class=p>({</span><span class=s2>&quot;age&quot;</span><span class=p>:</span> <span class=mi>5</span><span class=p>},</span> <span class=s2>&quot;greater than or equal to 18&quot;</span><span class=p>),</span>
<a id=__codelineno-41-17 name=__codelineno-41-17 href=#__codelineno-41-17></a><span class=p>])</span>
<a id=__codelineno-41-18 name=__codelineno-41-18 href=#__codelineno-41-18></a><span class=k>def</span><span class=w> </span><span class=nf>test_validation_errors</span><span class=p>(</span><span class=n>invalid_input</span><span class=p>,</span> <span class=n>expected_error</span><span class=p>):</span>
<a id=__codelineno-41-19 name=__codelineno-41-19 href=#__codelineno-41-19></a>    <span class=n>response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>invalid_input</span><span class=p>)</span>
<a id=__codelineno-41-20 name=__codelineno-41-20 href=#__codelineno-41-20></a>    <span class=k>assert</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>422</span>          <span class=c1># Todos deben dar 422.</span>
<a id=__codelineno-41-21 name=__codelineno-41-21 href=#__codelineno-41-21></a>    <span class=k>assert</span> <span class=n>expected_error</span> <span class=ow>in</span> <span class=nb>str</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>())</span>  <span class=c1># Mensaje de error esperado.</span>
</code></pre></div> <hr> <h2 id=pregunta-39-testing-de-edge-cases>Pregunta 39: Testing de Edge Cases<a class=headerlink href=#pregunta-39-testing-de-edge-cases title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo testeas edge cases en ML?</strong></p> <h3 id=respuesta_38>Respuesta:<a class=headerlink href=#respuesta_38 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=c1># 1. Inputs vac√≠os</span>
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a><span class=k>def</span><span class=w> </span><span class=nf>test_empty_dataframe</span><span class=p>():</span>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>                          <span class=c1># DataFrame sin filas.</span>
<a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a>    <span class=k>with</span> <span class=n>pytest</span><span class=o>.</span><span class=n>raises</span><span class=p>(</span><span class=ne>ValueError</span><span class=p>):</span>              <span class=c1># Debe lanzar error.</span>
<a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a>        <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
<a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a>
<a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=c1># 2. Nulls</span>
<a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=k>def</span><span class=w> </span><span class=nf>test_missing_values</span><span class=p>():</span>
<a id=__codelineno-42-9 name=__codelineno-42-9 href=#__codelineno-42-9></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([{</span><span class=s2>&quot;CreditScore&quot;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>&quot;Age&quot;</span><span class=p>:</span> <span class=mi>35</span><span class=p>}])</span>  <span class=c1># NaN en feature.</span>
<a id=__codelineno-42-10 name=__codelineno-42-10 href=#__codelineno-42-10></a>    <span class=c1># Pipeline debe manejar o fallar graciosamente</span>
<a id=__codelineno-42-11 name=__codelineno-42-11 href=#__codelineno-42-11></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>                   <span class=c1># SimpleImputer deber√≠a manejar.</span>
<a id=__codelineno-42-12 name=__codelineno-42-12 href=#__codelineno-42-12></a>
<a id=__codelineno-42-13 name=__codelineno-42-13 href=#__codelineno-42-13></a><span class=c1># 3. Outliers extremos</span>
<a id=__codelineno-42-14 name=__codelineno-42-14 href=#__codelineno-42-14></a><span class=k>def</span><span class=w> </span><span class=nf>test_extreme_values</span><span class=p>():</span>
<a id=__codelineno-42-15 name=__codelineno-42-15 href=#__codelineno-42-15></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([{</span>
<a id=__codelineno-42-16 name=__codelineno-42-16 href=#__codelineno-42-16></a>        <span class=s2>&quot;CreditScore&quot;</span><span class=p>:</span> <span class=mi>850</span><span class=p>,</span>
<a id=__codelineno-42-17 name=__codelineno-42-17 href=#__codelineno-42-17></a>        <span class=s2>&quot;Age&quot;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-42-18 name=__codelineno-42-18 href=#__codelineno-42-18></a>        <span class=s2>&quot;Balance&quot;</span><span class=p>:</span> <span class=mi>1_000_000_000</span>                 <span class=c1># Outlier extremo.</span>
<a id=__codelineno-42-19 name=__codelineno-42-19 href=#__codelineno-42-19></a>    <span class=p>}])</span>
<a id=__codelineno-42-20 name=__codelineno-42-20 href=#__codelineno-42-20></a>    <span class=n>pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
<a id=__codelineno-42-21 name=__codelineno-42-21 href=#__codelineno-42-21></a>    <span class=k>assert</span> <span class=n>pred</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>in</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>                     <span class=c1># Debe predecir sin fallar.</span>
<a id=__codelineno-42-22 name=__codelineno-42-22 href=#__codelineno-42-22></a>
<a id=__codelineno-42-23 name=__codelineno-42-23 href=#__codelineno-42-23></a><span class=c1># 4. Tipos incorrectos</span>
<a id=__codelineno-42-24 name=__codelineno-42-24 href=#__codelineno-42-24></a><span class=k>def</span><span class=w> </span><span class=nf>test_wrong_types</span><span class=p>():</span>
<a id=__codelineno-42-25 name=__codelineno-42-25 href=#__codelineno-42-25></a>    <span class=k>with</span> <span class=n>pytest</span><span class=o>.</span><span class=n>raises</span><span class=p>(</span><span class=ne>Exception</span><span class=p>):</span>               <span class=c1># Debe fallar con tipo incorrecto.</span>
<a id=__codelineno-42-26 name=__codelineno-42-26 href=#__codelineno-42-26></a>        <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=s2>&quot;not a dataframe&quot;</span><span class=p>)</span>         <span class=c1># String en vez de DataFrame.</span>
<a id=__codelineno-42-27 name=__codelineno-42-27 href=#__codelineno-42-27></a>
<a id=__codelineno-42-28 name=__codelineno-42-28 href=#__codelineno-42-28></a><span class=c1># 5. Columnas faltantes</span>
<a id=__codelineno-42-29 name=__codelineno-42-29 href=#__codelineno-42-29></a><span class=k>def</span><span class=w> </span><span class=nf>test_missing_columns</span><span class=p>():</span>
<a id=__codelineno-42-30 name=__codelineno-42-30 href=#__codelineno-42-30></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([{</span><span class=s2>&quot;CreditScore&quot;</span><span class=p>:</span> <span class=mi>650</span><span class=p>}])</span>   <span class=c1># Falta Age.</span>
<a id=__codelineno-42-31 name=__codelineno-42-31 href=#__codelineno-42-31></a>    <span class=k>with</span> <span class=n>pytest</span><span class=o>.</span><span class=n>raises</span><span class=p>(</span><span class=ne>KeyError</span><span class=p>):</span>                <span class=c1># Pipeline necesita todas las columnas.</span>
<a id=__codelineno-42-32 name=__codelineno-42-32 href=#__codelineno-42-32></a>        <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</code></pre></div> <hr> <h2 id=pregunta-40-test-driven-development-tdd>Pregunta 40: Test-Driven Development (TDD)<a class=headerlink href=#pregunta-40-test-driven-development-tdd title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo aplicas TDD en ML?</strong></p> <h3 id=respuesta_39>Respuesta:<a class=headerlink href=#respuesta_39 title="Permanent link">&para;</a></h3> <p>TDD: Escribir test ‚Üí Ver que falla ‚Üí Implementar ‚Üí Ver que pasa ‚Üí Refactorizar.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=c1># 1. Escribir test primero</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=k>def</span><span class=w> </span><span class=nf>test_feature_engineer_creates_age_bucket</span><span class=p>():</span>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span><span class=s2>&quot;age&quot;</span><span class=p>:</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>45</span><span class=p>,</span> <span class=mi>65</span><span class=p>]})</span>     <span class=c1># Datos de prueba.</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a>    <span class=n>fe</span> <span class=o>=</span> <span class=n>FeatureEngineer</span><span class=p>()</span>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>fe</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
<a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a>
<a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a>    <span class=k>assert</span> <span class=s2>&quot;age_bucket&quot;</span> <span class=ow>in</span> <span class=n>result</span><span class=o>.</span><span class=n>columns</span>        <span class=c1># Verifica que crea columna.</span>
<a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a>    <span class=k>assert</span> <span class=nb>list</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=s2>&quot;age_bucket&quot;</span><span class=p>])</span> <span class=o>==</span> <span class=p>[</span><span class=s2>&quot;young&quot;</span><span class=p>,</span> <span class=s2>&quot;middle&quot;</span><span class=p>,</span> <span class=s2>&quot;senior&quot;</span><span class=p>]</span>  <span class=c1># Valores esperados.</span>
<a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a>
<a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=c1># 2. Test falla (FeatureEngineer no existe a√∫n)  # Red: test falla.</span>
<a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=c1># 3. Implementar m√≠nimo para pasar               # Green: c√≥digo m√≠nimo.</span>
<a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a><span class=k>class</span><span class=w> </span><span class=nc>FeatureEngineer</span><span class=p>(</span><span class=n>BaseEstimator</span><span class=p>,</span> <span class=n>TransformerMixin</span><span class=p>):</span>
<a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a>    <span class=k>def</span><span class=w> </span><span class=nf>transform</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
<a id=__codelineno-43-14 name=__codelineno-43-14 href=#__codelineno-43-14></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-43-15 name=__codelineno-43-15 href=#__codelineno-43-15></a>        <span class=n>X</span><span class=p>[</span><span class=s2>&quot;age_bucket&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span>                <span class=c1># pd.cut: binning.</span>
<a id=__codelineno-43-16 name=__codelineno-43-16 href=#__codelineno-43-16></a>            <span class=n>X</span><span class=p>[</span><span class=s2>&quot;age&quot;</span><span class=p>],</span> 
<a id=__codelineno-43-17 name=__codelineno-43-17 href=#__codelineno-43-17></a>            <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>50</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span>               <span class=c1># Rangos de edad.</span>
<a id=__codelineno-43-18 name=__codelineno-43-18 href=#__codelineno-43-18></a>            <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;young&quot;</span><span class=p>,</span> <span class=s2>&quot;middle&quot;</span><span class=p>,</span> <span class=s2>&quot;senior&quot;</span><span class=p>]</span> <span class=c1># Etiquetas.</span>
<a id=__codelineno-43-19 name=__codelineno-43-19 href=#__codelineno-43-19></a>        <span class=p>)</span>
<a id=__codelineno-43-20 name=__codelineno-43-20 href=#__codelineno-43-20></a>        <span class=k>return</span> <span class=n>X</span>
<a id=__codelineno-43-21 name=__codelineno-43-21 href=#__codelineno-43-21></a>
<a id=__codelineno-43-22 name=__codelineno-43-22 href=#__codelineno-43-22></a><span class=c1># 4. Test pasa ‚úì                                 # Verificar que pasa.</span>
<a id=__codelineno-43-23 name=__codelineno-43-23 href=#__codelineno-43-23></a><span class=c1># 5. Refactorizar si es necesario               # Mejorar sin romper tests.</span>
</code></pre></div> <p><strong>En ML, TDD es √∫til para</strong>: - Feature engineering (definir comportamiento esperado) - Validaci√≥n de datos - APIs</p> <hr> <h1 id=4-deployment-y-apis-preguntas-41-50>4. Deployment y APIs (Preguntas 41-50)<a class=headerlink href=#4-deployment-y-apis-preguntas-41-50 title="Permanent link">&para;</a></h1> <h2 id=pregunta-41-fastapi-basics>Pregunta 41: FastAPI Basics<a class=headerlink href=#pregunta-41-fastapi-basics title="Permanent link">&para;</a></h2> <p><strong>Muestra un endpoint de predicci√≥n.</strong></p> <h3 id=respuesta_40>Respuesta:<a class=headerlink href=#respuesta_40 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=kn>from</span><span class=w> </span><span class=nn>fastapi</span><span class=w> </span><span class=kn>import</span> <span class=n>FastAPI</span>                      <span class=c1># Framework web.</span>
<a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>BaseModel</span>                   <span class=c1># Validaci√≥n de datos.</span>
<a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a>
<a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>                                  <span class=c1># Crea aplicaci√≥n.</span>
<a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a>
<a id=__codelineno-44-6 name=__codelineno-44-6 href=#__codelineno-44-6></a><span class=k>class</span><span class=w> </span><span class=nc>Input</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>                          <span class=c1># Schema de entrada.</span>
<a id=__codelineno-44-7 name=__codelineno-44-7 href=#__codelineno-44-7></a>    <span class=n>credit_score</span><span class=p>:</span> <span class=nb>int</span>
<a id=__codelineno-44-8 name=__codelineno-44-8 href=#__codelineno-44-8></a>    <span class=n>age</span><span class=p>:</span> <span class=nb>int</span>
<a id=__codelineno-44-9 name=__codelineno-44-9 href=#__codelineno-44-9></a>
<a id=__codelineno-44-10 name=__codelineno-44-10 href=#__codelineno-44-10></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>)</span>                            <span class=c1># Endpoint POST.</span>
<a id=__codelineno-44-11 name=__codelineno-44-11 href=#__codelineno-44-11></a><span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>Input</span><span class=p>):</span>                        <span class=c1># FastAPI valida autom√°ticamente.</span>
<a id=__codelineno-44-12 name=__codelineno-44-12 href=#__codelineno-44-12></a>    <span class=n>X</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span><span class=n>data</span><span class=o>.</span><span class=n>dict</span><span class=p>()])</span>              <span class=c1># Convierte a DataFrame.</span>
<a id=__codelineno-44-13 name=__codelineno-44-13 href=#__codelineno-44-13></a>    <span class=n>pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>                      <span class=c1># Predice.</span>
<a id=__codelineno-44-14 name=__codelineno-44-14 href=#__codelineno-44-14></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>&quot;prediction&quot;</span><span class=p>:</span> <span class=nb>int</span><span class=p>(</span><span class=n>pred</span><span class=p>[</span><span class=mi>0</span><span class=p>])}</span>          <span class=c1># Retorna JSON.</span>
</code></pre></div> <hr> <h2 id=pregunta-42-health-checks>Pregunta 42: Health Checks<a class=headerlink href=#pregunta-42-health-checks title="Permanent link">&para;</a></h2> <p><strong>¬øPor qu√© tener /health endpoint?</strong></p> <h3 id=respuesta_41>Respuesta:<a class=headerlink href=#respuesta_41 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/health&quot;</span><span class=p>)</span>                              <span class=c1># GET endpoint para health checks.</span>
<a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a><span class=k>def</span><span class=w> </span><span class=nf>health</span><span class=p>():</span>
<a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a>    <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a>        <span class=s2>&quot;status&quot;</span><span class=p>:</span> <span class=s2>&quot;healthy&quot;</span><span class=p>,</span>                     <span class=c1># Estado general.</span>
<a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a>        <span class=s2>&quot;model_loaded&quot;</span><span class=p>:</span> <span class=n>model</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>,</span>       <span class=c1># Verifica que modelo carg√≥.</span>
<a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a>        <span class=s2>&quot;version&quot;</span><span class=p>:</span> <span class=s2>&quot;1.0.0&quot;</span>                       <span class=c1># Versi√≥n para debugging.</span>
<a id=__codelineno-45-7 name=__codelineno-45-7 href=#__codelineno-45-7></a>    <span class=p>}</span>
</code></pre></div> <p>Kubernetes usa esto para saber si el pod est√° listo.</p> <hr> <h2 id=pregunta-43-uvicorn-y-asgi>Pregunta 43: Uvicorn y ASGI<a class=headerlink href=#pregunta-43-uvicorn-y-asgi title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© es uvicorn y por qu√© usarlo?</strong></p> <h3 id=respuesta_42>Respuesta:<a class=headerlink href=#respuesta_42 title="Permanent link">&para;</a></h3> <p>Uvicorn = servidor ASGI (Asynchronous Server Gateway Interface) de alto rendimiento.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=c1># Desarrollo</span>
<a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a>uvicorn<span class=w> </span>app.fastapi_app:app<span class=w> </span>--reload<span class=w> </span>--port<span class=w> </span><span class=m>8000</span><span class=w>  </span><span class=c1># --reload: hot reload con cambios.</span>
<a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a>
<a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a><span class=c1># Producci√≥n</span>
<a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a>uvicorn<span class=w> </span>app.fastapi_app:app<span class=w> </span>--host<span class=w> </span><span class=m>0</span>.0.0.0<span class=w> </span>--port<span class=w> </span><span class=m>8000</span><span class=w> </span>--workers<span class=w> </span><span class=m>4</span><span class=w>  </span><span class=c1># --workers: procesos paralelos.</span>
</code></pre></div> <p><strong>Configuraci√≥n para producci√≥n</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=c1># Con gunicorn + uvicorn workers</span>
<a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=n>gunicorn</span> <span class=n>app</span><span class=o>.</span><span class=n>fastapi_app</span><span class=p>:</span><span class=n>app</span> \                   <span class=c1># gunicorn: gestor de procesos.</span>
<a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a>    <span class=o>--</span><span class=n>workers</span> <span class=mi>4</span> \                                <span class=c1># 4 procesos worker.</span>
<a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a>    <span class=o>--</span><span class=n>worker</span><span class=o>-</span><span class=k>class</span><span class=w> </span><span class=nc>uvicorn</span><span class=o>.</span><span class=n>workers</span><span class=o>.</span><span class=n>UvicornWorker</span> \  <span class=c1># Workers ASGI.</span>
<a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a>    <span class=o>--</span><span class=n>bind</span> <span class=mf>0.0.0.0</span><span class=p>:</span><span class=mi>8000</span>                          <span class=c1># Puerto y host.</span>
</code></pre></div></p> <p><strong>ASGI vs WSGI</strong>: | WSGI | ASGI | |------|------| | Sync only | Async + Sync | | Flask, Django | FastAPI, Starlette | | Una request a la vez por worker | M√∫ltiples requests concurrentes |</p> <hr> <h2 id=pregunta-44-cors-configuration>Pregunta 44: CORS Configuration<a class=headerlink href=#pregunta-44-cors-configuration title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo manejas CORS en FastAPI?</strong></p> <h3 id=respuesta_43>Respuesta:<a class=headerlink href=#respuesta_43 title="Permanent link">&para;</a></h3> <p>CORS = Cross-Origin Resource Sharing. Necesario cuando frontend y backend est√°n en dominios distintos.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=kn>from</span><span class=w> </span><span class=nn>fastapi</span><span class=w> </span><span class=kn>import</span> <span class=n>FastAPI</span>
<a id=__codelineno-48-2 name=__codelineno-48-2 href=#__codelineno-48-2></a><span class=kn>from</span><span class=w> </span><span class=nn>fastapi.middleware.cors</span><span class=w> </span><span class=kn>import</span> <span class=n>CORSMiddleware</span>  <span class=c1># Middleware para CORS.</span>
<a id=__codelineno-48-3 name=__codelineno-48-3 href=#__codelineno-48-3></a>
<a id=__codelineno-48-4 name=__codelineno-48-4 href=#__codelineno-48-4></a><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
<a id=__codelineno-48-5 name=__codelineno-48-5 href=#__codelineno-48-5></a>
<a id=__codelineno-48-6 name=__codelineno-48-6 href=#__codelineno-48-6></a><span class=n>app</span><span class=o>.</span><span class=n>add_middleware</span><span class=p>(</span>
<a id=__codelineno-48-7 name=__codelineno-48-7 href=#__codelineno-48-7></a>    <span class=n>CORSMiddleware</span><span class=p>,</span>
<a id=__codelineno-48-8 name=__codelineno-48-8 href=#__codelineno-48-8></a>    <span class=n>allow_origins</span><span class=o>=</span><span class=p>[</span>                              <span class=c1># Or√≠genes permitidos.</span>
<a id=__codelineno-48-9 name=__codelineno-48-9 href=#__codelineno-48-9></a>        <span class=s2>&quot;http://localhost:3000&quot;</span><span class=p>,</span>                 <span class=c1># React dev.</span>
<a id=__codelineno-48-10 name=__codelineno-48-10 href=#__codelineno-48-10></a>        <span class=s2>&quot;https://myapp.example.com&quot;</span><span class=p>,</span>             <span class=c1># Producci√≥n.</span>
<a id=__codelineno-48-11 name=__codelineno-48-11 href=#__codelineno-48-11></a>    <span class=p>],</span>
<a id=__codelineno-48-12 name=__codelineno-48-12 href=#__codelineno-48-12></a>    <span class=n>allow_credentials</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>                      <span class=c1># Permite cookies.</span>
<a id=__codelineno-48-13 name=__codelineno-48-13 href=#__codelineno-48-13></a>    <span class=n>allow_methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;GET&quot;</span><span class=p>,</span> <span class=s2>&quot;POST&quot;</span><span class=p>],</span>               <span class=c1># M√©todos HTTP permitidos.</span>
<a id=__codelineno-48-14 name=__codelineno-48-14 href=#__codelineno-48-14></a>    <span class=n>allow_headers</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;*&quot;</span><span class=p>],</span>                         <span class=c1># Headers permitidos.</span>
<a id=__codelineno-48-15 name=__codelineno-48-15 href=#__codelineno-48-15></a><span class=p>)</span>
</code></pre></div> <p><strong>En producci√≥n</strong>: Especificar or√≠genes exactos, no usar <code>"*"</code>.</p> <hr> <h2 id=pregunta-45-async-en-fastapi>Pregunta 45: Async en FastAPI<a class=headerlink href=#pregunta-45-async-en-fastapi title="Permanent link">&para;</a></h2> <p><strong>¬øCu√°ndo usar async def vs def?</strong></p> <h3 id=respuesta_44>Respuesta:<a class=headerlink href=#respuesta_44 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=c1># Sync: operaciones CPU-bound o librer√≠as sync</span>
<a id=__codelineno-49-2 name=__codelineno-49-2 href=#__codelineno-49-2></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>)</span>
<a id=__codelineno-49-3 name=__codelineno-49-3 href=#__codelineno-49-3></a><span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>Input</span><span class=p>):</span>                       <span class=c1># def: s√≠ncrono.</span>
<a id=__codelineno-49-4 name=__codelineno-49-4 href=#__codelineno-49-4></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>                 <span class=c1># sklearn es sync, no usar async.</span>
<a id=__codelineno-49-5 name=__codelineno-49-5 href=#__codelineno-49-5></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>&quot;prediction&quot;</span><span class=p>:</span> <span class=n>result</span><span class=p>}</span>
<a id=__codelineno-49-6 name=__codelineno-49-6 href=#__codelineno-49-6></a>
<a id=__codelineno-49-7 name=__codelineno-49-7 href=#__codelineno-49-7></a><span class=c1># Async: operaciones I/O-bound</span>
<a id=__codelineno-49-8 name=__codelineno-49-8 href=#__codelineno-49-8></a><span class=nd>@app</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;/external-data&quot;</span><span class=p>)</span>
<a id=__codelineno-49-9 name=__codelineno-49-9 href=#__codelineno-49-9></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>get_external</span><span class=p>():</span>                        <span class=c1># async def: as√≠ncrono.</span>
<a id=__codelineno-49-10 name=__codelineno-49-10 href=#__codelineno-49-10></a>    <span class=k>async</span> <span class=k>with</span> <span class=n>httpx</span><span class=o>.</span><span class=n>AsyncClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>client</span><span class=p>:</span>   <span class=c1># Cliente HTTP as√≠ncrono.</span>
<a id=__codelineno-49-11 name=__codelineno-49-11 href=#__codelineno-49-11></a>        <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://api.example.com/data&quot;</span><span class=p>)</span>  <span class=c1># await: espera sin bloquear.</span>
<a id=__codelineno-49-12 name=__codelineno-49-12 href=#__codelineno-49-12></a>    <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</code></pre></div> <p><strong>Regla general</strong>: | Operaci√≥n | Usar | |-----------|------| | sklearn, pandas, joblib | <code>def</code> (sync) | | HTTP requests, DB async | <code>async def</code> | | File I/O masivo | <code>async def</code> con aiofiles |</p> <hr> <h2 id=pregunta-46-model-caching>Pregunta 46: Model Caching<a class=headerlink href=#pregunta-46-model-caching title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo evitas cargar el modelo en cada request?</strong></p> <h3 id=respuesta_45>Respuesta:<a class=headerlink href=#respuesta_45 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=c1># FastAPI: lru_cache</span>
<a id=__codelineno-50-2 name=__codelineno-50-2 href=#__codelineno-50-2></a><span class=kn>from</span><span class=w> </span><span class=nn>functools</span><span class=w> </span><span class=kn>import</span> <span class=n>lru_cache</span>                  <span class=c1># Cache de funciones.</span>
<a id=__codelineno-50-3 name=__codelineno-50-3 href=#__codelineno-50-3></a>
<a id=__codelineno-50-4 name=__codelineno-50-4 href=#__codelineno-50-4></a><span class=nd>@lru_cache</span><span class=p>()</span>                                     <span class=c1># Cachea resultado de la funci√≥n.</span>
<a id=__codelineno-50-5 name=__codelineno-50-5 href=#__codelineno-50-5></a><span class=k>def</span><span class=w> </span><span class=nf>get_model</span><span class=p>():</span>
<a id=__codelineno-50-6 name=__codelineno-50-6 href=#__codelineno-50-6></a>    <span class=k>return</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;artifacts/pipeline.joblib&quot;</span><span class=p>)</span>  <span class=c1># Solo carga una vez.</span>
<a id=__codelineno-50-7 name=__codelineno-50-7 href=#__codelineno-50-7></a>
<a id=__codelineno-50-8 name=__codelineno-50-8 href=#__codelineno-50-8></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>)</span>
<a id=__codelineno-50-9 name=__codelineno-50-9 href=#__codelineno-50-9></a><span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>Input</span><span class=p>):</span>
<a id=__codelineno-50-10 name=__codelineno-50-10 href=#__codelineno-50-10></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>get_model</span><span class=p>()</span>                          <span class=c1># Primera vez: carga. Resto: cache.</span>
<a id=__codelineno-50-11 name=__codelineno-50-11 href=#__codelineno-50-11></a>    <span class=k>return</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=__codelineno-50-12 name=__codelineno-50-12 href=#__codelineno-50-12></a>
<a id=__codelineno-50-13 name=__codelineno-50-13 href=#__codelineno-50-13></a><span class=c1># Alternativa: cargar al inicio</span>
<a id=__codelineno-50-14 name=__codelineno-50-14 href=#__codelineno-50-14></a><span class=n>model</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-50-15 name=__codelineno-50-15 href=#__codelineno-50-15></a>
<a id=__codelineno-50-16 name=__codelineno-50-16 href=#__codelineno-50-16></a><span class=nd>@app</span><span class=o>.</span><span class=n>on_event</span><span class=p>(</span><span class=s2>&quot;startup&quot;</span><span class=p>)</span>                         <span class=c1># Se ejecuta al iniciar app.</span>
<a id=__codelineno-50-17 name=__codelineno-50-17 href=#__codelineno-50-17></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>load_model</span><span class=p>():</span>
<a id=__codelineno-50-18 name=__codelineno-50-18 href=#__codelineno-50-18></a>    <span class=k>global</span> <span class=n>model</span>                                 <span class=c1># Modifica variable global.</span>
<a id=__codelineno-50-19 name=__codelineno-50-19 href=#__codelineno-50-19></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;artifacts/pipeline.joblib&quot;</span><span class=p>)</span>
</code></pre></div> <p><strong>Streamlit</strong>: <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=nd>@st</span><span class=o>.</span><span class=n>cache_resource</span>                               <span class=c1># Cache persistente entre reruns.</span>
<a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a><span class=k>def</span><span class=w> </span><span class=nf>load_model</span><span class=p>():</span>
<a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a>    <span class=k>return</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;artifacts/pipeline.joblib&quot;</span><span class=p>)</span>  <span class=c1># Solo carga una vez.</span>
<a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a>
<a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a><span class=n>model</span> <span class=o>=</span> <span class=n>load_model</span><span class=p>()</span>                             <span class=c1># Cacheado entre interacciones.</span>
</code></pre></div></p> <hr> <h2 id=pregunta-47-streamlit-dashboard>Pregunta 47: Streamlit Dashboard<a class=headerlink href=#pregunta-47-streamlit-dashboard title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo creas un dashboard de predicci√≥n?</strong></p> <h3 id=respuesta_46>Respuesta:<a class=headerlink href=#respuesta_46 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=kn>import</span><span class=w> </span><span class=nn>streamlit</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>st</span>
<a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a>
<a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a><span class=n>st</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>&quot;üè¶ BankChurn Predictor&quot;</span><span class=p>)</span>                <span class=c1># T√≠tulo de la app.</span>
<a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a>
<a id=__codelineno-52-6 name=__codelineno-52-6 href=#__codelineno-52-6></a><span class=c1># Sidebar para inputs</span>
<a id=__codelineno-52-7 name=__codelineno-52-7 href=#__codelineno-52-7></a><span class=n>st</span><span class=o>.</span><span class=n>sidebar</span><span class=o>.</span><span class=n>header</span><span class=p>(</span><span class=s2>&quot;Customer Data&quot;</span><span class=p>)</span>               <span class=c1># Header en sidebar.</span>
<a id=__codelineno-52-8 name=__codelineno-52-8 href=#__codelineno-52-8></a><span class=n>credit_score</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=n>sidebar</span><span class=o>.</span><span class=n>slider</span><span class=p>(</span><span class=s2>&quot;Credit Score&quot;</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>850</span><span class=p>,</span> <span class=mi>650</span><span class=p>)</span>  <span class=c1># Slider con rango.</span>
<a id=__codelineno-52-9 name=__codelineno-52-9 href=#__codelineno-52-9></a><span class=n>age</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=n>sidebar</span><span class=o>.</span><span class=n>slider</span><span class=p>(</span><span class=s2>&quot;Age&quot;</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>35</span><span class=p>)</span>      <span class=c1># Valor default: 35.</span>
<a id=__codelineno-52-10 name=__codelineno-52-10 href=#__codelineno-52-10></a><span class=n>geography</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=n>sidebar</span><span class=o>.</span><span class=n>selectbox</span><span class=p>(</span><span class=s2>&quot;Geography&quot;</span><span class=p>,</span> <span class=p>[</span><span class=s2>&quot;France&quot;</span><span class=p>,</span> <span class=s2>&quot;Germany&quot;</span><span class=p>,</span> <span class=s2>&quot;Spain&quot;</span><span class=p>])</span>  <span class=c1># Dropdown.</span>
<a id=__codelineno-52-11 name=__codelineno-52-11 href=#__codelineno-52-11></a>
<a id=__codelineno-52-12 name=__codelineno-52-12 href=#__codelineno-52-12></a><span class=c1># Cargar modelo (cacheado)</span>
<a id=__codelineno-52-13 name=__codelineno-52-13 href=#__codelineno-52-13></a><span class=nd>@st</span><span class=o>.</span><span class=n>cache_resource</span>                               <span class=c1># Cache para recursos pesados.</span>
<a id=__codelineno-52-14 name=__codelineno-52-14 href=#__codelineno-52-14></a><span class=k>def</span><span class=w> </span><span class=nf>load_model</span><span class=p>():</span>
<a id=__codelineno-52-15 name=__codelineno-52-15 href=#__codelineno-52-15></a>    <span class=k>return</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;artifacts/pipeline.joblib&quot;</span><span class=p>)</span>
<a id=__codelineno-52-16 name=__codelineno-52-16 href=#__codelineno-52-16></a>
<a id=__codelineno-52-17 name=__codelineno-52-17 href=#__codelineno-52-17></a><span class=n>model</span> <span class=o>=</span> <span class=n>load_model</span><span class=p>()</span>                             <span class=c1># Carga una sola vez.</span>
<a id=__codelineno-52-18 name=__codelineno-52-18 href=#__codelineno-52-18></a>
<a id=__codelineno-52-19 name=__codelineno-52-19 href=#__codelineno-52-19></a><span class=c1># Predicci√≥n</span>
<a id=__codelineno-52-20 name=__codelineno-52-20 href=#__codelineno-52-20></a><span class=k>if</span> <span class=n>st</span><span class=o>.</span><span class=n>sidebar</span><span class=o>.</span><span class=n>button</span><span class=p>(</span><span class=s2>&quot;Predict&quot;</span><span class=p>):</span>                 <span class=c1># Bot√≥n que dispara predicci√≥n.</span>
<a id=__codelineno-52-21 name=__codelineno-52-21 href=#__codelineno-52-21></a>    <span class=n>input_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([{</span>                   <span class=c1># Crea DataFrame de entrada.</span>
<a id=__codelineno-52-22 name=__codelineno-52-22 href=#__codelineno-52-22></a>        <span class=s2>&quot;CreditScore&quot;</span><span class=p>:</span> <span class=n>credit_score</span><span class=p>,</span>
<a id=__codelineno-52-23 name=__codelineno-52-23 href=#__codelineno-52-23></a>        <span class=s2>&quot;Age&quot;</span><span class=p>:</span> <span class=n>age</span><span class=p>,</span>
<a id=__codelineno-52-24 name=__codelineno-52-24 href=#__codelineno-52-24></a>        <span class=s2>&quot;Geography&quot;</span><span class=p>:</span> <span class=n>geography</span>
<a id=__codelineno-52-25 name=__codelineno-52-25 href=#__codelineno-52-25></a>    <span class=p>}])</span>
<a id=__codelineno-52-26 name=__codelineno-52-26 href=#__codelineno-52-26></a>
<a id=__codelineno-52-27 name=__codelineno-52-27 href=#__codelineno-52-27></a>    <span class=n>prediction</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>input_df</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>      <span class=c1># Predicci√≥n binaria.</span>
<a id=__codelineno-52-28 name=__codelineno-52-28 href=#__codelineno-52-28></a>    <span class=n>proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>input_df</span><span class=p>)[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>  <span class=c1># Probabilidad de clase 1.</span>
<a id=__codelineno-52-29 name=__codelineno-52-29 href=#__codelineno-52-29></a>
<a id=__codelineno-52-30 name=__codelineno-52-30 href=#__codelineno-52-30></a>    <span class=n>col1</span><span class=p>,</span> <span class=n>col2</span> <span class=o>=</span> <span class=n>st</span><span class=o>.</span><span class=n>columns</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>                   <span class=c1># Layout en 2 columnas.</span>
<a id=__codelineno-52-31 name=__codelineno-52-31 href=#__codelineno-52-31></a>    <span class=n>col1</span><span class=o>.</span><span class=n>metric</span><span class=p>(</span><span class=s2>&quot;Prediction&quot;</span><span class=p>,</span> <span class=s2>&quot;Churn&quot;</span> <span class=k>if</span> <span class=n>prediction</span> <span class=k>else</span> <span class=s2>&quot;Stay&quot;</span><span class=p>)</span>  <span class=c1># Muestra resultado.</span>
<a id=__codelineno-52-32 name=__codelineno-52-32 href=#__codelineno-52-32></a>    <span class=n>col2</span><span class=o>.</span><span class=n>metric</span><span class=p>(</span><span class=s2>&quot;Probability&quot;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>proba</span><span class=si>:</span><span class=s2>.1%</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>   <span class=c1># Probabilidad formateada.</span>
</code></pre></div> <hr> <h2 id=pregunta-48-docker-compose-para-ml>Pregunta 48: Docker Compose para ML<a class=headerlink href=#pregunta-48-docker-compose-para-ml title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo orquestas m√∫ltiples servicios?</strong></p> <h3 id=respuesta_47>Respuesta:<a class=headerlink href=#respuesta_47 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=c1># docker-compose.yml</span>
<a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s>&#39;3.8&#39;</span>
<a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a>
<a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a><span class=nt>services</span><span class=p>:</span>
<a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a><span class=w>  </span><span class=nt>api</span><span class=p>:</span>
<a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a><span class=w>    </span><span class=nt>build</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">.</span><span class=w>                                     </span><span class=c1># Construye desde Dockerfile local.</span>
<a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a><span class=w>    </span><span class=nt>ports</span><span class=p>:</span>
<a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;8000:8000&quot;</span><span class=w>                              </span><span class=c1># host:container.</span>
<a id=__codelineno-53-9 name=__codelineno-53-9 href=#__codelineno-53-9></a><span class=w>    </span><span class=nt>environment</span><span class=p>:</span>
<a id=__codelineno-53-10 name=__codelineno-53-10 href=#__codelineno-53-10></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MODEL_PATH=/app/artifacts/pipeline.joblib</span><span class=w>  </span><span class=c1># Variable de entorno.</span>
<a id=__codelineno-53-11 name=__codelineno-53-11 href=#__codelineno-53-11></a><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span>
<a id=__codelineno-53-12 name=__codelineno-53-12 href=#__codelineno-53-12></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">./artifacts:/app/artifacts:ro</span><span class=w>            </span><span class=c1># ro: read-only.</span>
<a id=__codelineno-53-13 name=__codelineno-53-13 href=#__codelineno-53-13></a><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span>
<a id=__codelineno-53-14 name=__codelineno-53-14 href=#__codelineno-53-14></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mlflow</span><span class=w>                                   </span><span class=c1># Espera a que mlflow inicie.</span>
<a id=__codelineno-53-15 name=__codelineno-53-15 href=#__codelineno-53-15></a><span class=w>    </span><span class=nt>healthcheck</span><span class=p>:</span>
<a id=__codelineno-53-16 name=__codelineno-53-16 href=#__codelineno-53-16></a><span class=w>      </span><span class=nt>test</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;CMD&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;curl&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;-f&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;http://localhost:8000/health&quot;</span><span class="p p-Indicator">]</span><span class=w>  </span><span class=c1># Health check.</span>
<a id=__codelineno-53-17 name=__codelineno-53-17 href=#__codelineno-53-17></a><span class=w>      </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30s</span><span class=w>                              </span><span class=c1># Cada 30 segundos.</span>
<a id=__codelineno-53-18 name=__codelineno-53-18 href=#__codelineno-53-18></a><span class=w>      </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10s</span>
<a id=__codelineno-53-19 name=__codelineno-53-19 href=#__codelineno-53-19></a><span class=w>      </span><span class=nt>retries</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id=__codelineno-53-20 name=__codelineno-53-20 href=#__codelineno-53-20></a>
<a id=__codelineno-53-21 name=__codelineno-53-21 href=#__codelineno-53-21></a><span class=w>  </span><span class=nt>mlflow</span><span class=p>:</span>
<a id=__codelineno-53-22 name=__codelineno-53-22 href=#__codelineno-53-22></a><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">python:3.11-slim</span><span class=w>                      </span><span class=c1># Imagen base.</span>
<a id=__codelineno-53-23 name=__codelineno-53-23 href=#__codelineno-53-23></a><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mlflow server --host 0.0.0.0</span><span class=w>        </span><span class=c1># Comando de inicio.</span>
<a id=__codelineno-53-24 name=__codelineno-53-24 href=#__codelineno-53-24></a><span class=w>    </span><span class=nt>ports</span><span class=p>:</span>
<a id=__codelineno-53-25 name=__codelineno-53-25 href=#__codelineno-53-25></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;5000:5000&quot;</span>
<a id=__codelineno-53-26 name=__codelineno-53-26 href=#__codelineno-53-26></a><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span>
<a id=__codelineno-53-27 name=__codelineno-53-27 href=#__codelineno-53-27></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">./mlruns:/mlflow/mlruns</span><span class=w>                  </span><span class=c1># Persistencia de experimentos.</span>
<a id=__codelineno-53-28 name=__codelineno-53-28 href=#__codelineno-53-28></a>
<a id=__codelineno-53-29 name=__codelineno-53-29 href=#__codelineno-53-29></a><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span>
<a id=__codelineno-53-30 name=__codelineno-53-30 href=#__codelineno-53-30></a><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">prom/prometheus</span><span class=w>                       </span><span class=c1># Imagen oficial.</span>
<a id=__codelineno-53-31 name=__codelineno-53-31 href=#__codelineno-53-31></a><span class=w>    </span><span class=nt>ports</span><span class=p>:</span>
<a id=__codelineno-53-32 name=__codelineno-53-32 href=#__codelineno-53-32></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;9090:9090&quot;</span>
<a id=__codelineno-53-33 name=__codelineno-53-33 href=#__codelineno-53-33></a><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span>
<a id=__codelineno-53-34 name=__codelineno-53-34 href=#__codelineno-53-34></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">./prometheus.yml:/etc/prometheus/prometheus.yml</span><span class=w>  </span><span class=c1># Config.</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a>docker-compose<span class=w> </span>up<span class=w> </span>-d<span class=w>                            </span><span class=c1># -d: detached (background).</span>
<a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a>docker-compose<span class=w> </span>logs<span class=w> </span>-f<span class=w> </span>api<span class=w>                      </span><span class=c1># -f: follow logs en tiempo real.</span>
</code></pre></div> <hr> <h2 id=pregunta-49-kubernetes-deployment>Pregunta 49: Kubernetes Deployment<a class=headerlink href=#pregunta-49-kubernetes-deployment title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo despliegas en Kubernetes?</strong></p> <h3 id=respuesta_48>Respuesta:<a class=headerlink href=#respuesta_48 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=c1># deployment.yaml</span>
<a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id=__codelineno-55-3 name=__codelineno-55-3 href=#__codelineno-55-3></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span><span class=w>                                </span><span class=c1># Tipo de recurso K8s.</span>
<a id=__codelineno-55-4 name=__codelineno-55-4 href=#__codelineno-55-4></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-55-5 name=__codelineno-55-5 href=#__codelineno-55-5></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api</span>
<a id=__codelineno-55-6 name=__codelineno-55-6 href=#__codelineno-55-6></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-55-7 name=__codelineno-55-7 href=#__codelineno-55-7></a><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span><span class=w>                                   </span><span class=c1># 3 instancias del pod.</span>
<a id=__codelineno-55-8 name=__codelineno-55-8 href=#__codelineno-55-8></a><span class=w>  </span><span class=nt>selector</span><span class=p>:</span>
<a id=__codelineno-55-9 name=__codelineno-55-9 href=#__codelineno-55-9></a><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span>
<a id=__codelineno-55-10 name=__codelineno-55-10 href=#__codelineno-55-10></a><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api</span><span class=w>                        </span><span class=c1># Selector para pods.</span>
<a id=__codelineno-55-11 name=__codelineno-55-11 href=#__codelineno-55-11></a><span class=w>  </span><span class=nt>template</span><span class=p>:</span>
<a id=__codelineno-55-12 name=__codelineno-55-12 href=#__codelineno-55-12></a><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-55-13 name=__codelineno-55-13 href=#__codelineno-55-13></a><span class=w>      </span><span class=nt>labels</span><span class=p>:</span>
<a id=__codelineno-55-14 name=__codelineno-55-14 href=#__codelineno-55-14></a><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api</span>
<a id=__codelineno-55-15 name=__codelineno-55-15 href=#__codelineno-55-15></a><span class=w>    </span><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-55-16 name=__codelineno-55-16 href=#__codelineno-55-16></a><span class=w>      </span><span class=nt>containers</span><span class=p>:</span>
<a id=__codelineno-55-17 name=__codelineno-55-17 href=#__codelineno-55-17></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">api</span>
<a id=__codelineno-55-18 name=__codelineno-55-18 href=#__codelineno-55-18></a><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api:v1.0.0</span><span class=w>             </span><span class=c1># Imagen Docker.</span>
<a id=__codelineno-55-19 name=__codelineno-55-19 href=#__codelineno-55-19></a><span class=w>        </span><span class=nt>ports</span><span class=p>:</span>
<a id=__codelineno-55-20 name=__codelineno-55-20 href=#__codelineno-55-20></a><span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8000</span><span class=w>                   </span><span class=c1># Puerto interno.</span>
<a id=__codelineno-55-21 name=__codelineno-55-21 href=#__codelineno-55-21></a><span class=w>        </span><span class=nt>resources</span><span class=p>:</span>
<a id=__codelineno-55-22 name=__codelineno-55-22 href=#__codelineno-55-22></a><span class=w>          </span><span class=nt>requests</span><span class=p>:</span><span class=w>                             </span><span class=c1># M√≠nimo garantizado.</span>
<a id=__codelineno-55-23 name=__codelineno-55-23 href=#__codelineno-55-23></a><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s>&quot;256Mi&quot;</span>
<a id=__codelineno-55-24 name=__codelineno-55-24 href=#__codelineno-55-24></a><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s>&quot;250m&quot;</span><span class=w>                         </span><span class=c1># 0.25 CPU.</span>
<a id=__codelineno-55-25 name=__codelineno-55-25 href=#__codelineno-55-25></a><span class=w>          </span><span class=nt>limits</span><span class=p>:</span><span class=w>                               </span><span class=c1># M√°ximo permitido.</span>
<a id=__codelineno-55-26 name=__codelineno-55-26 href=#__codelineno-55-26></a><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s>&quot;512Mi&quot;</span>
<a id=__codelineno-55-27 name=__codelineno-55-27 href=#__codelineno-55-27></a><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s>&quot;500m&quot;</span>
<a id=__codelineno-55-28 name=__codelineno-55-28 href=#__codelineno-55-28></a><span class=w>        </span><span class=nt>livenessProbe</span><span class=p>:</span><span class=w>                          </span><span class=c1># Verifica si pod est√° vivo.</span>
<a id=__codelineno-55-29 name=__codelineno-55-29 href=#__codelineno-55-29></a><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span>
<a id=__codelineno-55-30 name=__codelineno-55-30 href=#__codelineno-55-30></a><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/health</span>
<a id=__codelineno-55-31 name=__codelineno-55-31 href=#__codelineno-55-31></a><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<a id=__codelineno-55-32 name=__codelineno-55-32 href=#__codelineno-55-32></a><span class=w>          </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class=w>               </span><span class=c1># Espera antes de primer check.</span>
<a id=__codelineno-55-33 name=__codelineno-55-33 href=#__codelineno-55-33></a><span class=w>          </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class=w>                     </span><span class=c1># Cada 10 segundos.</span>
<a id=__codelineno-55-34 name=__codelineno-55-34 href=#__codelineno-55-34></a><span class=w>        </span><span class=nt>readinessProbe</span><span class=p>:</span><span class=w>                         </span><span class=c1># Verifica si puede recibir tr√°fico.</span>
<a id=__codelineno-55-35 name=__codelineno-55-35 href=#__codelineno-55-35></a><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span>
<a id=__codelineno-55-36 name=__codelineno-55-36 href=#__codelineno-55-36></a><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/health</span>
<a id=__codelineno-55-37 name=__codelineno-55-37 href=#__codelineno-55-37></a><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<a id=__codelineno-55-38 name=__codelineno-55-38 href=#__codelineno-55-38></a><span class=w>          </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id=__codelineno-55-39 name=__codelineno-55-39 href=#__codelineno-55-39></a><span class=w>          </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id=__codelineno-55-40 name=__codelineno-55-40 href=#__codelineno-55-40></a><span class=nn>---</span>
<a id=__codelineno-55-41 name=__codelineno-55-41 href=#__codelineno-55-41></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id=__codelineno-55-42 name=__codelineno-55-42 href=#__codelineno-55-42></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Service</span><span class=w>                                   </span><span class=c1># Expone pods como servicio.</span>
<a id=__codelineno-55-43 name=__codelineno-55-43 href=#__codelineno-55-43></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-55-44 name=__codelineno-55-44 href=#__codelineno-55-44></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api</span>
<a id=__codelineno-55-45 name=__codelineno-55-45 href=#__codelineno-55-45></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-55-46 name=__codelineno-55-46 href=#__codelineno-55-46></a><span class=w>  </span><span class=nt>selector</span><span class=p>:</span>
<a id=__codelineno-55-47 name=__codelineno-55-47 href=#__codelineno-55-47></a><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api</span><span class=w>                          </span><span class=c1># Conecta con pods del Deployment.</span>
<a id=__codelineno-55-48 name=__codelineno-55-48 href=#__codelineno-55-48></a><span class=w>  </span><span class=nt>ports</span><span class=p>:</span>
<a id=__codelineno-55-49 name=__codelineno-55-49 href=#__codelineno-55-49></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class=w>                                    </span><span class=c1># Puerto externo.</span>
<a id=__codelineno-55-50 name=__codelineno-55-50 href=#__codelineno-55-50></a><span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8000</span><span class=w>                            </span><span class=c1># Puerto del contenedor.</span>
<a id=__codelineno-55-51 name=__codelineno-55-51 href=#__codelineno-55-51></a><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span><span class=w>                            </span><span class=c1># Expone externamente con LB.</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>deployment.yaml<span class=w>                </span><span class=c1># Aplica configuraci√≥n.</span>
<a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>kubectl<span class=w> </span>get<span class=w> </span>pods<span class=w>                                </span><span class=c1># Lista pods.</span>
<a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a>kubectl<span class=w> </span>logs<span class=w> </span>-f<span class=w> </span>deployment/bankchurn-api<span class=w>        </span><span class=c1># Ver logs en tiempo real.</span>
</code></pre></div> <hr> <h2 id=pregunta-50-horizontal-pod-autoscaler>Pregunta 50: Horizontal Pod Autoscaler<a class=headerlink href=#pregunta-50-horizontal-pod-autoscaler title="Permanent link">&para;</a></h2> <p><strong>¬øC√≥mo escalas autom√°ticamente?</strong></p> <h3 id=respuesta_49>Respuesta:<a class=headerlink href=#respuesta_49 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=c1># hpa.yaml</span>
<a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling/v2</span>
<a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">HorizontalPodAutoscaler</span><span class=w>                   </span><span class=c1># Autoescalador horizontal.</span>
<a id=__codelineno-57-4 name=__codelineno-57-4 href=#__codelineno-57-4></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-57-5 name=__codelineno-57-5 href=#__codelineno-57-5></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api-hpa</span>
<a id=__codelineno-57-6 name=__codelineno-57-6 href=#__codelineno-57-6></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-57-7 name=__codelineno-57-7 href=#__codelineno-57-7></a><span class=w>  </span><span class=nt>scaleTargetRef</span><span class=p>:</span><span class=w>                               </span><span class=c1># Deployment a escalar.</span>
<a id=__codelineno-57-8 name=__codelineno-57-8 href=#__codelineno-57-8></a><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id=__codelineno-57-9 name=__codelineno-57-9 href=#__codelineno-57-9></a><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id=__codelineno-57-10 name=__codelineno-57-10 href=#__codelineno-57-10></a><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">bankchurn-api</span>
<a id=__codelineno-57-11 name=__codelineno-57-11 href=#__codelineno-57-11></a><span class=w>  </span><span class=nt>minReplicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class=w>                                </span><span class=c1># M√≠nimo 2 pods.</span>
<a id=__codelineno-57-12 name=__codelineno-57-12 href=#__codelineno-57-12></a><span class=w>  </span><span class=nt>maxReplicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class=w>                               </span><span class=c1># M√°ximo 10 pods.</span>
<a id=__codelineno-57-13 name=__codelineno-57-13 href=#__codelineno-57-13></a><span class=w>  </span><span class=nt>metrics</span><span class=p>:</span>
<a id=__codelineno-57-14 name=__codelineno-57-14 href=#__codelineno-57-14></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Resource</span>
<a id=__codelineno-57-15 name=__codelineno-57-15 href=#__codelineno-57-15></a><span class=w>    </span><span class=nt>resource</span><span class=p>:</span>
<a id=__codelineno-57-16 name=__codelineno-57-16 href=#__codelineno-57-16></a><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cpu</span>
<a id=__codelineno-57-17 name=__codelineno-57-17 href=#__codelineno-57-17></a><span class=w>      </span><span class=nt>target</span><span class=p>:</span>
<a id=__codelineno-57-18 name=__codelineno-57-18 href=#__codelineno-57-18></a><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Utilization</span>
<a id=__codelineno-57-19 name=__codelineno-57-19 href=#__codelineno-57-19></a><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">70</span><span class=w>                  </span><span class=c1># Escala si CPU &gt; 70%.</span>
<a id=__codelineno-57-20 name=__codelineno-57-20 href=#__codelineno-57-20></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Resource</span>
<a id=__codelineno-57-21 name=__codelineno-57-21 href=#__codelineno-57-21></a><span class=w>    </span><span class=nt>resource</span><span class=p>:</span>
<a id=__codelineno-57-22 name=__codelineno-57-22 href=#__codelineno-57-22></a><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">memory</span>
<a id=__codelineno-57-23 name=__codelineno-57-23 href=#__codelineno-57-23></a><span class=w>      </span><span class=nt>target</span><span class=p>:</span>
<a id=__codelineno-57-24 name=__codelineno-57-24 href=#__codelineno-57-24></a><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Utilization</span>
<a id=__codelineno-57-25 name=__codelineno-57-25 href=#__codelineno-57-25></a><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class=w>                  </span><span class=c1># Escala si memoria &gt; 80%.</span>
<a id=__codelineno-57-26 name=__codelineno-57-26 href=#__codelineno-57-26></a><span class=w>  </span><span class=nt>behavior</span><span class=p>:</span>
<a id=__codelineno-57-27 name=__codelineno-57-27 href=#__codelineno-57-27></a><span class=w>    </span><span class=nt>scaleDown</span><span class=p>:</span>
<a id=__codelineno-57-28 name=__codelineno-57-28 href=#__codelineno-57-28></a><span class=w>      </span><span class=nt>stabilizationWindowSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">300</span><span class=w>           </span><span class=c1># Espera 5 min antes de reducir.</span>
<a id=__codelineno-57-29 name=__codelineno-57-29 href=#__codelineno-57-29></a><span class=w>    </span><span class=nt>scaleUp</span><span class=p>:</span>
<a id=__codelineno-57-30 name=__codelineno-57-30 href=#__codelineno-57-30></a><span class=w>      </span><span class=nt>stabilizationWindowSeconds</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class=w>            </span><span class=c1># Escala up m√°s r√°pido (1 min).</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>hpa.yaml<span class=w>                       </span><span class=c1># Aplica HPA.</span>
<a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>kubectl<span class=w> </span>get<span class=w> </span>hpa<span class=w>                                 </span><span class=c1># Ver estado del autoescalador.</span>
<a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a><span class=c1># NAME                  REFERENCE              TARGETS   MINPODS   MAXPODS   REPLICAS</span>
<a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a><span class=c1># bankchurn-api-hpa     Deployment/bankchurn   45%/70%   2         10        3  # 45% actual, 70% target.</span>
</code></pre></div> <hr> <h1 id=5-escenarios-pr√°cticos-preguntas-51-60>5. Escenarios Pr√°cticos (Preguntas 51-60)<a class=headerlink href=#5-escenarios-pr√°cticos-preguntas-51-60 title="Permanent link">&para;</a></h1> <h2 id=pregunta-51-debug-de-produccion>Pregunta 51: Debug de Producci√≥n<a class=headerlink href=#pregunta-51-debug-de-produccion title="Permanent link">&para;</a></h2> <p><strong>El modelo tiene accuracy 85% en dev pero 60% en prod. ¬øPor qu√©?</strong></p> <h3 id=respuesta_50>Respuesta:<a class=headerlink href=#respuesta_50 title="Permanent link">&para;</a></h3> <ol> <li><strong>Data drift</strong>: Distribuci√≥n de datos cambi√≥</li> <li><strong>Feature mismatch</strong>: Features procesadas diferente</li> <li><strong>Training-serving skew</strong>: Preprocesamiento distinto</li> <li><strong>Datos de prod con m√°s ruido</strong>: Edge cases no vistos</li> </ol> <p><strong>Acciones</strong>: Comparar distribuciones, revisar pipeline, logging de inputs.</p> <hr> <h2 id=pregunta-52-code-review>Pregunta 52: Code Review<a class=headerlink href=#pregunta-52-code-review title="Permanent link">&para;</a></h2> <p><strong>¬øQu√© buscas en un code review de ML?</strong></p> <h3 id=respuesta_51>Respuesta:<a class=headerlink href=#respuesta_51 title="Permanent link">&para;</a></h3> <ul> <li>[ ] Data leakage en split/preprocessing</li> <li>[ ] Tests para features y modelo</li> <li>[ ] Config externalizada (no hardcoded)</li> <li>[ ] Type hints y docstrings</li> <li>[ ] Reproducibilidad (seeds, versiones)</li> <li>[ ] Logging apropiado</li> </ul> <hr> <h2 id=pregunta-53-explicabilidad-del-modelo>Pregunta 53: Explicabilidad del Modelo<a class=headerlink href=#pregunta-53-explicabilidad-del-modelo title="Permanent link">&para;</a></h2> <p><strong>El cliente dice: "No puedo usar tu modelo si no me explicas por qu√© toma las decisiones".</strong></p> <h3 id=respuesta_52>Respuesta:<a class=headerlink href=#respuesta_52 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=kn>import</span><span class=w> </span><span class=nn>shap</span>
<a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a>
<a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a><span class=c1># 1. SHAP para explicaciones individuales</span>
<a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a><span class=n>explainer</span> <span class=o>=</span> <span class=n>shap</span><span class=o>.</span><span class=n>TreeExplainer</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>         <span class=c1># Explainer para modelos de √°rboles.</span>
<a id=__codelineno-59-5 name=__codelineno-59-5 href=#__codelineno-59-5></a><span class=n>shap_values</span> <span class=o>=</span> <span class=n>explainer</span><span class=o>.</span><span class=n>shap_values</span><span class=p>(</span><span class=n>X_sample</span><span class=p>)</span> <span class=c1># Calcula contribuci√≥n de cada feature.</span>
<a id=__codelineno-59-6 name=__codelineno-59-6 href=#__codelineno-59-6></a>
<a id=__codelineno-59-7 name=__codelineno-59-7 href=#__codelineno-59-7></a><span class=c1># Waterfall plot para una predicci√≥n</span>
<a id=__codelineno-59-8 name=__codelineno-59-8 href=#__codelineno-59-8></a><span class=n>shap</span><span class=o>.</span><span class=n>waterfall_plot</span><span class=p>(</span><span class=n>shap</span><span class=o>.</span><span class=n>Explanation</span><span class=p>(</span>         <span class=c1># Visualiza contribuciones.</span>
<a id=__codelineno-59-9 name=__codelineno-59-9 href=#__codelineno-59-9></a>    <span class=n>values</span><span class=o>=</span><span class=n>shap_values</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>                    <span class=c1># Valores SHAP de una predicci√≥n.</span>
<a id=__codelineno-59-10 name=__codelineno-59-10 href=#__codelineno-59-10></a>    <span class=n>base_values</span><span class=o>=</span><span class=n>explainer</span><span class=o>.</span><span class=n>expected_value</span><span class=p>,</span>     <span class=c1># Valor base (promedio).</span>
<a id=__codelineno-59-11 name=__codelineno-59-11 href=#__codelineno-59-11></a>    <span class=n>data</span><span class=o>=</span><span class=n>X_sample</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>                     <span class=c1># Valores reales de features.</span>
<a id=__codelineno-59-12 name=__codelineno-59-12 href=#__codelineno-59-12></a><span class=p>))</span>
<a id=__codelineno-59-13 name=__codelineno-59-13 href=#__codelineno-59-13></a>
<a id=__codelineno-59-14 name=__codelineno-59-14 href=#__codelineno-59-14></a><span class=c1># 2. Feature importance global</span>
<a id=__codelineno-59-15 name=__codelineno-59-15 href=#__codelineno-59-15></a><span class=n>shap</span><span class=o>.</span><span class=n>summary_plot</span><span class=p>(</span><span class=n>shap_values</span><span class=p>,</span> <span class=n>X_sample</span><span class=p>)</span>      <span class=c1># Resumen de todas las predicciones.</span>
<a id=__codelineno-59-16 name=__codelineno-59-16 href=#__codelineno-59-16></a>
<a id=__codelineno-59-17 name=__codelineno-59-17 href=#__codelineno-59-17></a><span class=c1># 3. En producci√≥n: incluir en respuesta</span>
<a id=__codelineno-59-18 name=__codelineno-59-18 href=#__codelineno-59-18></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict&quot;</span><span class=p>)</span>
<a id=__codelineno-59-19 name=__codelineno-59-19 href=#__codelineno-59-19></a><span class=k>def</span><span class=w> </span><span class=nf>predict</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>Input</span><span class=p>):</span>
<a id=__codelineno-59-20 name=__codelineno-59-20 href=#__codelineno-59-20></a>    <span class=n>pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-59-21 name=__codelineno-59-21 href=#__codelineno-59-21></a>
<a id=__codelineno-59-22 name=__codelineno-59-22 href=#__codelineno-59-22></a>    <span class=c1># Top 3 razones</span>
<a id=__codelineno-59-23 name=__codelineno-59-23 href=#__codelineno-59-23></a>    <span class=n>shap_vals</span> <span class=o>=</span> <span class=n>explainer</span><span class=o>.</span><span class=n>shap_values</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<a id=__codelineno-59-24 name=__codelineno-59-24 href=#__codelineno-59-24></a>    <span class=n>top_features</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span>                    <span class=c1># Ordena por impacto.</span>
<a id=__codelineno-59-25 name=__codelineno-59-25 href=#__codelineno-59-25></a>        <span class=nb>zip</span><span class=p>(</span><span class=n>feature_names</span><span class=p>,</span> <span class=n>shap_vals</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span>
<a id=__codelineno-59-26 name=__codelineno-59-26 href=#__codelineno-59-26></a>        <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>abs</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span>              <span class=c1># Valor absoluto del impacto.</span>
<a id=__codelineno-59-27 name=__codelineno-59-27 href=#__codelineno-59-27></a>        <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span>
<a id=__codelineno-59-28 name=__codelineno-59-28 href=#__codelineno-59-28></a>    <span class=p>)[:</span><span class=mi>3</span><span class=p>]</span>                                     <span class=c1># Solo top 3.</span>
<a id=__codelineno-59-29 name=__codelineno-59-29 href=#__codelineno-59-29></a>
<a id=__codelineno-59-30 name=__codelineno-59-30 href=#__codelineno-59-30></a>    <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-59-31 name=__codelineno-59-31 href=#__codelineno-59-31></a>        <span class=s2>&quot;prediction&quot;</span><span class=p>:</span> <span class=n>pred</span><span class=p>,</span>
<a id=__codelineno-59-32 name=__codelineno-59-32 href=#__codelineno-59-32></a>        <span class=s2>&quot;explanation&quot;</span><span class=p>:</span> <span class=p>[</span>                      <span class=c1># Explicaci√≥n en respuesta.</span>
<a id=__codelineno-59-33 name=__codelineno-59-33 href=#__codelineno-59-33></a>            <span class=p>{</span><span class=s2>&quot;feature&quot;</span><span class=p>:</span> <span class=n>f</span><span class=p>,</span> <span class=s2>&quot;impact&quot;</span><span class=p>:</span> <span class=n>v</span><span class=p>}</span> 
<a id=__codelineno-59-34 name=__codelineno-59-34 href=#__codelineno-59-34></a>            <span class=k>for</span> <span class=n>f</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>top_features</span>
<a id=__codelineno-59-35 name=__codelineno-59-35 href=#__codelineno-59-35></a>        <span class=p>]</span>
<a id=__codelineno-59-36 name=__codelineno-59-36 href=#__codelineno-59-36></a>    <span class=p>}</span>
</code></pre></div> <hr> <h2 id=pregunta-54-optimizacion-de-latencia>Pregunta 54: Optimizaci√≥n de Latencia<a class=headerlink href=#pregunta-54-optimizacion-de-latencia title="Permanent link">&para;</a></h2> <p><strong>El modelo tarda 500ms por predicci√≥n. El negocio necesita &lt;100ms.</strong></p> <h3 id=respuesta_53>Respuesta:<a class=headerlink href=#respuesta_53 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=c1># 1. Profiling: ¬ød√≥nde est√° el cuello de botella?</span>
<a id=__codelineno-60-2 name=__codelineno-60-2 href=#__codelineno-60-2></a><span class=kn>import</span><span class=w> </span><span class=nn>cProfile</span>
<a id=__codelineno-60-3 name=__codelineno-60-3 href=#__codelineno-60-3></a><span class=n>cProfile</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=s1>&#39;model.predict(X_sample)&#39;</span><span class=p>)</span>       <span class=c1># Identifica funciones lentas.</span>
<a id=__codelineno-60-4 name=__codelineno-60-4 href=#__codelineno-60-4></a>
<a id=__codelineno-60-5 name=__codelineno-60-5 href=#__codelineno-60-5></a><span class=c1># 2. Opciones de optimizaci√≥n:</span>
<a id=__codelineno-60-6 name=__codelineno-60-6 href=#__codelineno-60-6></a>
<a id=__codelineno-60-7 name=__codelineno-60-7 href=#__codelineno-60-7></a><span class=c1># a) Modelo m√°s ligero</span>
<a id=__codelineno-60-8 name=__codelineno-60-8 href=#__codelineno-60-8></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>  <span class=c1># LR es 10x m√°s r√°pido que RF.</span>
<a id=__codelineno-60-9 name=__codelineno-60-9 href=#__codelineno-60-9></a>
<a id=__codelineno-60-10 name=__codelineno-60-10 href=#__codelineno-60-10></a><span class=c1># b) Reducir features</span>
<a id=__codelineno-60-11 name=__codelineno-60-11 href=#__codelineno-60-11></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>SelectKBest</span>
<a id=__codelineno-60-12 name=__codelineno-60-12 href=#__codelineno-60-12></a><span class=n>selector</span> <span class=o>=</span> <span class=n>SelectKBest</span><span class=p>(</span><span class=n>k</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>                  <span class=c1># Solo top 10 features = menos c√°lculo.</span>
<a id=__codelineno-60-13 name=__codelineno-60-13 href=#__codelineno-60-13></a>
<a id=__codelineno-60-14 name=__codelineno-60-14 href=#__codelineno-60-14></a><span class=c1># c) Batch predictions</span>
<a id=__codelineno-60-15 name=__codelineno-60-15 href=#__codelineno-60-15></a><span class=nd>@app</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&quot;/predict/batch&quot;</span><span class=p>)</span>
<a id=__codelineno-60-16 name=__codelineno-60-16 href=#__codelineno-60-16></a><span class=k>def</span><span class=w> </span><span class=nf>predict_batch</span><span class=p>(</span><span class=n>items</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Input</span><span class=p>]):</span>
<a id=__codelineno-60-17 name=__codelineno-60-17 href=#__codelineno-60-17></a>    <span class=n>X</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span><span class=n>item</span><span class=o>.</span><span class=n>dict</span><span class=p>()</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>items</span><span class=p>])</span>
<a id=__codelineno-60-18 name=__codelineno-60-18 href=#__codelineno-60-18></a>    <span class=n>preds</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>                  <span class=c1># Una llamada = menos overhead.</span>
<a id=__codelineno-60-19 name=__codelineno-60-19 href=#__codelineno-60-19></a>    <span class=k>return</span> <span class=p>{</span><span class=s2>&quot;predictions&quot;</span><span class=p>:</span> <span class=n>preds</span><span class=o>.</span><span class=n>tolist</span><span class=p>()}</span>
<a id=__codelineno-60-20 name=__codelineno-60-20 href=#__codelineno-60-20></a>
<a id=__codelineno-60-21 name=__codelineno-60-21 href=#__codelineno-60-21></a><span class=c1># d) Caching de predicciones frecuentes</span>
<a id=__codelineno-60-22 name=__codelineno-60-22 href=#__codelineno-60-22></a><span class=kn>from</span><span class=w> </span><span class=nn>functools</span><span class=w> </span><span class=kn>import</span> <span class=n>lru_cache</span>
<a id=__codelineno-60-23 name=__codelineno-60-23 href=#__codelineno-60-23></a>
<a id=__codelineno-60-24 name=__codelineno-60-24 href=#__codelineno-60-24></a><span class=nd>@lru_cache</span><span class=p>(</span><span class=n>maxsize</span><span class=o>=</span><span class=mi>1000</span><span class=p>)</span>                      <span class=c1># Cache √∫ltimas 1000 predicciones.</span>
<a id=__codelineno-60-25 name=__codelineno-60-25 href=#__codelineno-60-25></a><span class=k>def</span><span class=w> </span><span class=nf>predict_cached</span><span class=p>(</span><span class=n>credit_score</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>age</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
<a id=__codelineno-60-26 name=__codelineno-60-26 href=#__codelineno-60-26></a>    <span class=k>return</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>([[</span><span class=n>credit_score</span><span class=p>,</span> <span class=n>age</span><span class=p>]])[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># Cache hit = instant√°neo.</span>
<a id=__codelineno-60-27 name=__codelineno-60-27 href=#__codelineno-60-27></a>
<a id=__codelineno-60-28 name=__codelineno-60-28 href=#__codelineno-60-28></a><span class=c1># e) ONNX para inferencia r√°pida</span>
<a id=__codelineno-60-29 name=__codelineno-60-29 href=#__codelineno-60-29></a><span class=kn>from</span><span class=w> </span><span class=nn>skl2onnx</span><span class=w> </span><span class=kn>import</span> <span class=n>convert_sklearn</span>          <span class=c1># Convierte a formato optimizado.</span>
<a id=__codelineno-60-30 name=__codelineno-60-30 href=#__codelineno-60-30></a><span class=n>onnx_model</span> <span class=o>=</span> <span class=n>convert_sklearn</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>initial_types</span><span class=o>=</span><span class=p>[</span><span class=o>...</span><span class=p>])</span>  <span class=c1># Runtime m√°s r√°pido.</span>
</code></pre></div> <p><strong>M√©tricas de latencia</strong>: | Optimizaci√≥n | Latencia t√≠pica | |--------------|-----------------| | RF sklearn | 50-200ms | | LR sklearn | 1-5ms | | ONNX | 1-10ms | | Caching (hit) | &lt;1ms |</p> <hr> <h2 id=pregunta-55-manejo-de-pii>Pregunta 55: Manejo de PII<a class=headerlink href=#pregunta-55-manejo-de-pii title="Permanent link">&para;</a></h2> <p><strong>El dataset contiene nombres, emails y tel√©fonos. ¬øC√≥mo lo manejas?</strong></p> <h3 id=respuesta_54>Respuesta:<a class=headerlink href=#respuesta_54 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=c1># 1. Identificar columnas PII</span>
<a id=__codelineno-61-2 name=__codelineno-61-2 href=#__codelineno-61-2></a><span class=n>pii_columns</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>,</span> <span class=s2>&quot;email&quot;</span><span class=p>,</span> <span class=s2>&quot;phone&quot;</span><span class=p>,</span> <span class=s2>&quot;ssn&quot;</span><span class=p>,</span> <span class=s2>&quot;address&quot;</span><span class=p>]</span>  <span class=c1># Datos sensibles.</span>
<a id=__codelineno-61-3 name=__codelineno-61-3 href=#__codelineno-61-3></a>
<a id=__codelineno-61-4 name=__codelineno-61-4 href=#__codelineno-61-4></a><span class=c1># 2. Anonimizaci√≥n</span>
<a id=__codelineno-61-5 name=__codelineno-61-5 href=#__codelineno-61-5></a><span class=kn>import</span><span class=w> </span><span class=nn>hashlib</span>
<a id=__codelineno-61-6 name=__codelineno-61-6 href=#__codelineno-61-6></a>
<a id=__codelineno-61-7 name=__codelineno-61-7 href=#__codelineno-61-7></a><span class=k>def</span><span class=w> </span><span class=nf>anonymize_pii</span><span class=p>(</span><span class=n>df</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<a id=__codelineno-61-8 name=__codelineno-61-8 href=#__codelineno-61-8></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-61-9 name=__codelineno-61-9 href=#__codelineno-61-9></a>    <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>pii_columns</span><span class=p>:</span>
<a id=__codelineno-61-10 name=__codelineno-61-10 href=#__codelineno-61-10></a>        <span class=k>if</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-61-11 name=__codelineno-61-11 href=#__codelineno-61-11></a>            <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span>          <span class=c1># Hash irreversible.</span>
<a id=__codelineno-61-12 name=__codelineno-61-12 href=#__codelineno-61-12></a>                <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()[:</span><span class=mi>16</span><span class=p>]</span>
<a id=__codelineno-61-13 name=__codelineno-61-13 href=#__codelineno-61-13></a>            <span class=p>)</span>                                 <span class=c1># No se puede revertir.</span>
<a id=__codelineno-61-14 name=__codelineno-61-14 href=#__codelineno-61-14></a>    <span class=k>return</span> <span class=n>df</span>
<a id=__codelineno-61-15 name=__codelineno-61-15 href=#__codelineno-61-15></a>
<a id=__codelineno-61-16 name=__codelineno-61-16 href=#__codelineno-61-16></a><span class=c1># 3. Drop antes de training (mejor opci√≥n)</span>
<a id=__codelineno-61-17 name=__codelineno-61-17 href=#__codelineno-61-17></a><span class=n>X</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>pii_columns</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;ignore&#39;</span><span class=p>)</span>  <span class=c1># Elimina PII del modelo.</span>
<a id=__codelineno-61-18 name=__codelineno-61-18 href=#__codelineno-61-18></a>
<a id=__codelineno-61-19 name=__codelineno-61-19 href=#__codelineno-61-19></a><span class=c1># 4. En logs: nunca loggear PII</span>
<a id=__codelineno-61-20 name=__codelineno-61-20 href=#__codelineno-61-20></a><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Prediction for customer </span><span class=si>{</span><span class=n>customer_id</span><span class=p>[:</span><span class=mi>4</span><span class=p>]</span><span class=si>}</span><span class=s2>***&quot;</span><span class=p>)</span>  <span class=c1># Mascara ID.</span>
<a id=__codelineno-61-21 name=__codelineno-61-21 href=#__codelineno-61-21></a>
<a id=__codelineno-61-22 name=__codelineno-61-22 href=#__codelineno-61-22></a><span class=c1># 5. En respuestas de API: mascarar</span>
<a id=__codelineno-61-23 name=__codelineno-61-23 href=#__codelineno-61-23></a><span class=k>def</span><span class=w> </span><span class=nf>mask_email</span><span class=p>(</span><span class=n>email</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-61-24 name=__codelineno-61-24 href=#__codelineno-61-24></a>    <span class=n>parts</span> <span class=o>=</span> <span class=n>email</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;@&quot;</span><span class=p>)</span>
<a id=__codelineno-61-25 name=__codelineno-61-25 href=#__codelineno-61-25></a>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>parts</span><span class=p>[</span><span class=mi>0</span><span class=p>][:</span><span class=mi>2</span><span class=p>]</span><span class=si>}</span><span class=s2>***@</span><span class=si>{</span><span class=n>parts</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>   <span class=c1># jo***@gmail.com.</span>
</code></pre></div> <p><strong>Compliance checklist</strong>: - [ ] PII no est√° en features del modelo - [ ] PII no aparece en logs - [ ] PII no se almacena en MLflow/tracking - [ ] Acceso a datos restringido</p> <hr> <h2 id=pregunta-56-fairness-y-bias>Pregunta 56: Fairness y Bias<a class=headerlink href=#pregunta-56-fairness-y-bias title="Permanent link">&para;</a></h2> <p><strong>Producto detect√≥ que el modelo rechaza m√°s a clientes de cierta regi√≥n.</strong></p> <h3 id=respuesta_55>Respuesta:<a class=headerlink href=#respuesta_55 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a><span class=kn>from</span><span class=w> </span><span class=nn>fairlearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>MetricFrame</span>      <span class=c1># Fairlearn: librer√≠a de fairness.</span>
<a id=__codelineno-62-2 name=__codelineno-62-2 href=#__codelineno-62-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>recall_score</span>
<a id=__codelineno-62-3 name=__codelineno-62-3 href=#__codelineno-62-3></a>
<a id=__codelineno-62-4 name=__codelineno-62-4 href=#__codelineno-62-4></a><span class=c1># 1. Calcular m√©tricas por grupo</span>
<a id=__codelineno-62-5 name=__codelineno-62-5 href=#__codelineno-62-5></a><span class=n>metrics</span> <span class=o>=</span> <span class=n>MetricFrame</span><span class=p>(</span>
<a id=__codelineno-62-6 name=__codelineno-62-6 href=#__codelineno-62-6></a>    <span class=n>metrics</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-62-7 name=__codelineno-62-7 href=#__codelineno-62-7></a>        <span class=s2>&quot;accuracy&quot;</span><span class=p>:</span> <span class=n>accuracy_score</span><span class=p>,</span>
<a id=__codelineno-62-8 name=__codelineno-62-8 href=#__codelineno-62-8></a>        <span class=s2>&quot;recall&quot;</span><span class=p>:</span> <span class=n>recall_score</span>
<a id=__codelineno-62-9 name=__codelineno-62-9 href=#__codelineno-62-9></a>    <span class=p>},</span>
<a id=__codelineno-62-10 name=__codelineno-62-10 href=#__codelineno-62-10></a>    <span class=n>y_true</span><span class=o>=</span><span class=n>y_test</span><span class=p>,</span>
<a id=__codelineno-62-11 name=__codelineno-62-11 href=#__codelineno-62-11></a>    <span class=n>y_pred</span><span class=o>=</span><span class=n>y_pred</span><span class=p>,</span>
<a id=__codelineno-62-12 name=__codelineno-62-12 href=#__codelineno-62-12></a>    <span class=n>sensitive_features</span><span class=o>=</span><span class=n>df_test</span><span class=p>[</span><span class=s2>&quot;geography&quot;</span><span class=p>]</span>   <span class=c1># Variable sensible.</span>
<a id=__codelineno-62-13 name=__codelineno-62-13 href=#__codelineno-62-13></a><span class=p>)</span>
<a id=__codelineno-62-14 name=__codelineno-62-14 href=#__codelineno-62-14></a>
<a id=__codelineno-62-15 name=__codelineno-62-15 href=#__codelineno-62-15></a><span class=nb>print</span><span class=p>(</span><span class=n>metrics</span><span class=o>.</span><span class=n>by_group</span><span class=p>)</span>                        <span class=c1># M√©tricas por grupo.</span>
<a id=__codelineno-62-16 name=__codelineno-62-16 href=#__codelineno-62-16></a><span class=c1>#              accuracy  recall</span>
<a id=__codelineno-62-17 name=__codelineno-62-17 href=#__codelineno-62-17></a><span class=c1># geography</span>
<a id=__codelineno-62-18 name=__codelineno-62-18 href=#__codelineno-62-18></a><span class=c1># France         0.85     0.80</span>
<a id=__codelineno-62-19 name=__codelineno-62-19 href=#__codelineno-62-19></a><span class=c1># Germany        0.83     0.78</span>
<a id=__codelineno-62-20 name=__codelineno-62-20 href=#__codelineno-62-20></a><span class=c1># Spain          0.70     0.55                 # ‚Üê Problema: peor para Spain.</span>
<a id=__codelineno-62-21 name=__codelineno-62-21 href=#__codelineno-62-21></a>
<a id=__codelineno-62-22 name=__codelineno-62-22 href=#__codelineno-62-22></a><span class=c1># 2. Mitigaci√≥n</span>
<a id=__codelineno-62-23 name=__codelineno-62-23 href=#__codelineno-62-23></a><span class=kn>from</span><span class=w> </span><span class=nn>fairlearn.reductions</span><span class=w> </span><span class=kn>import</span> <span class=n>ExponentiatedGradient</span>  <span class=c1># Algoritmo de mitigaci√≥n.</span>
<a id=__codelineno-62-24 name=__codelineno-62-24 href=#__codelineno-62-24></a><span class=kn>from</span><span class=w> </span><span class=nn>fairlearn.constraints</span><span class=w> </span><span class=kn>import</span> <span class=n>DemographicParity</span>     <span class=c1># Restricci√≥n de fairness.</span>
<a id=__codelineno-62-25 name=__codelineno-62-25 href=#__codelineno-62-25></a>
<a id=__codelineno-62-26 name=__codelineno-62-26 href=#__codelineno-62-26></a><span class=n>mitigator</span> <span class=o>=</span> <span class=n>ExponentiatedGradient</span><span class=p>(</span>
<a id=__codelineno-62-27 name=__codelineno-62-27 href=#__codelineno-62-27></a>    <span class=n>estimator</span><span class=o>=</span><span class=n>base_model</span><span class=p>,</span>
<a id=__codelineno-62-28 name=__codelineno-62-28 href=#__codelineno-62-28></a>    <span class=n>constraints</span><span class=o>=</span><span class=n>DemographicParity</span><span class=p>()</span>            <span class=c1># Igualar tasas entre grupos.</span>
<a id=__codelineno-62-29 name=__codelineno-62-29 href=#__codelineno-62-29></a><span class=p>)</span>
<a id=__codelineno-62-30 name=__codelineno-62-30 href=#__codelineno-62-30></a><span class=n>mitigator</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>sensitive_features</span><span class=o>=</span><span class=n>train_geography</span><span class=p>)</span>
<a id=__codelineno-62-31 name=__codelineno-62-31 href=#__codelineno-62-31></a>
<a id=__codelineno-62-32 name=__codelineno-62-32 href=#__codelineno-62-32></a><span class=c1># 3. Monitoreo continuo</span>
<a id=__codelineno-62-33 name=__codelineno-62-33 href=#__codelineno-62-33></a><span class=c1># Alertar si la diferencia entre grupos &gt; 10%  # Dashboard de fairness.</span>
</code></pre></div> <hr> <h2 id=pregunta-57-tests-flaky-en-ci>Pregunta 57: Tests Flaky en CI<a class=headerlink href=#pregunta-57-tests-flaky-en-ci title="Permanent link">&para;</a></h2> <p><strong>El CI pasa 80% de las veces y falla 20% sin cambios en c√≥digo.</strong></p> <h3 id=respuesta_56>Respuesta:<a class=headerlink href=#respuesta_56 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=c1># 1. Problema com√∫n: Random sin seed</span>
<a id=__codelineno-63-2 name=__codelineno-63-2 href=#__codelineno-63-2></a><span class=c1># ‚ùå Mal</span>
<a id=__codelineno-63-3 name=__codelineno-63-3 href=#__codelineno-63-3></a><span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>()</span>              <span class=c1># Sin seed: resultados diferentes cada vez.</span>
<a id=__codelineno-63-4 name=__codelineno-63-4 href=#__codelineno-63-4></a>
<a id=__codelineno-63-5 name=__codelineno-63-5 href=#__codelineno-63-5></a><span class=c1># ‚úÖ Bien</span>
<a id=__codelineno-63-6 name=__codelineno-63-6 href=#__codelineno-63-6></a><span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>  <span class=c1># Seed fija: resultados reproducibles.</span>
<a id=__codelineno-63-7 name=__codelineno-63-7 href=#__codelineno-63-7></a>
<a id=__codelineno-63-8 name=__codelineno-63-8 href=#__codelineno-63-8></a><span class=c1># 2. Problema: Orden de ejecuci√≥n</span>
<a id=__codelineno-63-9 name=__codelineno-63-9 href=#__codelineno-63-9></a><span class=c1># ‚ùå Mal: test depende de otro</span>
<a id=__codelineno-63-10 name=__codelineno-63-10 href=#__codelineno-63-10></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict</span><span class=p>():</span>
<a id=__codelineno-63-11 name=__codelineno-63-11 href=#__codelineno-63-11></a>    <span class=k>assert</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span> <span class=o>==</span> <span class=p>[</span><span class=mi>1</span><span class=p>]</span>            <span class=c1># model de test anterior: dependencia oculta.</span>
<a id=__codelineno-63-12 name=__codelineno-63-12 href=#__codelineno-63-12></a>
<a id=__codelineno-63-13 name=__codelineno-63-13 href=#__codelineno-63-13></a><span class=c1># ‚úÖ Bien: tests aislados</span>
<a id=__codelineno-63-14 name=__codelineno-63-14 href=#__codelineno-63-14></a><span class=nd>@pytest</span><span class=o>.</span><span class=n>fixture</span>
<a id=__codelineno-63-15 name=__codelineno-63-15 href=#__codelineno-63-15></a><span class=k>def</span><span class=w> </span><span class=nf>trained_model</span><span class=p>():</span>                          <span class=c1># Fixture crea modelo fresco.</span>
<a id=__codelineno-63-16 name=__codelineno-63-16 href=#__codelineno-63-16></a>    <span class=n>m</span> <span class=o>=</span> <span class=n>Model</span><span class=p>()</span>
<a id=__codelineno-63-17 name=__codelineno-63-17 href=#__codelineno-63-17></a>    <span class=n>m</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-63-18 name=__codelineno-63-18 href=#__codelineno-63-18></a>    <span class=k>return</span> <span class=n>m</span>
<a id=__codelineno-63-19 name=__codelineno-63-19 href=#__codelineno-63-19></a>
<a id=__codelineno-63-20 name=__codelineno-63-20 href=#__codelineno-63-20></a><span class=k>def</span><span class=w> </span><span class=nf>test_predict</span><span class=p>(</span><span class=n>trained_model</span><span class=p>):</span>              <span class=c1># Test recibe su propio modelo.</span>
<a id=__codelineno-63-21 name=__codelineno-63-21 href=#__codelineno-63-21></a>    <span class=k>assert</span> <span class=n>trained_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<a id=__codelineno-63-22 name=__codelineno-63-22 href=#__codelineno-63-22></a>
<a id=__codelineno-63-23 name=__codelineno-63-23 href=#__codelineno-63-23></a><span class=c1># 3. Problema: Timeouts en CI</span>
<a id=__codelineno-63-24 name=__codelineno-63-24 href=#__codelineno-63-24></a><span class=c1># ‚ùå Mal</span>
<a id=__codelineno-63-25 name=__codelineno-63-25 href=#__codelineno-63-25></a><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://external-api.com&quot;</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>  <span class=c1># API externa puede fallar.</span>
<a id=__codelineno-63-26 name=__codelineno-63-26 href=#__codelineno-63-26></a>
<a id=__codelineno-63-27 name=__codelineno-63-27 href=#__codelineno-63-27></a><span class=c1># ‚úÖ Bien</span>
<a id=__codelineno-63-28 name=__codelineno-63-28 href=#__codelineno-63-28></a><span class=nd>@pytest</span><span class=o>.</span><span class=n>fixture</span>
<a id=__codelineno-63-29 name=__codelineno-63-29 href=#__codelineno-63-29></a><span class=k>def</span><span class=w> </span><span class=nf>mock_api</span><span class=p>():</span>                               <span class=c1># Mock evita llamadas externas.</span>
<a id=__codelineno-63-30 name=__codelineno-63-30 href=#__codelineno-63-30></a>    <span class=k>with</span> <span class=n>patch</span><span class=p>(</span><span class=s2>&quot;myapp.api.get&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>mock</span><span class=p>:</span>
<a id=__codelineno-63-31 name=__codelineno-63-31 href=#__codelineno-63-31></a>        <span class=n>mock</span><span class=o>.</span><span class=n>return_value</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;data&quot;</span><span class=p>:</span> <span class=s2>&quot;test&quot;</span><span class=p>}</span>
<a id=__codelineno-63-32 name=__codelineno-63-32 href=#__codelineno-63-32></a>        <span class=k>yield</span> <span class=n>mock</span>
<a id=__codelineno-63-33 name=__codelineno-63-33 href=#__codelineno-63-33></a>
<a id=__codelineno-63-34 name=__codelineno-63-34 href=#__codelineno-63-34></a><span class=c1># 4. Debug: Correr m√∫ltiples veces</span>
<a id=__codelineno-63-35 name=__codelineno-63-35 href=#__codelineno-63-35></a><span class=n>pytest</span> <span class=n>tests</span><span class=o>/</span> <span class=o>--</span><span class=n>count</span><span class=o>=</span><span class=mi>10</span>                      <span class=c1># pytest-repeat: detecta tests flaky.</span>
</code></pre></div> <hr> <h2 id=pregunta-58-modelo-grande-para-deploy>Pregunta 58: Modelo Grande para Deploy<a class=headerlink href=#pregunta-58-modelo-grande-para-deploy title="Permanent link">&para;</a></h2> <p><strong>El modelo pesa 2GB y tarda 30s en cargar. ¬øC√≥mo optimizas?</strong></p> <h3 id=respuesta_57>Respuesta:<a class=headerlink href=#respuesta_57 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=c1># 1. Quantization (reducir precisi√≥n)</span>
<a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a><span class=kn>import</span><span class=w> </span><span class=nn>onnxruntime</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>ort</span>
<a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a><span class=kn>from</span><span class=w> </span><span class=nn>onnxruntime.quantization</span><span class=w> </span><span class=kn>import</span> <span class=n>quantize_dynamic</span>
<a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a>
<a id=__codelineno-64-5 name=__codelineno-64-5 href=#__codelineno-64-5></a><span class=n>quantize_dynamic</span><span class=p>(</span>
<a id=__codelineno-64-6 name=__codelineno-64-6 href=#__codelineno-64-6></a>    <span class=s2>&quot;model.onnx&quot;</span><span class=p>,</span>
<a id=__codelineno-64-7 name=__codelineno-64-7 href=#__codelineno-64-7></a>    <span class=s2>&quot;model_quantized.onnx&quot;</span><span class=p>,</span>
<a id=__codelineno-64-8 name=__codelineno-64-8 href=#__codelineno-64-8></a>    <span class=n>weight_type</span><span class=o>=</span><span class=n>ort</span><span class=o>.</span><span class=n>QuantType</span><span class=o>.</span><span class=n>QInt8</span>             <span class=c1># 8-bit en vez de 32-bit.</span>
<a id=__codelineno-64-9 name=__codelineno-64-9 href=#__codelineno-64-9></a><span class=p>)</span>
<a id=__codelineno-64-10 name=__codelineno-64-10 href=#__codelineno-64-10></a><span class=c1># 2GB ‚Üí ~500MB                                  # 4x reducci√≥n de tama√±o.</span>
<a id=__codelineno-64-11 name=__codelineno-64-11 href=#__codelineno-64-11></a>
<a id=__codelineno-64-12 name=__codelineno-64-12 href=#__codelineno-64-12></a><span class=c1># 2. Model distillation (modelo m√°s peque√±o que imita al grande)</span>
<a id=__codelineno-64-13 name=__codelineno-64-13 href=#__codelineno-64-13></a><span class=n>teacher</span> <span class=o>=</span> <span class=n>load_large_model</span><span class=p>()</span>                    <span class=c1># Modelo grande y lento.</span>
<a id=__codelineno-64-14 name=__codelineno-64-14 href=#__codelineno-64-14></a><span class=n>student</span> <span class=o>=</span> <span class=n>SmallModel</span><span class=p>()</span>                          <span class=c1># Modelo peque√±o y r√°pido.</span>
<a id=__codelineno-64-15 name=__codelineno-64-15 href=#__codelineno-64-15></a>
<a id=__codelineno-64-16 name=__codelineno-64-16 href=#__codelineno-64-16></a><span class=c1># Entrenar student con outputs del teacher</span>
<a id=__codelineno-64-17 name=__codelineno-64-17 href=#__codelineno-64-17></a><span class=n>student_preds</span> <span class=o>=</span> <span class=n>student</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<a id=__codelineno-64-18 name=__codelineno-64-18 href=#__codelineno-64-18></a><span class=n>teacher_preds</span> <span class=o>=</span> <span class=n>teacher</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>                      <span class=c1># Student aprende a imitar teacher.</span>
<a id=__codelineno-64-19 name=__codelineno-64-19 href=#__codelineno-64-19></a><span class=n>loss</span> <span class=o>=</span> <span class=n>mse_loss</span><span class=p>(</span><span class=n>student_preds</span><span class=p>,</span> <span class=n>teacher_preds</span><span class=p>)</span>   <span class=c1># Minimiza diferencia.</span>
<a id=__codelineno-64-20 name=__codelineno-64-20 href=#__codelineno-64-20></a>
<a id=__codelineno-64-21 name=__codelineno-64-21 href=#__codelineno-64-21></a><span class=c1># 3. Feature selection (menos features = modelo m√°s peque√±o)</span>
<a id=__codelineno-64-22 name=__codelineno-64-22 href=#__codelineno-64-22></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.feature_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>SelectFromModel</span>
<a id=__codelineno-64-23 name=__codelineno-64-23 href=#__codelineno-64-23></a><span class=n>selector</span> <span class=o>=</span> <span class=n>SelectFromModel</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=s2>&quot;median&quot;</span><span class=p>)</span>  <span class=c1># Selecciona features importantes.</span>
<a id=__codelineno-64-24 name=__codelineno-64-24 href=#__codelineno-64-24></a><span class=n>X_reduced</span> <span class=o>=</span> <span class=n>selector</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>               <span class=c1># Menos columnas = modelo m√°s ligero.</span>
<a id=__codelineno-64-25 name=__codelineno-64-25 href=#__codelineno-64-25></a>
<a id=__codelineno-64-26 name=__codelineno-64-26 href=#__codelineno-64-26></a><span class=c1># 4. Lazy loading en API</span>
<a id=__codelineno-64-27 name=__codelineno-64-27 href=#__codelineno-64-27></a><span class=n>model</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-64-28 name=__codelineno-64-28 href=#__codelineno-64-28></a>
<a id=__codelineno-64-29 name=__codelineno-64-29 href=#__codelineno-64-29></a><span class=nd>@app</span><span class=o>.</span><span class=n>on_event</span><span class=p>(</span><span class=s2>&quot;startup&quot;</span><span class=p>)</span>                        <span class=c1># Carga al iniciar, no en cada request.</span>
<a id=__codelineno-64-30 name=__codelineno-64-30 href=#__codelineno-64-30></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>load</span><span class=p>():</span>
<a id=__codelineno-64-31 name=__codelineno-64-31 href=#__codelineno-64-31></a>    <span class=k>global</span> <span class=n>model</span>
<a id=__codelineno-64-32 name=__codelineno-64-32 href=#__codelineno-64-32></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>&quot;model.joblib&quot;</span><span class=p>)</span>         <span class=c1># Solo una vez, cacheado.</span>
</code></pre></div> <hr> <h2 id=pregunta-59-muchos-falsos-positivos>Pregunta 59: Muchos Falsos Positivos<a class=headerlink href=#pregunta-59-muchos-falsos-positivos title="Permanent link">&para;</a></h2> <p><strong>El modelo predice churn para clientes que claramente no van a irse.</strong></p> <h3 id=respuesta_58>Respuesta:<a class=headerlink href=#respuesta_58 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a><span class=c1># 1. Ajustar threshold (default=0.5)</span>
<a id=__codelineno-65-2 name=__codelineno-65-2 href=#__codelineno-65-2></a><span class=n>y_proba</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>     <span class=c1># Probabilidades de clase 1.</span>
<a id=__codelineno-65-3 name=__codelineno-65-3 href=#__codelineno-65-3></a>
<a id=__codelineno-65-4 name=__codelineno-65-4 href=#__codelineno-65-4></a><span class=c1># Encontrar threshold √≥ptimo</span>
<a id=__codelineno-65-5 name=__codelineno-65-5 href=#__codelineno-65-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>precision_recall_curve</span>
<a id=__codelineno-65-6 name=__codelineno-65-6 href=#__codelineno-65-6></a>
<a id=__codelineno-65-7 name=__codelineno-65-7 href=#__codelineno-65-7></a><span class=n>precision</span><span class=p>,</span> <span class=n>recall</span><span class=p>,</span> <span class=n>thresholds</span> <span class=o>=</span> <span class=n>precision_recall_curve</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>
<a id=__codelineno-65-8 name=__codelineno-65-8 href=#__codelineno-65-8></a>
<a id=__codelineno-65-9 name=__codelineno-65-9 href=#__codelineno-65-9></a><span class=c1># Threshold que maximiza F1</span>
<a id=__codelineno-65-10 name=__codelineno-65-10 href=#__codelineno-65-10></a><span class=n>f1_scores</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>*</span> <span class=p>(</span><span class=n>precision</span> <span class=o>*</span> <span class=n>recall</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>precision</span> <span class=o>+</span> <span class=n>recall</span><span class=p>)</span>  <span class=c1># F√≥rmula F1.</span>
<a id=__codelineno-65-11 name=__codelineno-65-11 href=#__codelineno-65-11></a><span class=n>optimal_threshold</span> <span class=o>=</span> <span class=n>thresholds</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>f1_scores</span><span class=p>)]</span>  <span class=c1># Mejor threshold.</span>
<a id=__codelineno-65-12 name=__codelineno-65-12 href=#__codelineno-65-12></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Optimal threshold: </span><span class=si>{</span><span class=n>optimal_threshold</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># Ej: 0.65 en vez de 0.5.</span>
<a id=__codelineno-65-13 name=__codelineno-65-13 href=#__codelineno-65-13></a>
<a id=__codelineno-65-14 name=__codelineno-65-14 href=#__codelineno-65-14></a><span class=c1># Usar nuevo threshold</span>
<a id=__codelineno-65-15 name=__codelineno-65-15 href=#__codelineno-65-15></a><span class=n>y_pred</span> <span class=o>=</span> <span class=p>(</span><span class=n>y_proba</span> <span class=o>&gt;=</span> <span class=n>optimal_threshold</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>  <span class=c1># Threshold m√°s alto = menos FP.</span>
<a id=__codelineno-65-16 name=__codelineno-65-16 href=#__codelineno-65-16></a>
<a id=__codelineno-65-17 name=__codelineno-65-17 href=#__codelineno-65-17></a><span class=c1># 2. Revisar balance de datos</span>
<a id=__codelineno-65-18 name=__codelineno-65-18 href=#__codelineno-65-18></a><span class=nb>print</span><span class=p>(</span><span class=n>y_train</span><span class=o>.</span><span class=n>value_counts</span><span class=p>(</span><span class=n>normalize</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>     <span class=c1># Ver proporciones de clases.</span>
<a id=__codelineno-65-19 name=__codelineno-65-19 href=#__codelineno-65-19></a><span class=c1># Si muy desbalanceado: SMOTE, class_weight     # T√©cnicas de balanceo.</span>
<a id=__codelineno-65-20 name=__codelineno-65-20 href=#__codelineno-65-20></a>
<a id=__codelineno-65-21 name=__codelineno-65-21 href=#__codelineno-65-21></a><span class=c1># 3. Verificar data leakage</span>
<a id=__codelineno-65-22 name=__codelineno-65-22 href=#__codelineno-65-22></a><span class=c1># ¬øHay features que &quot;predicen perfectamente&quot;?</span>
<a id=__codelineno-65-23 name=__codelineno-65-23 href=#__codelineno-65-23></a><span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
<a id=__codelineno-65-24 name=__codelineno-65-24 href=#__codelineno-65-24></a>    <span class=n>corr</span> <span class=o>=</span> <span class=n>X</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>corr</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
<a id=__codelineno-65-25 name=__codelineno-65-25 href=#__codelineno-65-25></a>    <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>corr</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>0.9</span><span class=p>:</span>                         <span class=c1># Correlaci√≥n sospechosa.</span>
<a id=__codelineno-65-26 name=__codelineno-65-26 href=#__codelineno-65-26></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;‚ö†Ô∏è </span><span class=si>{</span><span class=n>col</span><span class=si>}</span><span class=s2> tiene correlaci√≥n </span><span class=si>{</span><span class=n>corr</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># Posible leakage.</span>
</code></pre></div> <hr> <h2 id=pregunta-60-comunicar-a-stakeholders-no-tecnicos>Pregunta 60: Comunicar a Stakeholders No T√©cnicos<a class=headerlink href=#pregunta-60-comunicar-a-stakeholders-no-tecnicos title="Permanent link">&para;</a></h2> <p><strong>El VP de producto pregunta: "¬øFunciona o no funciona tu modelo?"</strong></p> <h3 id=respuesta_59>Respuesta:<a class=headerlink href=#respuesta_59 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a><span class=c1># 1. Traducir m√©tricas t√©cnicas a impacto de negocio</span>
<a id=__codelineno-66-2 name=__codelineno-66-2 href=#__codelineno-66-2></a><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-66-3 name=__codelineno-66-3 href=#__codelineno-66-3></a><span class=sd>‚ùå Mal: &quot;El modelo tiene AUC 0.85 y F1 0.78&quot;  # T√©rminos que no entienden.</span>
<a id=__codelineno-66-4 name=__codelineno-66-4 href=#__codelineno-66-4></a>
<a id=__codelineno-66-5 name=__codelineno-66-5 href=#__codelineno-66-5></a><span class=sd>‚úÖ Bien:                                        # Lenguaje de negocio.</span>
<a id=__codelineno-66-6 name=__codelineno-66-6 href=#__codelineno-66-6></a><span class=sd>&quot;Por cada 100 clientes que van a hacer churn:</span>
<a id=__codelineno-66-7 name=__codelineno-66-7 href=#__codelineno-66-7></a><span class=sd>- Detectamos 78 antes de que se vayan          # Recall en lenguaje simple.</span>
<a id=__codelineno-66-8 name=__codelineno-66-8 href=#__codelineno-66-8></a><span class=sd>- De los que marcamos como riesgo, 82% efectivamente se iban  # Precision.</span>
<a id=__codelineno-66-9 name=__codelineno-66-9 href=#__codelineno-66-9></a>
<a id=__codelineno-66-10 name=__codelineno-66-10 href=#__codelineno-66-10></a><span class=sd>Impacto: Si cada cliente perdido cuesta $500,</span>
<a id=__codelineno-66-11 name=__codelineno-66-11 href=#__codelineno-66-11></a><span class=sd>el modelo puede prevenir $31,200 en p√©rdidas mensuales  # $$$</span>
<a id=__codelineno-66-12 name=__codelineno-66-12 href=#__codelineno-66-12></a><span class=sd>(78 clientes √ó $500 √ó 80% tasa de retenci√≥n con intervenci√≥n)&quot;</span>
<a id=__codelineno-66-13 name=__codelineno-66-13 href=#__codelineno-66-13></a><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-66-14 name=__codelineno-66-14 href=#__codelineno-66-14></a>
<a id=__codelineno-66-15 name=__codelineno-66-15 href=#__codelineno-66-15></a><span class=c1># 2. Visualizaciones claras</span>
<a id=__codelineno-66-16 name=__codelineno-66-16 href=#__codelineno-66-16></a><span class=kn>import</span><span class=w> </span><span class=nn>plotly.express</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>px</span>                     <span class=c1># Plotly: gr√°ficos interactivos.</span>
<a id=__codelineno-66-17 name=__codelineno-66-17 href=#__codelineno-66-17></a>
<a id=__codelineno-66-18 name=__codelineno-66-18 href=#__codelineno-66-18></a><span class=c1># Confusion matrix visual</span>
<a id=__codelineno-66-19 name=__codelineno-66-19 href=#__codelineno-66-19></a><span class=n>fig</span> <span class=o>=</span> <span class=n>px</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span>
<a id=__codelineno-66-20 name=__codelineno-66-20 href=#__codelineno-66-20></a>    <span class=p>[[</span><span class=n>TN</span><span class=p>,</span> <span class=n>FP</span><span class=p>],</span> <span class=p>[</span><span class=n>FN</span><span class=p>,</span> <span class=n>TP</span><span class=p>]],</span>                       <span class=c1># Matriz de confusi√≥n.</span>
<a id=__codelineno-66-21 name=__codelineno-66-21 href=#__codelineno-66-21></a>    <span class=n>labels</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s2>&quot;Predicted&quot;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s2>&quot;Actual&quot;</span><span class=p>),</span>
<a id=__codelineno-66-22 name=__codelineno-66-22 href=#__codelineno-66-22></a>    <span class=n>x</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Stay&quot;</span><span class=p>,</span> <span class=s2>&quot;Churn&quot;</span><span class=p>],</span>
<a id=__codelineno-66-23 name=__codelineno-66-23 href=#__codelineno-66-23></a>    <span class=n>y</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;Stay&quot;</span><span class=p>,</span> <span class=s2>&quot;Churn&quot;</span><span class=p>],</span>
<a id=__codelineno-66-24 name=__codelineno-66-24 href=#__codelineno-66-24></a>    <span class=n>text_auto</span><span class=o>=</span><span class=kc>True</span>                              <span class=c1># Muestra n√∫meros en celdas.</span>
<a id=__codelineno-66-25 name=__codelineno-66-25 href=#__codelineno-66-25></a><span class=p>)</span>
<a id=__codelineno-66-26 name=__codelineno-66-26 href=#__codelineno-66-26></a><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
<a id=__codelineno-66-27 name=__codelineno-66-27 href=#__codelineno-66-27></a>
<a id=__codelineno-66-28 name=__codelineno-66-28 href=#__codelineno-66-28></a><span class=c1># 3. Dashboard ejecutivo en Streamlit</span>
<a id=__codelineno-66-29 name=__codelineno-66-29 href=#__codelineno-66-29></a><span class=n>st</span><span class=o>.</span><span class=n>metric</span><span class=p>(</span><span class=s2>&quot;Clientes en Riesgo&quot;</span><span class=p>,</span> <span class=s2>&quot;234&quot;</span><span class=p>,</span> <span class=n>delta</span><span class=o>=</span><span class=s2>&quot;-12 vs mes pasado&quot;</span><span class=p>)</span>  <span class=c1># KPI con delta.</span>
<a id=__codelineno-66-30 name=__codelineno-66-30 href=#__codelineno-66-30></a><span class=n>st</span><span class=o>.</span><span class=n>metric</span><span class=p>(</span><span class=s2>&quot;Precision Retenci√≥n&quot;</span><span class=p>,</span> <span class=s2>&quot;82%&quot;</span><span class=p>,</span> <span class=n>delta</span><span class=o>=</span><span class=s2>&quot;+5%&quot;</span><span class=p>)</span>  <span class=c1># M√©trica clave.</span>
<a id=__codelineno-66-31 name=__codelineno-66-31 href=#__codelineno-66-31></a><span class=n>st</span><span class=o>.</span><span class=n>metric</span><span class=p>(</span><span class=s2>&quot;Ahorro Estimado&quot;</span><span class=p>,</span> <span class=s2>&quot;$45,000/mes&quot;</span><span class=p>)</span>     <span class=c1># Impacto en dinero.</span>
</code></pre></div> <p><strong>Regla de oro</strong>: Siempre conectar con dinero o KPIs que el stakeholder ya conoce.</p> <hr> <h1 id=recursos>üìö Recursos<a class=headerlink href=#recursos title="Permanent link">&para;</a></h1> <table> <thead> <tr> <th>Tema</th> <th>M√≥dulo</th> </tr> </thead> <tbody> <tr> <td>Pipelines</td> <td><a href=../07_SKLEARN_PIPELINES/ >07_SKLEARN_PIPELINES.md</a></td> </tr> <tr> <td>Testing</td> <td><a href=../11_TESTING_ML/ >11_TESTING_ML.md</a></td> </tr> <tr> <td>CI/CD</td> <td><a href=../12_CI_CD/ >12_CI_CD.md</a></td> </tr> <tr> <td>Docker</td> <td><a href=../13_DOCKER/ >13_DOCKER.md</a></td> </tr> <tr> <td>FastAPI</td> <td><a href=../14_FASTAPI/ >14_FASTAPI.md</a></td> </tr> <tr> <td>MLflow</td> <td><a href=../10_EXPERIMENT_TRACKING/ >10_EXPERIMENT_TRACKING.md</a></td> </tr> </tbody> </table> <hr> <div align=center> **¬°√âxito en tu entrevista! üöÄ** [‚Üê Simulacro Junior](SIMULACRO_ENTREVISTA_JUNIOR.md) | [Simulacro Senior ‚Üí](SIMULACRO_ENTREVISTA_SENIOR_PARTE1.md) </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Volver al principio </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 DuqueOM ‚Äî Gu√≠a MLOps v2 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/DuqueOM target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://linkedin.com/in/duqueom target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>