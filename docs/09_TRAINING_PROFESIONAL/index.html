<!doctype html><html lang=es class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Curso end-to-end para construir un portafolio ML/MLOps profesional desde cero"><meta name=author content=DuqueOM><link href=https://duqueom.github.io/Guia_MLOps/docs/09_TRAINING_PROFESIONAL/ rel=canonical><link href=../08_INGENIERIA_FEATURES/ rel=prev><link href=../10_EXPERIMENT_TRACKING/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>09 â€” Training Profesional - GuÃ­a MLOps â€” Portfolio Edition v2</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#09-training-profesional class=md-skip> Saltar a contenido </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabecera> <a href=../.. title="GuÃ­a MLOps â€” Portfolio Edition v2" class="md-header__button md-logo" aria-label="GuÃ­a MLOps â€” Portfolio Edition v2" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> GuÃ­a MLOps â€” Portfolio Edition v2 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 09 â€” Training Profesional </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Cambiar a modo oscuro" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=deep-purple aria-label="Cambiar a modo claro" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Cambiar a modo claro" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=BÃºsqueda placeholder=BÃºsqueda autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Buscar> <button type=reset class="md-search__icon md-icon" title=Limpiar aria-label=Limpiar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando bÃºsqueda </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/DuqueOM/Guia_MLOps title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Guia_MLOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=PestaÃ±as data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../ class=md-tabs__link> Inicio </a> </li> <li class=md-tabs__item> <a href=../00_INDICE/ class=md-tabs__link> Ãndice Principal </a> </li> <li class=md-tabs__item> <a href=../SYLLABUS/ class=md-tabs__link> Syllabus </a> </li> <li class=md-tabs__item> <a href=../MAPA_PORTAFOLIO_1TO1/ class=md-tabs__link> Mapa 1:1 Portafolio </a> </li> <li class=md-tabs__item> <a href=../PLAN_ESTUDIOS/ class=md-tabs__link> Plan de Estudios </a> </li> <li class=md-tabs__item> <a href=../01_PYTHON_MODERNO/ class=md-tabs__link> Fase 1 - Fundamentos </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../07_SKLEARN_PIPELINES/ class=md-tabs__link> Fase 2 - ML Engineering </a> </li> <li class=md-tabs__item> <a href=../11_TESTING_ML/ class=md-tabs__link> Fase 3 - MLOps Core </a> </li> <li class=md-tabs__item> <a href=../17_DESPLIEGUE/ class=md-tabs__link> Fase 4 - ProducciÃ³n </a> </li> <li class=md-tabs__item> <a href=../19_DOCUMENTACION/ class=md-tabs__link> Fase 5 - Senior/Staff </a> </li> <li class=md-tabs__item> <a href=../apoyo/ class=md-tabs__link> Material de Apoyo </a> </li> <li class=md-tabs__item> <a href=../study_tools/ class=md-tabs__link> Herramientas de Estudio </a> </li> <li class=md-tabs__item> <a href=../../exams/EXAM_01_SETUP/ class=md-tabs__link> ExÃ¡menes </a> </li> <li class=md-tabs__item> <a href=../SIMULACRO_ENTREVISTA_JUNIOR/ class=md-tabs__link> Simulacros de Entrevista </a> </li> <li class=md-tabs__item> <a href=../../notebooks/labs/LAB_01_DOCKER_DEBUG/ class=md-tabs__link> Laboratorios </a> </li> <li class=md-tabs__item> <a href=../templates/ class=md-tabs__link> Plantillas </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=NavegaciÃ³n data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="GuÃ­a MLOps â€” Portfolio Edition v2" class="md-nav__button md-logo" aria-label="GuÃ­a MLOps â€” Portfolio Edition v2" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> GuÃ­a MLOps â€” Portfolio Edition v2 </label> <div class=md-nav__source> <a href=https://github.com/DuqueOM/Guia_MLOps title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Guia_MLOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Inicio </span> </a> </li> <li class=md-nav__item> <a href=../00_INDICE/ class=md-nav__link> <span class=md-ellipsis> Ãndice Principal </span> </a> </li> <li class=md-nav__item> <a href=../SYLLABUS/ class=md-nav__link> <span class=md-ellipsis> Syllabus </span> </a> </li> <li class=md-nav__item> <a href=../MAPA_PORTAFOLIO_1TO1/ class=md-nav__link> <span class=md-ellipsis> Mapa 1:1 Portafolio </span> </a> </li> <li class=md-nav__item> <a href=../PLAN_ESTUDIOS/ class=md-nav__link> <span class=md-ellipsis> Plan de Estudios </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Fase 1 - Fundamentos </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Fase 1 - Fundamentos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01_PYTHON_MODERNO/ class=md-nav__link> <span class=md-ellipsis> 01 â€” Python Moderno </span> </a> </li> <li class=md-nav__item> <a href=../02_DISENO_SISTEMAS/ class=md-nav__link> <span class=md-ellipsis> 02 â€” DiseÃ±o de Sistemas </span> </a> </li> <li class=md-nav__item> <a href=../03_ESTRUCTURA_PROYECTO/ class=md-nav__link> <span class=md-ellipsis> 03 â€” Estructura de Proyecto </span> </a> </li> <li class=md-nav__item> <a href=../04_ENTORNOS/ class=md-nav__link> <span class=md-ellipsis> 04 â€” Entornos </span> </a> </li> <li class=md-nav__item> <a href=../05_GIT_PROFESIONAL/ class=md-nav__link> <span class=md-ellipsis> 05 â€” Git Profesional </span> </a> </li> <li class=md-nav__item> <a href=../06_VERSIONADO_DATOS/ class=md-nav__link> <span class=md-ellipsis> 06 â€” Versionado de Datos </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Fase 2 - ML Engineering </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=true> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Fase 2 - ML Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../07_SKLEARN_PIPELINES/ class=md-nav__link> <span class=md-ellipsis> 07 â€” sklearn Pipelines </span> </a> </li> <li class=md-nav__item> <a href=../08_INGENIERIA_FEATURES/ class=md-nav__link> <span class=md-ellipsis> 08 â€” IngenierÃ­a de Features </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 09 â€” Training Profesional </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 09 â€” Training Profesional </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#objetivo-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Objetivo del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ¯ Objetivo del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#como-se-aplica-en-este-portafolio class=md-nav__link> <span class=md-ellipsis> ğŸ§© CÃ³mo se aplica en este portafolio </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#00-prerrequisitos class=md-nav__link> <span class=md-ellipsis> 0.0 Prerrequisitos </span> </a> </li> <li class=md-nav__item> <a href=#01-protocolo-e-como-estudiar-este-modulo class=md-nav__link> <span class=md-ellipsis> 0.1 ğŸ§  Protocolo E: CÃ³mo estudiar este mÃ³dulo </span> </a> </li> <li class=md-nav__item> <a href=#02-entregables-verificables-minimo-viable class=md-nav__link> <span class=md-ellipsis> 0.2 âœ… Entregables verificables (mÃ­nimo viable) </span> </a> </li> <li class=md-nav__item> <a href=#03-puente-teoria-codigo-portafolio class=md-nav__link> <span class=md-ellipsis> 0.3 ğŸ§© Puente teorÃ­a â†” cÃ³digo (Portafolio) </span> </a> </li> <li class=md-nav__item> <a href=#contenido class=md-nav__link> <span class=md-ellipsis> ğŸ“‹ Contenido </span> </a> <nav class=md-nav aria-label="ğŸ“‹ Contenido"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mapa-mental-de-conceptos-91-arquitectura-de-una-clase-trainer class=md-nav__link> <span class=md-ellipsis> ğŸ§  Mapa Mental de Conceptos: 9.1 Arquitectura de una Clase Trainer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#91-arquitectura-de-una-clase-trainer class=md-nav__link> <span class=md-ellipsis> 9.1 Arquitectura de una Clase Trainer </span> </a> <nav class=md-nav aria-label="9.1 Arquitectura de una Clase Trainer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#codigo-real-churntrainer-bankchurn class=md-nav__link> <span class=md-ellipsis> CÃ³digo Real: ChurnTrainer (BankChurn) </span> </a> </li> <li class=md-nav__item> <a href=#diagrama-del-flujo class=md-nav__link> <span class=md-ellipsis> Diagrama del Flujo </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#92-carga-y-validacion-de-datos class=md-nav__link> <span class=md-ellipsis> 9.2 Carga y ValidaciÃ³n de Datos </span> </a> </li> <li class=md-nav__item> <a href=#93-cross-validation-profesional class=md-nav__link> <span class=md-ellipsis> 9.3 Cross-Validation Profesional </span> </a> </li> <li class=md-nav__item> <a href=#94-gestion-de-artefactos class=md-nav__link> <span class=md-ellipsis> 9.4 GestiÃ³n de Artefactos </span> </a> </li> <li class=md-nav__item> <a href=#95-logging-y-metricas class=md-nav__link> <span class=md-ellipsis> 9.5 Logging y MÃ©tricas </span> </a> <nav class=md-nav aria-label="9.5 Logging y MÃ©tricas"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configurar-logging-profesional class=md-nav__link> <span class=md-ellipsis> Configurar Logging Profesional </span> </a> </li> <li class=md-nav__item> <a href=#integracion-con-mlflow class=md-nav__link> <span class=md-ellipsis> IntegraciÃ³n con MLflow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#96-ingenieria-inversa-pedagogica-churntrainer-real class=md-nav__link> <span class=md-ellipsis> 9.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ChurnTrainer Real </span> </a> <nav class=md-nav aria-label="9.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ChurnTrainer Real"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#961-el-por-que-arquitectonico class=md-nav__link> <span class=md-ellipsis> 9.6.1 ğŸ¯ El "Por QuÃ©" ArquitectÃ³nico </span> </a> </li> <li class=md-nav__item> <a href=#962-anatomia-de-churntrainer class=md-nav__link> <span class=md-ellipsis> 9.6.2 ğŸ” AnatomÃ­a de ChurnTrainer </span> </a> </li> <li class=md-nav__item> <a href=#963-laboratorio-de-replicacion class=md-nav__link> <span class=md-ellipsis> 9.6.3 ğŸ§ª Laboratorio de ReplicaciÃ³n </span> </a> </li> <li class=md-nav__item> <a href=#964-troubleshooting-preventivo class=md-nav__link> <span class=md-ellipsis> 9.6.4 ğŸš¨ Troubleshooting Preventivo </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#errores-habituales-y-como-depurarlos-en-training class=md-nav__link> <span class=md-ellipsis> ğŸ§¨ Errores habituales y cÃ³mo depurarlos en training </span> </a> <nav class=md-nav aria-label="ğŸ§¨ Errores habituales y cÃ³mo depurarlos en training"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-keyerror-o-valueerror-al-cargar-datos-columnasconfig-mal-alineadas class=md-nav__link> <span class=md-ellipsis> 1) KeyError o ValueError al cargar datos (columnas/config mal alineadas) </span> </a> </li> <li class=md-nav__item> <a href=#2-resultados-no-reproducibles-semilla-mal-gestionada class=md-nav__link> <span class=md-ellipsis> 2) Resultados no reproducibles (semilla mal gestionada) </span> </a> </li> <li class=md-nav__item> <a href=#3-cross-validation-enganosa-leakage-entre-folds-o-cv-desalineado-con-test class=md-nav__link> <span class=md-ellipsis> 3) Cross-validation engaÃ±osa (leakage entre folds o CV desalineado con test) </span> </a> </li> <li class=md-nav__item> <a href=#4-artefactos-inconsistentes-modelo-y-metricas-que-no-corresponden class=md-nav__link> <span class=md-ellipsis> 4) Artefactos inconsistentes (modelo y mÃ©tricas que no corresponden) </span> </a> </li> <li class=md-nav__item> <a href=#5-mlflow-no-registra-nada-o-registra-en-el-lugar-equivocado class=md-nav__link> <span class=md-ellipsis> 5) MLflow no registra nada o registra en el lugar equivocado </span> </a> </li> <li class=md-nav__item> <a href=#patron-general-de-debugging-para-training class=md-nav__link> <span class=md-ellipsis> PatrÃ³n general de debugging para training </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ejercicio-implementar-tu-trainer class=md-nav__link> <span class=md-ellipsis> âœ… Ejercicio: Implementar tu Trainer </span> </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> </span> </a> <nav class=md-nav aria-label> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ejercicio-puente-entrenamiento class=md-nav__link> <span class=md-ellipsis> ğŸ’» Ejercicio Puente: Entrenamiento </span> </a> </li> <li class=md-nav__item> <a href=#practica-del-portafolio-training-profesional-en-bankchurn class=md-nav__link> <span class=md-ellipsis> ğŸ› ï¸ PrÃ¡ctica del Portafolio: Training Profesional en BankChurn </span> </a> </li> <li class=md-nav__item> <a href=#checkpoint-de-conocimiento-training-profesional class=md-nav__link> <span class=md-ellipsis> âœ… Checkpoint de Conocimiento: Training Profesional </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#como-se-uso-en-el-portafolio class=md-nav__link> <span class=md-ellipsis> ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio </span> </a> <nav class=md-nav aria-label="ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#clase-churntrainer-real class=md-nav__link> <span class=md-ellipsis> Clase ChurnTrainer Real </span> </a> </li> <li class=md-nav__item> <a href=#flujo-de-entrenamiento class=md-nav__link> <span class=md-ellipsis> Flujo de Entrenamiento </span> </a> </li> <li class=md-nav__item> <a href=#archivos-de-training-por-proyecto class=md-nav__link> <span class=md-ellipsis> Archivos de Training por Proyecto </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-ejecuta-training-real class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Ejercicio: Ejecuta Training Real </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consejos-profesionales class=md-nav__link> <span class=md-ellipsis> ğŸ’¼ Consejos Profesionales </span> </a> <nav class=md-nav aria-label="ğŸ’¼ Consejos Profesionales"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#para-entrevistas class=md-nav__link> <span class=md-ellipsis> Para Entrevistas </span> </a> </li> <li class=md-nav__item> <a href=#para-proyectos-reales class=md-nav__link> <span class=md-ellipsis> Para Proyectos Reales </span> </a> </li> <li class=md-nav__item> <a href=#pipeline-de-training-profesional class=md-nav__link> <span class=md-ellipsis> Pipeline de Training Profesional </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#recursos-externos-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ“º Recursos Externos del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ“º Recursos Externos del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#videos class=md-nav__link> <span class=md-ellipsis> ğŸ¬ Videos </span> </a> </li> <li class=md-nav__item> <a href=#documentacion class=md-nav__link> <span class=md-ellipsis> ğŸ“„ DocumentaciÃ³n </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ejercicios-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Ejercicios del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ”§ Ejercicios del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ejercicio-91-trainer-class class=md-nav__link> <span class=md-ellipsis> Ejercicio 9.1: Trainer Class </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-92-reproducibilidad class=md-nav__link> <span class=md-ellipsis> Ejercicio 9.2: Reproducibilidad </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#glosario-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ”— Glosario del MÃ³dulo </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../10_EXPERIMENT_TRACKING/ class=md-nav__link> <span class=md-ellipsis> 10 â€” Experiment Tracking </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Fase 3 - MLOps Core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Fase 3 - MLOps Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../11_TESTING_ML/ class=md-nav__link> <span class=md-ellipsis> 11 â€” Testing ML </span> </a> </li> <li class=md-nav__item> <a href=../12_CI_CD/ class=md-nav__link> <span class=md-ellipsis> 12 â€” CI/CD </span> </a> </li> <li class=md-nav__item> <a href=../13_DOCKER/ class=md-nav__link> <span class=md-ellipsis> 13 â€” Docker </span> </a> </li> <li class=md-nav__item> <a href=../14_FASTAPI/ class=md-nav__link> <span class=md-ellipsis> 14 â€” FastAPI </span> </a> </li> <li class=md-nav__item> <a href=../15_STREAMLIT/ class=md-nav__link> <span class=md-ellipsis> 15 â€” Streamlit </span> </a> </li> <li class=md-nav__item> <a href=../16_OBSERVABILIDAD/ class=md-nav__link> <span class=md-ellipsis> 16 â€” Observabilidad </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Fase 4 - ProducciÃ³n </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Fase 4 - ProducciÃ³n </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../17_DESPLIEGUE/ class=md-nav__link> <span class=md-ellipsis> 17 â€” Despliegue </span> </a> </li> <li class=md-nav__item> <a href=../18_INFRAESTRUCTURA/ class=md-nav__link> <span class=md-ellipsis> 18 â€” Infraestructura </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0> <span class=md-ellipsis> Fase 5 - Senior/Staff </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Fase 5 - Senior/Staff </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../19_DOCUMENTACION/ class=md-nav__link> <span class=md-ellipsis> 19 â€” DocumentaciÃ³n </span> </a> </li> <li class=md-nav__item> <a href=../20_OBSERVABILIDAD_AVANZADA_DRIFT/ class=md-nav__link> <span class=md-ellipsis> 20 â€” Observabilidad Avanzada </span> </a> </li> <li class=md-nav__item> <a href=../21_CLOUD_FINOPS/ class=md-nav__link> <span class=md-ellipsis> 21 â€” Cloud FinOps </span> </a> </li> <li class=md-nav__item> <a href=../22_IAC_EMPRESARIAL/ class=md-nav__link> <span class=md-ellipsis> 22 â€” IaC Empresarial </span> </a> </li> <li class=md-nav__item> <a href=../23_PROYECTO_INTEGRADOR/ class=md-nav__link> <span class=md-ellipsis> 23 â€” Proyecto Integrador </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0> <span class=md-ellipsis> Material de Apoyo </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> Material de Apoyo </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../apoyo/ class=md-nav__link> <span class=md-ellipsis> Ãndice Apoyo </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GLOSARIO/ class=md-nav__link> <span class=md-ellipsis> Glosario MLOps </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/CHECKLIST/ class=md-nav__link> <span class=md-ellipsis> Checklist Profesional </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/RECURSOS/ class=md-nav__link> <span class=md-ellipsis> Recursos Externos </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/RUBRICA_EVALUACION/ class=md-nav__link> <span class=md-ellipsis> RÃºbrica de EvaluaciÃ³n </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/PLANTILLAS/ class=md-nav__link> <span class=md-ellipsis> Plantillas </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GUIA_AUDIOVISUAL/ class=md-nav__link> <span class=md-ellipsis> GuÃ­a Audiovisual </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/MAINTENANCE_GUIDE/ class=md-nav__link> <span class=md-ellipsis> GuÃ­a de Mantenimiento </span> </a> </li> <li class=md-nav__item> <a href=../apoyo/GUIA_SCRIPTS_OPERACIONALES/ class=md-nav__link> <span class=md-ellipsis> Scripts Operacionales </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_12> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex=0> <span class=md-ellipsis> Herramientas de Estudio </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_12_label aria-expanded=false> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Herramientas de Estudio </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../study_tools/ class=md-nav__link> <span class=md-ellipsis> Ãndice </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/PROTOCOLO_E/ class=md-nav__link> <span class=md-ellipsis> Protocolo E </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/DIARIO_ERRORES/ class=md-nav__link> <span class=md-ellipsis> Diario de Errores </span> </a> </li> <li class=md-nav__item> <a href=../study_tools/CIERRE_SEMANAL/ class=md-nav__link> <span class=md-ellipsis> Cierre Semanal </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13> <label class=md-nav__link for=__nav_13 id=__nav_13_label tabindex=0> <span class=md-ellipsis> ExÃ¡menes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_13_label aria-expanded=false> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> ExÃ¡menes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../exams/EXAM_01_SETUP/ class=md-nav__link> <span class=md-ellipsis> Exam 01 â€” Setup </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_02_PIPELINE/ class=md-nav__link> <span class=md-ellipsis> Exam 02 â€” Pipeline </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_03_TESTING/ class=md-nav__link> <span class=md-ellipsis> Exam 03 â€” Testing </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_04_DEPLOYMENT/ class=md-nav__link> <span class=md-ellipsis> Exam 04 â€” Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_05_PRODUCTION/ class=md-nav__link> <span class=md-ellipsis> Exam 05 â€” Production </span> </a> </li> <li class=md-nav__item> <a href=../../exams/EXAM_06_INTEGRATION/ class=md-nav__link> <span class=md-ellipsis> Exam 06 â€” Integration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_14> <label class=md-nav__link for=__nav_14 id=__nav_14_label tabindex=0> <span class=md-ellipsis> Simulacros de Entrevista </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_14_label aria-expanded=false> <label class=md-nav__title for=__nav_14> <span class="md-nav__icon md-icon"></span> Simulacros de Entrevista </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_JUNIOR/ class=md-nav__link> <span class=md-ellipsis> Junior </span> </a> </li> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_MID/ class=md-nav__link> <span class=md-ellipsis> Mid </span> </a> </li> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_SENIOR_PARTE1/ class=md-nav__link> <span class=md-ellipsis> Senior Parte 1 </span> </a> </li> <li class=md-nav__item> <a href=../SIMULACRO_ENTREVISTA_SENIOR_PARTE2/ class=md-nav__link> <span class=md-ellipsis> Senior Parte 2 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_15> <label class=md-nav__link for=__nav_15 id=__nav_15_label tabindex=0> <span class=md-ellipsis> Laboratorios </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_15_label aria-expanded=false> <label class=md-nav__title for=__nav_15> <span class="md-nav__icon md-icon"></span> Laboratorios </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_01_DOCKER_DEBUG/ class=md-nav__link> <span class=md-ellipsis> LAB 01 â€” Docker Debug </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_02_PANDAS_PERFORMANCE/ class=md-nav__link> <span class=md-ellipsis> LAB 02 â€” Pandas Performance </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/labs/LAB_03_DEPENDENCY_CONFLICTS/ class=md-nav__link> <span class=md-ellipsis> LAB 03 â€” Dependency Conflicts </span> </a> </li> <li class=md-nav__item> <a href=../../notebooks/07_08_sklearn_pipelines/ class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Notebook Interactivo: sklearn Pipelines y Feature Engineering </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_16> <label class=md-nav__link for=__nav_16 id=__nav_16_label tabindex=0> <span class=md-ellipsis> Plantillas </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_16_label aria-expanded=false> <label class=md-nav__title for=__nav_16> <span class="md-nav__icon md-icon"></span> Plantillas </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../templates/ class=md-nav__link> <span class=md-ellipsis> Ãndice Plantillas </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#objetivo-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ¯ Objetivo del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ¯ Objetivo del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#como-se-aplica-en-este-portafolio class=md-nav__link> <span class=md-ellipsis> ğŸ§© CÃ³mo se aplica en este portafolio </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#00-prerrequisitos class=md-nav__link> <span class=md-ellipsis> 0.0 Prerrequisitos </span> </a> </li> <li class=md-nav__item> <a href=#01-protocolo-e-como-estudiar-este-modulo class=md-nav__link> <span class=md-ellipsis> 0.1 ğŸ§  Protocolo E: CÃ³mo estudiar este mÃ³dulo </span> </a> </li> <li class=md-nav__item> <a href=#02-entregables-verificables-minimo-viable class=md-nav__link> <span class=md-ellipsis> 0.2 âœ… Entregables verificables (mÃ­nimo viable) </span> </a> </li> <li class=md-nav__item> <a href=#03-puente-teoria-codigo-portafolio class=md-nav__link> <span class=md-ellipsis> 0.3 ğŸ§© Puente teorÃ­a â†” cÃ³digo (Portafolio) </span> </a> </li> <li class=md-nav__item> <a href=#contenido class=md-nav__link> <span class=md-ellipsis> ğŸ“‹ Contenido </span> </a> <nav class=md-nav aria-label="ğŸ“‹ Contenido"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mapa-mental-de-conceptos-91-arquitectura-de-una-clase-trainer class=md-nav__link> <span class=md-ellipsis> ğŸ§  Mapa Mental de Conceptos: 9.1 Arquitectura de una Clase Trainer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#91-arquitectura-de-una-clase-trainer class=md-nav__link> <span class=md-ellipsis> 9.1 Arquitectura de una Clase Trainer </span> </a> <nav class=md-nav aria-label="9.1 Arquitectura de una Clase Trainer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#codigo-real-churntrainer-bankchurn class=md-nav__link> <span class=md-ellipsis> CÃ³digo Real: ChurnTrainer (BankChurn) </span> </a> </li> <li class=md-nav__item> <a href=#diagrama-del-flujo class=md-nav__link> <span class=md-ellipsis> Diagrama del Flujo </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#92-carga-y-validacion-de-datos class=md-nav__link> <span class=md-ellipsis> 9.2 Carga y ValidaciÃ³n de Datos </span> </a> </li> <li class=md-nav__item> <a href=#93-cross-validation-profesional class=md-nav__link> <span class=md-ellipsis> 9.3 Cross-Validation Profesional </span> </a> </li> <li class=md-nav__item> <a href=#94-gestion-de-artefactos class=md-nav__link> <span class=md-ellipsis> 9.4 GestiÃ³n de Artefactos </span> </a> </li> <li class=md-nav__item> <a href=#95-logging-y-metricas class=md-nav__link> <span class=md-ellipsis> 9.5 Logging y MÃ©tricas </span> </a> <nav class=md-nav aria-label="9.5 Logging y MÃ©tricas"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configurar-logging-profesional class=md-nav__link> <span class=md-ellipsis> Configurar Logging Profesional </span> </a> </li> <li class=md-nav__item> <a href=#integracion-con-mlflow class=md-nav__link> <span class=md-ellipsis> IntegraciÃ³n con MLflow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#96-ingenieria-inversa-pedagogica-churntrainer-real class=md-nav__link> <span class=md-ellipsis> 9.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ChurnTrainer Real </span> </a> <nav class=md-nav aria-label="9.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ChurnTrainer Real"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#961-el-por-que-arquitectonico class=md-nav__link> <span class=md-ellipsis> 9.6.1 ğŸ¯ El "Por QuÃ©" ArquitectÃ³nico </span> </a> </li> <li class=md-nav__item> <a href=#962-anatomia-de-churntrainer class=md-nav__link> <span class=md-ellipsis> 9.6.2 ğŸ” AnatomÃ­a de ChurnTrainer </span> </a> </li> <li class=md-nav__item> <a href=#963-laboratorio-de-replicacion class=md-nav__link> <span class=md-ellipsis> 9.6.3 ğŸ§ª Laboratorio de ReplicaciÃ³n </span> </a> </li> <li class=md-nav__item> <a href=#964-troubleshooting-preventivo class=md-nav__link> <span class=md-ellipsis> 9.6.4 ğŸš¨ Troubleshooting Preventivo </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#errores-habituales-y-como-depurarlos-en-training class=md-nav__link> <span class=md-ellipsis> ğŸ§¨ Errores habituales y cÃ³mo depurarlos en training </span> </a> <nav class=md-nav aria-label="ğŸ§¨ Errores habituales y cÃ³mo depurarlos en training"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-keyerror-o-valueerror-al-cargar-datos-columnasconfig-mal-alineadas class=md-nav__link> <span class=md-ellipsis> 1) KeyError o ValueError al cargar datos (columnas/config mal alineadas) </span> </a> </li> <li class=md-nav__item> <a href=#2-resultados-no-reproducibles-semilla-mal-gestionada class=md-nav__link> <span class=md-ellipsis> 2) Resultados no reproducibles (semilla mal gestionada) </span> </a> </li> <li class=md-nav__item> <a href=#3-cross-validation-enganosa-leakage-entre-folds-o-cv-desalineado-con-test class=md-nav__link> <span class=md-ellipsis> 3) Cross-validation engaÃ±osa (leakage entre folds o CV desalineado con test) </span> </a> </li> <li class=md-nav__item> <a href=#4-artefactos-inconsistentes-modelo-y-metricas-que-no-corresponden class=md-nav__link> <span class=md-ellipsis> 4) Artefactos inconsistentes (modelo y mÃ©tricas que no corresponden) </span> </a> </li> <li class=md-nav__item> <a href=#5-mlflow-no-registra-nada-o-registra-en-el-lugar-equivocado class=md-nav__link> <span class=md-ellipsis> 5) MLflow no registra nada o registra en el lugar equivocado </span> </a> </li> <li class=md-nav__item> <a href=#patron-general-de-debugging-para-training class=md-nav__link> <span class=md-ellipsis> PatrÃ³n general de debugging para training </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ejercicio-implementar-tu-trainer class=md-nav__link> <span class=md-ellipsis> âœ… Ejercicio: Implementar tu Trainer </span> </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> </span> </a> <nav class=md-nav aria-label> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ejercicio-puente-entrenamiento class=md-nav__link> <span class=md-ellipsis> ğŸ’» Ejercicio Puente: Entrenamiento </span> </a> </li> <li class=md-nav__item> <a href=#practica-del-portafolio-training-profesional-en-bankchurn class=md-nav__link> <span class=md-ellipsis> ğŸ› ï¸ PrÃ¡ctica del Portafolio: Training Profesional en BankChurn </span> </a> </li> <li class=md-nav__item> <a href=#checkpoint-de-conocimiento-training-profesional class=md-nav__link> <span class=md-ellipsis> âœ… Checkpoint de Conocimiento: Training Profesional </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#como-se-uso-en-el-portafolio class=md-nav__link> <span class=md-ellipsis> ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio </span> </a> <nav class=md-nav aria-label="ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#clase-churntrainer-real class=md-nav__link> <span class=md-ellipsis> Clase ChurnTrainer Real </span> </a> </li> <li class=md-nav__item> <a href=#flujo-de-entrenamiento class=md-nav__link> <span class=md-ellipsis> Flujo de Entrenamiento </span> </a> </li> <li class=md-nav__item> <a href=#archivos-de-training-por-proyecto class=md-nav__link> <span class=md-ellipsis> Archivos de Training por Proyecto </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-ejecuta-training-real class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Ejercicio: Ejecuta Training Real </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consejos-profesionales class=md-nav__link> <span class=md-ellipsis> ğŸ’¼ Consejos Profesionales </span> </a> <nav class=md-nav aria-label="ğŸ’¼ Consejos Profesionales"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#para-entrevistas class=md-nav__link> <span class=md-ellipsis> Para Entrevistas </span> </a> </li> <li class=md-nav__item> <a href=#para-proyectos-reales class=md-nav__link> <span class=md-ellipsis> Para Proyectos Reales </span> </a> </li> <li class=md-nav__item> <a href=#pipeline-de-training-profesional class=md-nav__link> <span class=md-ellipsis> Pipeline de Training Profesional </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#recursos-externos-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ“º Recursos Externos del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ“º Recursos Externos del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#videos class=md-nav__link> <span class=md-ellipsis> ğŸ¬ Videos </span> </a> </li> <li class=md-nav__item> <a href=#documentacion class=md-nav__link> <span class=md-ellipsis> ğŸ“„ DocumentaciÃ³n </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ejercicios-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ”§ Ejercicios del MÃ³dulo </span> </a> <nav class=md-nav aria-label="ğŸ”§ Ejercicios del MÃ³dulo"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ejercicio-91-trainer-class class=md-nav__link> <span class=md-ellipsis> Ejercicio 9.1: Trainer Class </span> </a> </li> <li class=md-nav__item> <a href=#ejercicio-92-reproducibilidad class=md-nav__link> <span class=md-ellipsis> Ejercicio 9.2: Reproducibilidad </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#glosario-del-modulo class=md-nav__link> <span class=md-ellipsis> ğŸ”— Glosario del MÃ³dulo </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=09-training-profesional>09. Training Profesional<a class=headerlink href=#09-training-profesional title="Permanent link">&para;</a></h1> <h2 id=objetivo-del-modulo>ğŸ¯ Objetivo del MÃ³dulo<a class=headerlink href=#objetivo-del-modulo title="Permanent link">&para;</a></h2> <p>Implementar un pipeline de entrenamiento robusto, reproducible y loggeable como <code>ChurnTrainer</code> de BankChurn.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>â•‘                                                                              â•‘
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>â•‘  NOTEBOOK TÃPICO:                    CÃ“DIGO PROFESIONAL:                     â•‘ 
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>â•‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â•‘
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>â•‘  â€¢ 500 lÃ­neas en un archivo          â€¢ Clases modulares                      â•‘
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>â•‘  â€¢ Variables globales                â€¢ ConfiguraciÃ³n externa                 â•‘
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>â•‘  â€¢ Sin logging                       â€¢ Logging estructurado                  â•‘
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>â•‘  â€¢ &quot;FuncionÃ³... creo&quot;                â€¢ MÃ©tricas rastreadas                   â•‘
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>â•‘  â€¢ Imposible reproducir              â€¢ 100% reproducible                     â•‘
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>â•‘                                                                              â•‘
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
</code></pre></div> <h3 id=como-se-aplica-en-este-portafolio>ğŸ§© CÃ³mo se aplica en este portafolio<a class=headerlink href=#como-se-aplica-en-este-portafolio title="Permanent link">&para;</a></h3> <ul> <li>Este mÃ³dulo se apoya directamente en el cÃ³digo real de <strong>BankChurn-Predictor</strong>:</li> <li><code>src/bankchurn/training.py</code> (<code>ChurnTrainer</code>).</li> <li><code>configs/config.yaml</code> (config Pydantic usada en el trainer).</li> <li>Carpeta <code>artifacts/</code> donde se guardan <code>model.joblib</code> y <code>training_results.json</code>.</li> <li>TambiÃ©n establece el patrÃ³n que luego deberÃ¡s replicar en <strong>CarVision</strong> y <strong>TelecomAI</strong> (por ejemplo, implementando tu propio <code>PriceTrainer</code> o <code>TelecomTrainer</code>) y que se conecta con los mÃ³dulos de <strong>Experiment Tracking</strong> (MLflow) y <strong>CI/CD</strong>.</li> </ul> <hr> <p><a id=00-prerrequisitos></a></p> <h2 id=00-prerrequisitos>0.0 Prerrequisitos<a class=headerlink href=#00-prerrequisitos title="Permanent link">&para;</a></h2> <ul> <li>Haber completado <strong><a href=../07_SKLEARN_PIPELINES/ >07_SKLEARN_PIPELINES</a></strong> (pipeline unificado, serializaciÃ³n).</li> <li>Tener claro el <em>target</em> y el esquema de columnas del dataset.</li> <li>Entender el rol de <strong>CV</strong>, split, y seeds para reproducibilidad.</li> </ul> <hr> <p><a id=01-protocolo-e-como-estudiar-este-modulo></a></p> <h2 id=01-protocolo-e-como-estudiar-este-modulo>0.1 ğŸ§  Protocolo E: CÃ³mo estudiar este mÃ³dulo<a class=headerlink href=#01-protocolo-e-como-estudiar-este-modulo title="Permanent link">&para;</a></h2> <ul> <li><strong>Antes de entrenar</strong>: abre <strong><a href=../study_tools/PROTOCOLO_E/ >Protocolo E</a></strong> y define tu <em>output mÃ­nimo</em> (ej: <code>Trainer.run()</code> que deja artefactos + mÃ©tricas).</li> <li><strong>Durante el debugging</strong>: si te atoras &gt;15 min (splits, CV, mÃ©tricas raras, MLflow), registra el caso en <strong><a href=../study_tools/DIARIO_ERRORES/ >Diario de Errores</a></strong>.</li> <li><strong>Al cerrar la semana</strong>: usa <strong><a href=../study_tools/CIERRE_SEMANAL/ >Cierre Semanal</a></strong> para auditar reproducibilidad y trazabilidad (artefactos + logs).</li> </ul> <hr> <p><a id=02-entregables-verificables-minimo-viable></a></p> <h2 id=02-entregables-verificables-minimo-viable>0.2 âœ… Entregables verificables (mÃ­nimo viable)<a class=headerlink href=#02-entregables-verificables-minimo-viable title="Permanent link">&para;</a></h2> <p>Al terminar este mÃ³dulo, deberÃ­as poder mostrar (en al menos 1 proyecto del portafolio):</p> <ul> <li>[ ] Un <code>Trainer</code> con mÃ©todo <code>run()</code> que produce <strong>artefactos</strong> en un directorio (<code>model.joblib</code>, <code>training_results.json</code>).</li> <li>[ ] <strong>Reproducibilidad</strong>: misma semilla â†’ mÃ©tricas consistentes (dentro de ruido razonable).</li> <li>[ ] <strong>Logging Ãºtil</strong> (split sizes, mÃ©tricas CV/test, paths de salida).</li> </ul> <hr> <p><a id=03-puente-teoria-codigo-portafolio></a></p> <h2 id=03-puente-teoria-codigo-portafolio>0.3 ğŸ§© Puente teorÃ­a â†” cÃ³digo (Portafolio)<a class=headerlink href=#03-puente-teoria-codigo-portafolio title="Permanent link">&para;</a></h2> <p>Para que esto cuente como progreso real, fuerza este mapeo:</p> <ul> <li><strong>Concepto</strong>: pipeline de entrenamiento auditable</li> <li><strong>Archivo</strong>: <code>src/&lt;paquete&gt;/training.py</code>, <code>configs/config.yaml</code>, <code>artifacts/*</code></li> <li><strong>Prueba</strong>: correr <code>Trainer.run()</code> dos veces con misma config/seed y comparar outputs.</li> </ul> <hr> <h2 id=contenido>ğŸ“‹ Contenido<a class=headerlink href=#contenido title="Permanent link">&para;</a></h2> <ul> <li><strong>0.0</strong> <a href=#00-prerrequisitos>Prerrequisitos</a></li> <li><strong>0.1</strong> <a href=#01-protocolo-e-como-estudiar-este-modulo>Protocolo E: CÃ³mo estudiar este mÃ³dulo</a></li> <li><strong>0.2</strong> <a href=#02-entregables-verificables-minimo-viable>Entregables verificables (mÃ­nimo viable)</a></li> <li><strong>0.3</strong> <a href=#03-puente-teoria-codigo-portafolio>Puente teorÃ­a â†” cÃ³digo (Portafolio)</a></li> <li><a href=#91-arquitectura-de-una-clase-trainer>Arquitectura de una Clase Trainer</a></li> <li><a href=#92-carga-y-validacion-de-datos>Carga y ValidaciÃ³n de Datos</a></li> <li><a href=#93-cross-validation-profesional>Cross-Validation Profesional</a></li> <li><a href=#94-gestion-de-artefactos>GestiÃ³n de Artefactos</a></li> <li><a href=#95-logging-y-metricas>Logging y MÃ©tricas</a></li> <li><a href=#96-ingenieria-inversa-training>ğŸ”¬ IngenierÃ­a Inversa: ChurnTrainer Real</a> â­ NUEVO</li> <li><a href=#errores-habituales>Errores habituales</a></li> <li><a href=#ejercicio>âœ… Ejercicio: Implementar tu Trainer</a></li> </ul> <hr> <p><a id=91-arquitectura-de-una-clase-trainer></a></p> <h3 id=mapa-mental-de-conceptos-91-arquitectura-de-una-clase-trainer>ğŸ§  Mapa Mental de Conceptos: 9.1 Arquitectura de una Clase Trainer<a class=headerlink href=#mapa-mental-de-conceptos-91-arquitectura-de-una-clase-trainer title="Permanent link">&para;</a></h3> <p><strong>TÃ©rminos clave que debes dominar para este tema:</strong> - Revisa los conceptos principales en la secciÃ³n siguiente - Practica con los ejercicios del portafolio - Aplica los conocimientos en BankChurn-Predictor</p> <hr> <h2 id=91-arquitectura-de-una-clase-trainer>9.1 Arquitectura de una Clase Trainer<a class=headerlink href=#91-arquitectura-de-una-clase-trainer title="Permanent link">&para;</a></h2> <h3 id=codigo-real-churntrainer-bankchurn>CÃ³digo Real: ChurnTrainer (BankChurn)<a class=headerlink href=#codigo-real-churntrainer-bankchurn title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># src/bankchurn/training.py - Estructura REAL del portafolio</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kn>from</span><span class=w> </span><span class=nn>__future__</span><span class=w> </span><span class=kn>import</span> <span class=n>annotations</span>       <span class=c1># Permite usar tipos como &quot;Pipeline | None&quot; en Python 3.10+.</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>                           <span class=c1># Logging para trazabilidad del entrenamiento.</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=kn>from</span><span class=w> </span><span class=nn>pathlib</span><span class=w> </span><span class=kn>import</span> <span class=n>Path</span>                 <span class=c1># Manejo de rutas multiplataforma.</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Tuple</span>           <span class=c1># Type hints para documentar tipos.</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>                            <span class=c1># SerializaciÃ³n de modelos sklearn.</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=kn>import</span><span class=w> </span><span class=nn>mlflow</span>                            <span class=c1># Tracking de experimentos.</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>                       <span class=c1># Arrays numÃ©ricos.</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>                      <span class=c1># DataFrames para datos tabulares.</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>StratifiedKFold</span><span class=p>,</span> <span class=n>train_test_split</span>  <span class=c1># Split y CV.</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>    <span class=c1># Pipeline unificado.</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=kn>from</span><span class=w> </span><span class=nn>.config</span><span class=w> </span><span class=kn>import</span> <span class=n>BankChurnConfig</span>      <span class=c1># ConfiguraciÃ³n Pydantic del proyecto.</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>     <span class=c1># Logger con nombre del mÃ³dulo.</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=k>class</span><span class=w> </span><span class=nc>ChurnTrainer</span><span class=p>:</span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Pipeline de entrenamiento para predicciÃ³n de churn.</span>
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=sd>    Esta clase encapsula TODO el flujo de entrenamiento:</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=sd>    1. Carga y validaciÃ³n de datos</span>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=sd>    2. PreparaciÃ³n de features</span>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=sd>    3. ConstrucciÃ³n del pipeline</span>
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=sd>    4. Entrenamiento con cross-validation</span>
<a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=sd>    5. EvaluaciÃ³n final</span>
<a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=sd>    6. Guardado de artefactos</span>
<a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>
<a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=sd>    Parameters</span>
<a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=sd>    ----------</span>
<a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=sd>    config : BankChurnConfig</span>
<a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a><span class=sd>        ConfiguraciÃ³n validada con Pydantic.</span>
<a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=sd>    random_state : int, optional</span>
<a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=sd>        Semilla para reproducibilidad.</span>
<a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>
<a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=sd>    Attributes</span>
<a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a><span class=sd>    ----------</span>
<a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=sd>    model_ : Pipeline</span>
<a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=sd>        Pipeline entrenado (disponible despuÃ©s de fit).</span>
<a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a><span class=sd>    cv_results_ : dict</span>
<a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a><span class=sd>        Resultados de cross-validation.</span>
<a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a><span class=sd>    test_results_ : dict</span>
<a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a><span class=sd>        Resultados en test set.</span>
<a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a>
<a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a><span class=sd>    Examples</span>
<a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a><span class=sd>    --------</span>
<a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a><span class=sd>    &gt;&gt;&gt; config = BankChurnConfig.from_yaml(&quot;configs/config.yaml&quot;)</span>
<a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a><span class=sd>    &gt;&gt;&gt; trainer = ChurnTrainer(config)</span>
<a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a><span class=sd>    &gt;&gt;&gt; trainer.run(&quot;data/raw/churn.csv&quot;, &quot;artifacts/&quot;)</span>
<a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a>
<a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>BankChurnConfig</span><span class=p>,</span> <span class=n>random_state</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
<a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a>        <span class=bp>self</span><span class=o>.</span><span class=n>random_state</span> <span class=o>=</span> <span class=n>random_state</span> <span class=ow>or</span> <span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>random_state</span>
<a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a>
<a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a>        <span class=c1># Atributos que se llenan durante entrenamiento</span>
<a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=p>:</span> <span class=n>Pipeline</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cv_results_</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a>        <span class=bp>self</span><span class=o>.</span><span class=n>test_results_</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a>
<a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a>        <span class=c1># Configurar MLflow si estÃ¡ habilitado</span>
<a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>mlflow</span><span class=o>.</span><span class=n>enabled</span><span class=p>:</span>
<a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_setup_mlflow</span><span class=p>()</span>
<a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a>
<a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a>    <span class=k>def</span><span class=w> </span><span class=nf>_setup_mlflow</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Configura MLflow tracking.&quot;&quot;&quot;</span>
<a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a>        <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a>            <span class=n>mlflow</span><span class=o>.</span><span class=n>set_tracking_uri</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>mlflow</span><span class=o>.</span><span class=n>tracking_uri</span><span class=p>)</span>
<a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a>            <span class=n>mlflow</span><span class=o>.</span><span class=n>set_experiment</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>mlflow</span><span class=o>.</span><span class=n>experiment_name</span><span class=p>)</span>
<a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;MLflow tracking: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>mlflow</span><span class=o>.</span><span class=n>tracking_uri</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;MLflow setup failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a>
<a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a>    <span class=k>def</span><span class=w> </span><span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_path</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=n>Path</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
<a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Ejecuta el pipeline completo de entrenamiento.</span>
<a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a>
<a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a><span class=sd>        Parameters</span>
<a id=__codelineno-1-81 name=__codelineno-1-81 href=#__codelineno-1-81></a><span class=sd>        ----------</span>
<a id=__codelineno-1-82 name=__codelineno-1-82 href=#__codelineno-1-82></a><span class=sd>        input_path : str or Path</span>
<a id=__codelineno-1-83 name=__codelineno-1-83 href=#__codelineno-1-83></a><span class=sd>            Ruta al CSV de entrada.</span>
<a id=__codelineno-1-84 name=__codelineno-1-84 href=#__codelineno-1-84></a><span class=sd>        output_dir : str or Path</span>
<a id=__codelineno-1-85 name=__codelineno-1-85 href=#__codelineno-1-85></a><span class=sd>            Directorio para guardar artefactos.</span>
<a id=__codelineno-1-86 name=__codelineno-1-86 href=#__codelineno-1-86></a>
<a id=__codelineno-1-87 name=__codelineno-1-87 href=#__codelineno-1-87></a><span class=sd>        Returns</span>
<a id=__codelineno-1-88 name=__codelineno-1-88 href=#__codelineno-1-88></a><span class=sd>        -------</span>
<a id=__codelineno-1-89 name=__codelineno-1-89 href=#__codelineno-1-89></a><span class=sd>        dict</span>
<a id=__codelineno-1-90 name=__codelineno-1-90 href=#__codelineno-1-90></a><span class=sd>            Resultados de entrenamiento y evaluaciÃ³n.</span>
<a id=__codelineno-1-91 name=__codelineno-1-91 href=#__codelineno-1-91></a><span class=sd>        &quot;&quot;&quot;</span>
<a id=__codelineno-1-92 name=__codelineno-1-92 href=#__codelineno-1-92></a>        <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
<a id=__codelineno-1-93 name=__codelineno-1-93 href=#__codelineno-1-93></a>        <span class=n>output_dir</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-1-94 name=__codelineno-1-94 href=#__codelineno-1-94></a>
<a id=__codelineno-1-95 name=__codelineno-1-95 href=#__codelineno-1-95></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;=&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>
<a id=__codelineno-1-96 name=__codelineno-1-96 href=#__codelineno-1-96></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;INICIANDO ENTRENAMIENTO&quot;</span><span class=p>)</span>
<a id=__codelineno-1-97 name=__codelineno-1-97 href=#__codelineno-1-97></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;=&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>
<a id=__codelineno-1-98 name=__codelineno-1-98 href=#__codelineno-1-98></a>
<a id=__codelineno-1-99 name=__codelineno-1-99 href=#__codelineno-1-99></a>        <span class=c1># 1. Cargar datos</span>
<a id=__codelineno-1-100 name=__codelineno-1-100 href=#__codelineno-1-100></a>        <span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
<a id=__codelineno-1-101 name=__codelineno-1-101 href=#__codelineno-1-101></a>
<a id=__codelineno-1-102 name=__codelineno-1-102 href=#__codelineno-1-102></a>        <span class=c1># 2. Preparar features</span>
<a id=__codelineno-1-103 name=__codelineno-1-103 href=#__codelineno-1-103></a>        <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>prepare_features</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<a id=__codelineno-1-104 name=__codelineno-1-104 href=#__codelineno-1-104></a>
<a id=__codelineno-1-105 name=__codelineno-1-105 href=#__codelineno-1-105></a>        <span class=c1># 3. Split train/test</span>
<a id=__codelineno-1-106 name=__codelineno-1-106 href=#__codelineno-1-106></a>        <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
<a id=__codelineno-1-107 name=__codelineno-1-107 href=#__codelineno-1-107></a>            <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-1-108 name=__codelineno-1-108 href=#__codelineno-1-108></a>            <span class=n>test_size</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>test_size</span><span class=p>,</span>
<a id=__codelineno-1-109 name=__codelineno-1-109 href=#__codelineno-1-109></a>            <span class=n>random_state</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>random_state</span><span class=p>,</span>
<a id=__codelineno-1-110 name=__codelineno-1-110 href=#__codelineno-1-110></a>            <span class=n>stratify</span><span class=o>=</span><span class=n>y</span>  <span class=c1># Mantener proporciÃ³n de clases</span>
<a id=__codelineno-1-111 name=__codelineno-1-111 href=#__codelineno-1-111></a>        <span class=p>)</span>
<a id=__codelineno-1-112 name=__codelineno-1-112 href=#__codelineno-1-112></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Train: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>X_train</span><span class=p>)</span><span class=si>}</span><span class=s2>, Test: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-1-113 name=__codelineno-1-113 href=#__codelineno-1-113></a>
<a id=__codelineno-1-114 name=__codelineno-1-114 href=#__codelineno-1-114></a>        <span class=c1># 4. Construir pipeline</span>
<a id=__codelineno-1-115 name=__codelineno-1-115 href=#__codelineno-1-115></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>build_pipeline</span><span class=p>()</span>
<a id=__codelineno-1-116 name=__codelineno-1-116 href=#__codelineno-1-116></a>
<a id=__codelineno-1-117 name=__codelineno-1-117 href=#__codelineno-1-117></a>        <span class=c1># 5. Cross-validation</span>
<a id=__codelineno-1-118 name=__codelineno-1-118 href=#__codelineno-1-118></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cv_results_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cross_validate</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-1-119 name=__codelineno-1-119 href=#__codelineno-1-119></a>
<a id=__codelineno-1-120 name=__codelineno-1-120 href=#__codelineno-1-120></a>        <span class=c1># 6. Entrenar modelo final</span>
<a id=__codelineno-1-121 name=__codelineno-1-121 href=#__codelineno-1-121></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-1-122 name=__codelineno-1-122 href=#__codelineno-1-122></a>
<a id=__codelineno-1-123 name=__codelineno-1-123 href=#__codelineno-1-123></a>        <span class=c1># 7. Evaluar en test</span>
<a id=__codelineno-1-124 name=__codelineno-1-124 href=#__codelineno-1-124></a>        <span class=bp>self</span><span class=o>.</span><span class=n>test_results_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
<a id=__codelineno-1-125 name=__codelineno-1-125 href=#__codelineno-1-125></a>
<a id=__codelineno-1-126 name=__codelineno-1-126 href=#__codelineno-1-126></a>        <span class=c1># 8. Guardar artefactos</span>
<a id=__codelineno-1-127 name=__codelineno-1-127 href=#__codelineno-1-127></a>        <span class=bp>self</span><span class=o>.</span><span class=n>save_artifacts</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
<a id=__codelineno-1-128 name=__codelineno-1-128 href=#__codelineno-1-128></a>
<a id=__codelineno-1-129 name=__codelineno-1-129 href=#__codelineno-1-129></a>        <span class=c1># 9. Log a MLflow</span>
<a id=__codelineno-1-130 name=__codelineno-1-130 href=#__codelineno-1-130></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>mlflow</span><span class=o>.</span><span class=n>enabled</span><span class=p>:</span>
<a id=__codelineno-1-131 name=__codelineno-1-131 href=#__codelineno-1-131></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_log_to_mlflow</span><span class=p>()</span>
<a id=__codelineno-1-132 name=__codelineno-1-132 href=#__codelineno-1-132></a>
<a id=__codelineno-1-133 name=__codelineno-1-133 href=#__codelineno-1-133></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;=&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>
<a id=__codelineno-1-134 name=__codelineno-1-134 href=#__codelineno-1-134></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;ENTRENAMIENTO COMPLETADO&quot;</span><span class=p>)</span>
<a id=__codelineno-1-135 name=__codelineno-1-135 href=#__codelineno-1-135></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;=&quot;</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span>
<a id=__codelineno-1-136 name=__codelineno-1-136 href=#__codelineno-1-136></a>
<a id=__codelineno-1-137 name=__codelineno-1-137 href=#__codelineno-1-137></a>        <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-1-138 name=__codelineno-1-138 href=#__codelineno-1-138></a>            <span class=s2>&quot;cv_results&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_results_</span><span class=p>,</span>
<a id=__codelineno-1-139 name=__codelineno-1-139 href=#__codelineno-1-139></a>            <span class=s2>&quot;test_results&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>test_results_</span><span class=p>,</span>
<a id=__codelineno-1-140 name=__codelineno-1-140 href=#__codelineno-1-140></a>        <span class=p>}</span>
</code></pre></div> <h3 id=diagrama-del-flujo>Diagrama del Flujo<a class=headerlink href=#diagrama-del-flujo title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>â”‚                        ChurnTrainer.run() Flow                          â”‚
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>â”‚                                                                         â”‚
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>â”‚   â”‚ Config  â”‚â”€â”€â”€â–ºâ”‚  Load   â”‚â”€â”€â”€â–ºâ”‚ Prepare â”‚â”€â”€â”€â–ºâ”‚  Split   â”‚             â”‚
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>â”‚   â”‚  YAML   â”‚    â”‚  Data   â”‚    â”‚Features â”‚    â”‚Train/Testâ”‚             â”‚
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â”‚
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>â”‚                                                     â”‚                   â”‚
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>â”‚                                                     â–¼                   â”‚
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>â”‚   â”‚ MLflow  â”‚â—„â”€â”€â”€â”‚  Save   â”‚â—„â”€â”€â”€â”‚Evaluate â”‚â—„â”€â”€â”€â”‚  Train  â”‚              â”‚
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>â”‚   â”‚  Log    â”‚    â”‚Artifactsâ”‚    â”‚ (Test)  â”‚    â”‚ + CV    â”‚              â”‚
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>â”‚                                                                         â”‚
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>â”‚   OUTPUT:                                                               â”‚
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>â”‚   â€¢ model.joblib (Pipeline completo)                                    â”‚
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>â”‚   â€¢ training_results.json (mÃ©tricas)                                    â”‚
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>â”‚   â€¢ MLflow run (experimento rastreado)                                  â”‚
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a>â”‚                                                                         â”‚
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div> <hr> <p><a id=92-carga-y-validacion-de-datos></a></p> <h2 id=92-carga-y-validacion-de-datos>9.2 Carga y ValidaciÃ³n de Datos<a class=headerlink href=#92-carga-y-validacion-de-datos title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># ContinuaciÃ³n de ChurnTrainer</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=k>def</span><span class=w> </span><span class=nf>load_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_path</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Carga y valida datos de entrada.</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=sd>    Parameters</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=sd>    ----------</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=sd>    input_path : str or Path</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=sd>        Ruta al archivo CSV.</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=sd>    Returns</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=sd>    -------</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=sd>    pd.DataFrame</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=sd>        Datos cargados y validados.</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=sd>    Raises</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=sd>    ------</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=sd>    FileNotFoundError</span>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=sd>        Si el archivo no existe.</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=sd>    ValueError</span>
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=sd>        Si faltan columnas requeridas.</span>
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>    <span class=n>input_path</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>input_path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>        <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Archivo no encontrado: </span><span class=si>{</span><span class=n>input_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>    <span class=c1># Cargar CSV</span>
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a>    <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
<a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Datos cargados: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2> filas, </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2> columnas&quot;</span><span class=p>)</span>
<a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a>
<a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>    <span class=c1># Validar columnas requeridas</span>
<a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a>    <span class=n>required</span> <span class=o>=</span> <span class=p>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>target_column</span><span class=p>}</span>
<a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a>    <span class=n>required</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>numerical_features</span><span class=p>)</span>
<a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a>    <span class=n>required</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>categorical_features</span><span class=p>)</span>
<a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a>
<a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a>    <span class=n>missing</span> <span class=o>=</span> <span class=n>required</span> <span class=o>-</span> <span class=nb>set</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span>
<a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a>    <span class=k>if</span> <span class=n>missing</span><span class=p>:</span>
<a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Columnas faltantes: </span><span class=si>{</span><span class=n>missing</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a>
<a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a>    <span class=c1># Log de estadÃ­sticas bÃ¡sicas</span>
<a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a>    <span class=n>target</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>target_column</span>
<a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a>    <span class=n>class_dist</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>target</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>(</span><span class=n>normalize</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;DistribuciÃ³n de clases:</span><span class=se>\n</span><span class=si>{</span><span class=n>class_dist</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-3-45 name=__codelineno-3-45 href=#__codelineno-3-45></a>
<a id=__codelineno-3-46 name=__codelineno-3-46 href=#__codelineno-3-46></a>    <span class=c1># Alertar si hay desbalance severo</span>
<a id=__codelineno-3-47 name=__codelineno-3-47 href=#__codelineno-3-47></a>    <span class=n>minority_pct</span> <span class=o>=</span> <span class=n>class_dist</span><span class=o>.</span><span class=n>min</span><span class=p>()</span>
<a id=__codelineno-3-48 name=__codelineno-3-48 href=#__codelineno-3-48></a>    <span class=k>if</span> <span class=n>minority_pct</span> <span class=o>&lt;</span> <span class=mf>0.1</span><span class=p>:</span>
<a id=__codelineno-3-49 name=__codelineno-3-49 href=#__codelineno-3-49></a>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;âš ï¸ Desbalance severo: clase minoritaria = </span><span class=si>{</span><span class=n>minority_pct</span><span class=si>:</span><span class=s2>.1%</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-3-50 name=__codelineno-3-50 href=#__codelineno-3-50></a>
<a id=__codelineno-3-51 name=__codelineno-3-51 href=#__codelineno-3-51></a>    <span class=k>return</span> <span class=n>data</span>
<a id=__codelineno-3-52 name=__codelineno-3-52 href=#__codelineno-3-52></a>
<a id=__codelineno-3-53 name=__codelineno-3-53 href=#__codelineno-3-53></a>
<a id=__codelineno-3-54 name=__codelineno-3-54 href=#__codelineno-3-54></a><span class=k>def</span><span class=w> </span><span class=nf>prepare_features</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>]:</span>
<a id=__codelineno-3-55 name=__codelineno-3-55 href=#__codelineno-3-55></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Prepara features y target.</span>
<a id=__codelineno-3-56 name=__codelineno-3-56 href=#__codelineno-3-56></a>
<a id=__codelineno-3-57 name=__codelineno-3-57 href=#__codelineno-3-57></a><span class=sd>    Aplica:</span>
<a id=__codelineno-3-58 name=__codelineno-3-58 href=#__codelineno-3-58></a><span class=sd>    1. EliminaciÃ³n de columnas innecesarias (drop_columns)</span>
<a id=__codelineno-3-59 name=__codelineno-3-59 href=#__codelineno-3-59></a><span class=sd>    2. SeparaciÃ³n de X e y</span>
<a id=__codelineno-3-60 name=__codelineno-3-60 href=#__codelineno-3-60></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-3-61 name=__codelineno-3-61 href=#__codelineno-3-61></a>    <span class=c1># Columnas a eliminar</span>
<a id=__codelineno-3-62 name=__codelineno-3-62 href=#__codelineno-3-62></a>    <span class=n>drop_cols</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>drop_columns</span> <span class=o>+</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>target_column</span><span class=p>]</span>
<a id=__codelineno-3-63 name=__codelineno-3-63 href=#__codelineno-3-63></a>    <span class=n>drop_cols</span> <span class=o>=</span> <span class=p>[</span><span class=n>c</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>drop_cols</span> <span class=k>if</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>columns</span><span class=p>]</span>
<a id=__codelineno-3-64 name=__codelineno-3-64 href=#__codelineno-3-64></a>
<a id=__codelineno-3-65 name=__codelineno-3-65 href=#__codelineno-3-65></a>    <span class=n>X</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>drop_cols</span><span class=p>)</span>
<a id=__codelineno-3-66 name=__codelineno-3-66 href=#__codelineno-3-66></a>    <span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>target_column</span><span class=p>]</span>
<a id=__codelineno-3-67 name=__codelineno-3-67 href=#__codelineno-3-67></a>
<a id=__codelineno-3-68 name=__codelineno-3-68 href=#__codelineno-3-68></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Features: </span><span class=si>{</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2>, Target: </span><span class=si>{</span><span class=n>y</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-3-69 name=__codelineno-3-69 href=#__codelineno-3-69></a>
<a id=__codelineno-3-70 name=__codelineno-3-70 href=#__codelineno-3-70></a>    <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span>
</code></pre></div> <hr> <p><a id=93-cross-validation-profesional></a></p> <h2 id=93-cross-validation-profesional>9.3 Cross-Validation Profesional<a class=headerlink href=#93-cross-validation-profesional title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=k>def</span><span class=w> </span><span class=nf>cross_validate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>float</span><span class=p>]:</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Ejecuta cross-validation estratificada.</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=sd>    Stratified K-Fold mantiene la proporciÃ³n de clases en cada fold,</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=sd>    crucial para datasets desbalanceados.</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>f1_score</span><span class=p>,</span> <span class=n>roc_auc_score</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>    <span class=n>cv</span> <span class=o>=</span> <span class=n>StratifiedKFold</span><span class=p>(</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>        <span class=n>n_splits</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>cv_folds</span><span class=p>,</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>        <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>        <span class=n>random_state</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>random_state</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>    <span class=p>)</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=n>f1_scores</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>    <span class=n>auc_scores</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Cross-validation con </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>cv_folds</span><span class=si>}</span><span class=s2> folds...&quot;</span><span class=p>)</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>    <span class=k>for</span> <span class=n>fold</span><span class=p>,</span> <span class=p>(</span><span class=n>train_idx</span><span class=p>,</span> <span class=n>val_idx</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>cv</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=mi>1</span><span class=p>):</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>        <span class=n>X_train_cv</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>train_idx</span><span class=p>]</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>        <span class=n>X_val_cv</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>val_idx</span><span class=p>]</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>        <span class=n>y_train_cv</span> <span class=o>=</span> <span class=n>y</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>train_idx</span><span class=p>]</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>        <span class=n>y_val_cv</span> <span class=o>=</span> <span class=n>y</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=n>val_idx</span><span class=p>]</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>        <span class=c1># Clonar pipeline para este fold</span>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>        <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.base</span><span class=w> </span><span class=kn>import</span> <span class=n>clone</span>
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>        <span class=n>fold_pipeline</span> <span class=o>=</span> <span class=n>clone</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=p>)</span>
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a>
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>        <span class=c1># Entrenar en este fold</span>
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a>        <span class=n>fold_pipeline</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train_cv</span><span class=p>,</span> <span class=n>y_train_cv</span><span class=p>)</span>
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a>
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a>        <span class=c1># Evaluar</span>
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a>        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>fold_pipeline</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_val_cv</span><span class=p>)</span>
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a>        <span class=n>y_proba</span> <span class=o>=</span> <span class=n>fold_pipeline</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_val_cv</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a>
<a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a>        <span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_val_cv</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
<a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a>        <span class=n>auc</span> <span class=o>=</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_val_cv</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>)</span>
<a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a>
<a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a>        <span class=n>f1_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>f1</span><span class=p>)</span>
<a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a>        <span class=n>auc_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>auc</span><span class=p>)</span>
<a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a>
<a id=__codelineno-4-43 name=__codelineno-4-43 href=#__codelineno-4-43></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  Fold </span><span class=si>{</span><span class=n>fold</span><span class=si>}</span><span class=s2>: F1=</span><span class=si>{</span><span class=n>f1</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>, AUC=</span><span class=si>{</span><span class=n>auc</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-4-44 name=__codelineno-4-44 href=#__codelineno-4-44></a>
<a id=__codelineno-4-45 name=__codelineno-4-45 href=#__codelineno-4-45></a>    <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-4-46 name=__codelineno-4-46 href=#__codelineno-4-46></a>        <span class=s2>&quot;f1_mean&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>f1_scores</span><span class=p>),</span>
<a id=__codelineno-4-47 name=__codelineno-4-47 href=#__codelineno-4-47></a>        <span class=s2>&quot;f1_std&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>f1_scores</span><span class=p>),</span>
<a id=__codelineno-4-48 name=__codelineno-4-48 href=#__codelineno-4-48></a>        <span class=s2>&quot;auc_mean&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>auc_scores</span><span class=p>),</span>
<a id=__codelineno-4-49 name=__codelineno-4-49 href=#__codelineno-4-49></a>        <span class=s2>&quot;auc_std&quot;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>auc_scores</span><span class=p>),</span>
<a id=__codelineno-4-50 name=__codelineno-4-50 href=#__codelineno-4-50></a>    <span class=p>}</span>
<a id=__codelineno-4-51 name=__codelineno-4-51 href=#__codelineno-4-51></a>
<a id=__codelineno-4-52 name=__codelineno-4-52 href=#__codelineno-4-52></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CV Results: F1=</span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;f1_mean&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> Â± </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;f1_std&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-4-53 name=__codelineno-4-53 href=#__codelineno-4-53></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CV Results: AUC=</span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;auc_mean&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> Â± </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;auc_std&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-4-54 name=__codelineno-4-54 href=#__codelineno-4-54></a>
<a id=__codelineno-4-55 name=__codelineno-4-55 href=#__codelineno-4-55></a>    <span class=k>return</span> <span class=n>results</span>
</code></pre></div> <hr> <p><a id=94-gestion-de-artefactos></a></p> <h2 id=94-gestion-de-artefactos>9.4 GestiÃ³n de Artefactos<a class=headerlink href=#94-gestion-de-artefactos title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>def</span><span class=w> </span><span class=nf>save_artifacts</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Guarda modelo y resultados.&quot;&quot;&quot;</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    <span class=kn>import</span><span class=w> </span><span class=nn>json</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>    <span class=c1># 1. Guardar modelo (pipeline completo)</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>    <span class=n>model_path</span> <span class=o>=</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=s2>&quot;model.joblib&quot;</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>    <span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=p>,</span> <span class=n>model_path</span><span class=p>)</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Modelo guardado: </span><span class=si>{</span><span class=n>model_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>    <span class=c1># 2. Guardar resultados como JSON</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>    <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>        <span class=s2>&quot;cv_results&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_results_</span><span class=p>,</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>        <span class=s2>&quot;test_results&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>test_results_</span><span class=p>,</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>        <span class=s2>&quot;config&quot;</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>            <span class=s2>&quot;model_type&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>type</span><span class=p>,</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>            <span class=s2>&quot;test_size&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>test_size</span><span class=p>,</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>            <span class=s2>&quot;cv_folds&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>cv_folds</span><span class=p>,</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>            <span class=s2>&quot;random_state&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>random_state</span><span class=p>,</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>        <span class=p>}</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>    <span class=p>}</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>    <span class=n>results_path</span> <span class=o>=</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=s2>&quot;training_results.json&quot;</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>results_path</span><span class=p>,</span> <span class=s2>&quot;w&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>        <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>results</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Resultados guardados: </span><span class=si>{</span><span class=n>results_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=k>def</span><span class=w> </span><span class=nf>evaluate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X_test</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>y_test</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>:</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;EvalÃºa en test set.&quot;&quot;&quot;</span>
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>    <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>        <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>,</span>
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>        <span class=n>f1_score</span><span class=p>,</span> <span class=n>roc_auc_score</span><span class=p>,</span> <span class=n>confusion_matrix</span>
<a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a>    <span class=p>)</span>
<a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>
<a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a>    <span class=n>y_pred</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a>    <span class=n>y_proba</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>
<a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a>
<a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a>    <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a>        <span class=s2>&quot;metrics&quot;</span><span class=p>:</span> <span class=p>{</span>
<a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>            <span class=s2>&quot;accuracy&quot;</span><span class=p>:</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
<a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a>            <span class=s2>&quot;precision&quot;</span><span class=p>:</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
<a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a>            <span class=s2>&quot;recall&quot;</span><span class=p>:</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
<a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a>            <span class=s2>&quot;f1_score&quot;</span><span class=p>:</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
<a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a>            <span class=s2>&quot;roc_auc&quot;</span><span class=p>:</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_proba</span><span class=p>),</span>
<a id=__codelineno-5-45 name=__codelineno-5-45 href=#__codelineno-5-45></a>        <span class=p>},</span>
<a id=__codelineno-5-46 name=__codelineno-5-46 href=#__codelineno-5-46></a>        <span class=s2>&quot;confusion_matrix&quot;</span><span class=p>:</span> <span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span><span class=o>.</span><span class=n>tolist</span><span class=p>(),</span>
<a id=__codelineno-5-47 name=__codelineno-5-47 href=#__codelineno-5-47></a>    <span class=p>}</span>
<a id=__codelineno-5-48 name=__codelineno-5-48 href=#__codelineno-5-48></a>
<a id=__codelineno-5-49 name=__codelineno-5-49 href=#__codelineno-5-49></a>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Test Results:&quot;</span><span class=p>)</span>
<a id=__codelineno-5-50 name=__codelineno-5-50 href=#__codelineno-5-50></a>    <span class=k>for</span> <span class=n>metric</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>results</span><span class=p>[</span><span class=s2>&quot;metrics&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
<a id=__codelineno-5-51 name=__codelineno-5-51 href=#__codelineno-5-51></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;  </span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>value</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-5-52 name=__codelineno-5-52 href=#__codelineno-5-52></a>
<a id=__codelineno-5-53 name=__codelineno-5-53 href=#__codelineno-5-53></a>    <span class=k>return</span> <span class=n>results</span>
</code></pre></div> <hr> <p><a id=95-logging-y-metricas></a></p> <h2 id=95-logging-y-metricas>9.5 Logging y MÃ©tricas<a class=headerlink href=#95-logging-y-metricas title="Permanent link">&para;</a></h2> <h3 id=configurar-logging-profesional>Configurar Logging Profesional<a class=headerlink href=#configurar-logging-profesional title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># src/bankchurn/__init__.py o en el mÃ³dulo principal</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=kn>import</span><span class=w> </span><span class=nn>logging</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=kn>import</span><span class=w> </span><span class=nn>sys</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=k>def</span><span class=w> </span><span class=nf>setup_logging</span><span class=p>(</span><span class=n>level</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;INFO&quot;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Configura logging estructurado.&quot;&quot;&quot;</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>    <span class=c1># Formato profesional</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>    <span class=n>fmt</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>%(asctime)s</span><span class=s2> | </span><span class=si>%(levelname)-8s</span><span class=s2> | </span><span class=si>%(name)s</span><span class=s2> | </span><span class=si>%(message)s</span><span class=s2>&quot;</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>    <span class=n>datefmt</span> <span class=o>=</span> <span class=s2>&quot;%Y-%m-</span><span class=si>%d</span><span class=s2> %H:%M:%S&quot;</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>    <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>        <span class=n>level</span><span class=o>=</span><span class=nb>getattr</span><span class=p>(</span><span class=n>logging</span><span class=p>,</span> <span class=n>level</span><span class=o>.</span><span class=n>upper</span><span class=p>()),</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>        <span class=nb>format</span><span class=o>=</span><span class=n>fmt</span><span class=p>,</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>        <span class=n>datefmt</span><span class=o>=</span><span class=n>datefmt</span><span class=p>,</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>        <span class=n>handlers</span><span class=o>=</span><span class=p>[</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>            <span class=n>logging</span><span class=o>.</span><span class=n>StreamHandler</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>stdout</span><span class=p>),</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>            <span class=n>logging</span><span class=o>.</span><span class=n>FileHandler</span><span class=p>(</span><span class=s2>&quot;training.log&quot;</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s2>&quot;a&quot;</span><span class=p>),</span>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>        <span class=p>]</span>
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>    <span class=p>)</span>
<a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a>
<a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a>    <span class=c1># Reducir verbosidad de librerÃ­as externas</span>
<a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>    <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s2>&quot;urllib3&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=n>logging</span><span class=o>.</span><span class=n>WARNING</span><span class=p>)</span>
<a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a>    <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s2>&quot;mlflow&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=n>logging</span><span class=o>.</span><span class=n>WARNING</span><span class=p>)</span>
<a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a>
<a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a>
<a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=c1># Uso</span>
<a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=n>setup_logging</span><span class=p>(</span><span class=s2>&quot;INFO&quot;</span><span class=p>)</span>
</code></pre></div> <h3 id=integracion-con-mlflow>IntegraciÃ³n con MLflow<a class=headerlink href=#integracion-con-mlflow title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>def</span><span class=w> </span><span class=nf>_log_to_mlflow</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Loguea mÃ©tricas y artefactos a MLflow.&quot;&quot;&quot;</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    <span class=k>with</span> <span class=n>mlflow</span><span class=o>.</span><span class=n>start_run</span><span class=p>(</span><span class=n>run_name</span><span class=o>=</span><span class=s2>&quot;training&quot;</span><span class=p>):</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>        <span class=c1># ParÃ¡metros</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>        <span class=n>mlflow</span><span class=o>.</span><span class=n>log_params</span><span class=p>({</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>            <span class=s2>&quot;model_type&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>type</span><span class=p>,</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>            <span class=s2>&quot;test_size&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>test_size</span><span class=p>,</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>            <span class=s2>&quot;cv_folds&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>cv_folds</span><span class=p>,</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>            <span class=s2>&quot;random_state&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>random_state</span><span class=p>,</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>        <span class=p>})</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>        <span class=c1># MÃ©tricas de CV</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_results_</span><span class=p>:</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>            <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metrics</span><span class=p>({</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>                <span class=sa>f</span><span class=s2>&quot;cv_</span><span class=si>{</span><span class=n>k</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_results_</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>            <span class=p>})</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>        <span class=c1># MÃ©tricas de test</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>test_results_</span><span class=p>:</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>            <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metrics</span><span class=p>({</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>                <span class=sa>f</span><span class=s2>&quot;test_</span><span class=si>{</span><span class=n>k</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>:</span> <span class=n>v</span> 
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>                <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>test_results_</span><span class=p>[</span><span class=s2>&quot;metrics&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>            <span class=p>})</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>        <span class=c1># Artefactos</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>        <span class=n>mlflow</span><span class=o>.</span><span class=n>log_artifact</span><span class=p>(</span><span class=s2>&quot;artifacts/training_results.json&quot;</span><span class=p>)</span>
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;MLflow run logged: </span><span class=si>{</span><span class=n>mlflow</span><span class=o>.</span><span class=n>active_run</span><span class=p>()</span><span class=o>.</span><span class=n>info</span><span class=o>.</span><span class=n>run_id</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <hr> <p><a id=96-ingenieria-inversa-training></a></p> <h2 id=96-ingenieria-inversa-pedagogica-churntrainer-real>9.6 ğŸ”¬ IngenierÃ­a Inversa PedagÃ³gica: ChurnTrainer Real<a class=headerlink href=#96-ingenieria-inversa-pedagogica-churntrainer-real title="Permanent link">&para;</a></h2> <blockquote> <p><strong>Objetivo</strong>: Entender CADA decisiÃ³n detrÃ¡s del <code>ChurnTrainer</code> del portafolio.</p> </blockquote> <h3 id=961-el-por-que-arquitectonico>9.6.1 ğŸ¯ El "Por QuÃ©" ArquitectÃ³nico<a class=headerlink href=#961-el-por-que-arquitectonico title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>â”‚                    DECISIONES ARQUITECTÃ“NICAS DEL PORTAFOLIO                    â”‚
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>â”‚                                                                                 â”‚
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>â”‚  PROBLEMA 1: Â¿CÃ³mo hago que el training sea reproducible entre ejecuciones?     â”‚
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>â”‚  RIESGO: &quot;Funciona en mi mÃ¡quina&quot; pero mÃ©tricas diferentes en CI                â”‚
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>â”‚  DECISIÃ“N: random_state explÃ­cito en constructor + config externa               â”‚
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>â”‚  RESULTADO: Misma semilla â†’ mismas mÃ©tricas (Â±0.01%)                            â”‚
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>â”‚  REFERENCIA: training.py lÃ­neas 57-63                                           â”‚
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>â”‚                                                                                 â”‚
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>â”‚  PROBLEMA 2: Â¿CÃ³mo detecto automÃ¡ticamente tipos de features?                   â”‚
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>â”‚  RIESGO: Hardcodear columnas â†’ falla si el schema cambia                        â”‚
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>â”‚  DECISIÃ“N: Auto-detecciÃ³n con fallback a config explÃ­cita                       â”‚
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>â”‚  RESULTADO: Funciona con nuevos datasets, pero permite override                 â”‚
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>â”‚  REFERENCIA: training.py::_detect_feature_types (lÃ­neas 136-158)                â”‚
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>â”‚                                                                                 â”‚
<a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>â”‚  PROBLEMA 3: Â¿CÃ³mo integro MLflow sin acoplar el cÃ³digo?                        â”‚
<a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
<a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>â”‚  RIESGO: MLflow falla â†’ training crashea                                        â”‚
<a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>â”‚  DECISIÃ“N: config.mlflow.enabled + try/except en setup                          â”‚
<a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>â”‚  RESULTADO: Training funciona sin MLflow, pero lo usa si estÃ¡ disponible        â”‚
<a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>â”‚  REFERENCIA: training.py lÃ­neas 65-71                                           â”‚
<a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a>â”‚                                                                                 â”‚
<a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div> <h3 id=962-anatomia-de-churntrainer>9.6.2 ğŸ” AnatomÃ­a de <code>ChurnTrainer</code><a class=headerlink href=#962-anatomia-de-churntrainer title="Permanent link">&para;</a></h3> <p><strong>Archivo</strong>: <code>ML-MLOps-Portfolio/BankChurn-Predictor/src/bankchurn/training.py</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=c1># BLOQUE 1: Constructor con ConfiguraciÃ³n Externalizada</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=c1># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=k>class</span><span class=w> </span><span class=nc>ChurnTrainer</span><span class=p>:</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>BankChurnConfig</span><span class=p>,</span> <span class=n>random_state</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>                           <span class=c1># Config Pydantic validada.</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>        <span class=bp>self</span><span class=o>.</span><span class=n>random_state</span> <span class=o>=</span> <span class=n>random_state</span> <span class=ow>or</span> <span class=n>config</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>random_state</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>        <span class=c1># Â¿Por quÃ© `or`?</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>        <span class=c1># - Permite override desde cÃ³digo (Ãºtil para tests).</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>        <span class=c1># - Si no se pasa, usa el valor de config (para reproducibilidad).</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=p>:</span> <span class=n>Pipeline</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>            <span class=c1># Modelo entrenado (None hasta fit).</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>        <span class=bp>self</span><span class=o>.</span><span class=n>preprocessor_</span><span class=p>:</span> <span class=n>ColumnTransformer</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>        <span class=c1># Configurar MLflow si estÃ¡ habilitado</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>mlflow</span><span class=o>.</span><span class=n>enabled</span><span class=p>:</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>            <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>                <span class=n>mlflow</span><span class=o>.</span><span class=n>set_tracking_uri</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>mlflow</span><span class=o>.</span><span class=n>tracking_uri</span><span class=p>)</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>                <span class=n>mlflow</span><span class=o>.</span><span class=n>set_experiment</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>mlflow</span><span class=o>.</span><span class=n>experiment_name</span><span class=p>)</span>
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>                <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Failed to configure MLflow: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>                <span class=c1># NO crashea. Training continÃºa sin tracking.</span>
<a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a><span class=c1># Â¿Por quÃ© try/except para MLflow?</span>
<a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=c1># - MLflow puede no estar disponible (server down, sin permisos, etc.).</span>
<a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=c1># - El training es mÃ¡s importante que el tracking.</span>
<a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>
<a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a><span class=c1># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a><span class=c1># BLOQUE 2: Carga de Datos con ValidaciÃ³n</span>
<a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a><span class=c1># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>    <span class=k>def</span><span class=w> </span><span class=nf>load_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_path</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a>        <span class=n>input_path</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
<a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a>
<a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>input_path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
<a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a>            <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Input file not found: </span><span class=si>{</span><span class=n>input_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-9-35 name=__codelineno-9-35 href=#__codelineno-9-35></a>
<a id=__codelineno-9-36 name=__codelineno-9-36 href=#__codelineno-9-36></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
<a id=__codelineno-9-37 name=__codelineno-9-37 href=#__codelineno-9-37></a>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Loaded data: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2> rows, </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=si>}</span><span class=s2> columns&quot;</span><span class=p>)</span>
<a id=__codelineno-9-38 name=__codelineno-9-38 href=#__codelineno-9-38></a>
<a id=__codelineno-9-39 name=__codelineno-9-39 href=#__codelineno-9-39></a>        <span class=c1># Validar columnas requeridas</span>
<a id=__codelineno-9-40 name=__codelineno-9-40 href=#__codelineno-9-40></a>        <span class=n>required</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>target_column</span><span class=p>]</span>
<a id=__codelineno-9-41 name=__codelineno-9-41 href=#__codelineno-9-41></a>        <span class=n>missing</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>required</span><span class=p>)</span> <span class=o>-</span> <span class=nb>set</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span>
<a id=__codelineno-9-42 name=__codelineno-9-42 href=#__codelineno-9-42></a>        <span class=k>if</span> <span class=n>missing</span><span class=p>:</span>
<a id=__codelineno-9-43 name=__codelineno-9-43 href=#__codelineno-9-43></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Missing required columns: </span><span class=si>{</span><span class=n>missing</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-9-44 name=__codelineno-9-44 href=#__codelineno-9-44></a>
<a id=__codelineno-9-45 name=__codelineno-9-45 href=#__codelineno-9-45></a>        <span class=k>return</span> <span class=n>data</span>
<a id=__codelineno-9-46 name=__codelineno-9-46 href=#__codelineno-9-46></a><span class=c1># Â¿Por quÃ© validar columnas antes de entrenar?</span>
<a id=__codelineno-9-47 name=__codelineno-9-47 href=#__codelineno-9-47></a><span class=c1># - Fail fast: detectar errores de datos ANTES de gastar compute.</span>
<a id=__codelineno-9-48 name=__codelineno-9-48 href=#__codelineno-9-48></a><span class=c1># - Mensajes claros: &quot;Missing column X&quot; vs &quot;KeyError&quot; crÃ­ptico.</span>
<a id=__codelineno-9-49 name=__codelineno-9-49 href=#__codelineno-9-49></a>
<a id=__codelineno-9-50 name=__codelineno-9-50 href=#__codelineno-9-50></a><span class=c1># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<a id=__codelineno-9-51 name=__codelineno-9-51 href=#__codelineno-9-51></a><span class=c1># BLOQUE 3: DetecciÃ³n AutomÃ¡tica de Tipos</span>
<a id=__codelineno-9-52 name=__codelineno-9-52 href=#__codelineno-9-52></a><span class=c1># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<a id=__codelineno-9-53 name=__codelineno-9-53 href=#__codelineno-9-53></a>    <span class=k>def</span><span class=w> </span><span class=nf>_detect_feature_types</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]]:</span>
<a id=__codelineno-9-54 name=__codelineno-9-54 href=#__codelineno-9-54></a>        <span class=n>cat_config</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>categorical_features</span>
<a id=__codelineno-9-55 name=__codelineno-9-55 href=#__codelineno-9-55></a>        <span class=n>num_config</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>numerical_features</span>
<a id=__codelineno-9-56 name=__codelineno-9-56 href=#__codelineno-9-56></a>
<a id=__codelineno-9-57 name=__codelineno-9-57 href=#__codelineno-9-57></a>        <span class=c1># Usa config si estÃ¡ presente, sino auto-detecta</span>
<a id=__codelineno-9-58 name=__codelineno-9-58 href=#__codelineno-9-58></a>        <span class=k>if</span> <span class=n>cat_config</span><span class=p>:</span>
<a id=__codelineno-9-59 name=__codelineno-9-59 href=#__codelineno-9-59></a>            <span class=n>cat_features</span> <span class=o>=</span> <span class=p>[</span><span class=n>c</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>cat_config</span> <span class=k>if</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span><span class=p>]</span>
<a id=__codelineno-9-60 name=__codelineno-9-60 href=#__codelineno-9-60></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-9-61 name=__codelineno-9-61 href=#__codelineno-9-61></a>            <span class=n>cat_features</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>select_dtypes</span><span class=p>(</span><span class=n>include</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;object&quot;</span><span class=p>,</span> <span class=s2>&quot;category&quot;</span><span class=p>])</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
<a id=__codelineno-9-62 name=__codelineno-9-62 href=#__codelineno-9-62></a>
<a id=__codelineno-9-63 name=__codelineno-9-63 href=#__codelineno-9-63></a>        <span class=k>if</span> <span class=n>num_config</span><span class=p>:</span>
<a id=__codelineno-9-64 name=__codelineno-9-64 href=#__codelineno-9-64></a>            <span class=n>num_features</span> <span class=o>=</span> <span class=p>[</span><span class=n>c</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>num_config</span> <span class=k>if</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>X</span><span class=o>.</span><span class=n>columns</span><span class=p>]</span>
<a id=__codelineno-9-65 name=__codelineno-9-65 href=#__codelineno-9-65></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-9-66 name=__codelineno-9-66 href=#__codelineno-9-66></a>            <span class=n>num_features</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>select_dtypes</span><span class=p>(</span><span class=n>include</span><span class=o>=</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>number</span><span class=p>])</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
<a id=__codelineno-9-67 name=__codelineno-9-67 href=#__codelineno-9-67></a>
<a id=__codelineno-9-68 name=__codelineno-9-68 href=#__codelineno-9-68></a>        <span class=k>return</span> <span class=n>cat_features</span><span class=p>,</span> <span class=n>num_features</span>
<a id=__codelineno-9-69 name=__codelineno-9-69 href=#__codelineno-9-69></a><span class=c1># Â¿Por quÃ© este patrÃ³n &quot;config or auto-detect&quot;?</span>
<a id=__codelineno-9-70 name=__codelineno-9-70 href=#__codelineno-9-70></a><span class=c1># - Flexibilidad: funciona sin config (desarrollo rÃ¡pido).</span>
<a id=__codelineno-9-71 name=__codelineno-9-71 href=#__codelineno-9-71></a><span class=c1># - Control: config explÃ­cita para producciÃ³n (evita sorpresas).</span>
</code></pre></div> <h3 id=963-laboratorio-de-replicacion>9.6.3 ğŸ§ª Laboratorio de ReplicaciÃ³n<a class=headerlink href=#963-laboratorio-de-replicacion title="Permanent link">&para;</a></h3> <p><strong>Tu misiÃ³n</strong>: Crear tu propio Trainer siguiendo el patrÃ³n del portafolio.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># src/mi_proyecto/training.py</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=kn>from</span><span class=w> </span><span class=nn>dataclasses</span><span class=w> </span><span class=kn>import</span> <span class=n>dataclass</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=kn>from</span><span class=w> </span><span class=nn>pathlib</span><span class=w> </span><span class=kn>import</span> <span class=n>Path</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=nd>@dataclass</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=k>class</span><span class=w> </span><span class=nc>TrainerConfig</span><span class=p>:</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>    <span class=n>target_column</span><span class=p>:</span> <span class=nb>str</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>    <span class=n>random_state</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>42</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>    <span class=n>test_size</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.2</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=k>class</span><span class=w> </span><span class=nc>MiTrainer</span><span class=p>:</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>TrainerConfig</span><span class=p>):</span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=p>:</span> <span class=n>Pipeline</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a>    <span class=k>def</span><span class=w> </span><span class=nf>load_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a>            <span class=k>raise</span> <span class=ne>FileNotFoundError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;No existe: </span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a>        <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a>
<a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a>        <span class=c1># Tu lÃ³gica de training aquÃ­</span>
<a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a>        <span class=o>...</span>
<a id=__codelineno-10-27 name=__codelineno-10-27 href=#__codelineno-10-27></a>        <span class=k>return</span> <span class=p>{</span><span class=s2>&quot;f1&quot;</span><span class=p>:</span> <span class=mf>0.85</span><span class=p>,</span> <span class=s2>&quot;auc&quot;</span><span class=p>:</span> <span class=mf>0.90</span><span class=p>}</span>
<a id=__codelineno-10-28 name=__codelineno-10-28 href=#__codelineno-10-28></a>
<a id=__codelineno-10-29 name=__codelineno-10-29 href=#__codelineno-10-29></a>    <span class=k>def</span><span class=w> </span><span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<a id=__codelineno-10-30 name=__codelineno-10-30 href=#__codelineno-10-30></a>        <span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=p>,</span> <span class=n>path</span><span class=p>)</span>
</code></pre></div> <h3 id=964-troubleshooting-preventivo>9.6.4 ğŸš¨ Troubleshooting Preventivo<a class=headerlink href=#964-troubleshooting-preventivo title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>SÃ­ntoma</th> <th>Causa Probable</th> <th>SoluciÃ³n</th> </tr> </thead> <tbody> <tr> <td><strong>MÃ©tricas diferentes entre ejecuciones</strong></td> <td>random_state no fijado en todos los lugares</td> <td>Pasa random_state a train_test_split, modelo, y CV.</td> </tr> <tr> <td><strong>KeyError en columna target</strong></td> <td>Config no actualizada con nombre correcto</td> <td>Valida <code>config.data.target_column</code> contra <code>df.columns</code>.</td> </tr> <tr> <td><strong>MLflow "experiment not found"</strong></td> <td>set_experiment antes de set_tracking_uri</td> <td>Llama siempre <code>set_tracking_uri</code> primero.</td> </tr> <tr> <td><strong>Pipeline no serializable</strong></td> <td>Custom transformer sin <code>__getstate__</code></td> <td>Usa solo transformers de sklearn o implementa serializaciÃ³n.</td> </tr> </tbody> </table> <hr> <p><a id=errores-habituales></a></p> <h2 id=errores-habituales-y-como-depurarlos-en-training>ğŸ§¨ Errores habituales y cÃ³mo depurarlos en training<a class=headerlink href=#errores-habituales-y-como-depurarlos-en-training title="Permanent link">&para;</a></h2> <p>En este mÃ³dulo, casi todos los problemas vienen de <strong>datos mal preparados</strong>, <strong>splits inconsistentes</strong> o <strong>logging incompleto</strong>. AquÃ­ estÃ¡n los patrones mÃ¡s frecuentes.</p> <p>Si alguno de estos errores te tomÃ³ <strong>&gt;15 minutos</strong>, regÃ­stralo en el <strong><a href=../study_tools/DIARIO_ERRORES/ >Diario de Errores</a></strong> y aplica el flujo de <strong>rescate cognitivo</strong> de <strong><a href=../study_tools/PROTOCOLO_E/ >Protocolo E</a></strong>.</p> <h3 id=1-keyerror-o-valueerror-al-cargar-datos-columnasconfig-mal-alineadas>1) <code>KeyError</code> o <code>ValueError</code> al cargar datos (columnas/config mal alineadas)<a class=headerlink href=#1-keyerror-o-valueerror-al-cargar-datos-columnasconfig-mal-alineadas title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li><code>ValueError: Columnas faltantes: {'CreditScore', 'Age', ...}</code></li> <li><code>KeyError: 'Exited'</code> al intentar acceder al target.</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Compara <code>self.config.data.*</code> con las columnas reales del CSV.</li> <li>Usa <code>load_data</code> como punto Ãºnico de verdad y revisa sus logs (nÃºmero de filas/columnas, distribuciÃ³n de clases).</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>Ajusta <code>configs/config.yaml</code> para que <code>target_column</code>, <code>numerical_features</code>, <code>categorical_features</code> reflejen <strong>exactamente</strong> el dataset.</li> <li>MantÃ©n <code>prepare_features</code> simple: usar solo <code>drop_columns</code> + separaciÃ³n de <code>X</code> e <code>y</code>.</li> </ul> <hr> <h3 id=2-resultados-no-reproducibles-semilla-mal-gestionada>2) Resultados no reproducibles (semilla mal gestionada)<a class=headerlink href=#2-resultados-no-reproducibles-semilla-mal-gestionada title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li>Cada ejecuciÃ³n de <code>ChurnTrainer.run</code> produce mÃ©tricas distintas sin razÃ³n aparente.</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Revisa la inicializaciÃ³n de <code>ChurnTrainer</code> y el uso de <code>random_state</code> en:</li> <li><code>train_test_split</code>.</li> <li><code>StratifiedKFold</code>.</li> <li>Modelos base (<code>RandomForest</code>, etc.).</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>AsegÃºrate de que la semilla venga de un solo lugar (config) y se pase a todos los componentes relevantes.</li> <li>Si usas utilidades como <code>common_utils.seed.set_seed</code>, llama a esa funciÃ³n al inicio de <code>run</code> o en el CLI.</li> </ul> <hr> <h3 id=3-cross-validation-enganosa-leakage-entre-folds-o-cv-desalineado-con-test>3) Cross-validation engaÃ±osa (leakage entre folds o CV desalineado con test)<a class=headerlink href=#3-cross-validation-enganosa-leakage-entre-folds-o-cv-desalineado-con-test title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li>MÃ©tricas de CV muy buenas, pero test set mucho peor.</li> <li>Folds con distribuciÃ³n de clases muy desigual.</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Verifica que usas <code>StratifiedKFold</code> para clasificaciÃ³n desbalanceada.</li> <li>AsegÃºrate de clonar el pipeline (<code>clone(self.model_)</code>) en cada fold, no reutilizar el mismo objeto.</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>MantÃ©n el orden: definir pipeline completo <strong>antes</strong> de CV y clonar dentro del loop.</li> <li>No mezcles datos de test en CV; usa <code>train_test_split</code> una sola vez, luego CV solo en <code>X_train, y_train</code>.</li> </ul> <hr> <h3 id=4-artefactos-inconsistentes-modelo-y-metricas-que-no-corresponden>4) Artefactos inconsistentes (modelo y mÃ©tricas que no corresponden)<a class=headerlink href=#4-artefactos-inconsistentes-modelo-y-metricas-que-no-corresponden title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li><code>training_results.json</code> y <code>model.joblib</code> provienen de ejecuciones distintas.</li> <li>MLflow muestra mÃ©tricas que no coinciden con los artefactos locales.</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Revisa que <code>save_artifacts</code> se llama <strong>despuÃ©s</strong> de entrenar el modelo final y evaluar en test.</li> <li>Comprueba timestamps y contenido de <code>artifacts/model.joblib</code> y <code>artifacts/training_results.json</code>.</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>Asegura el orden en <code>run</code>: CV â†’ <code>fit</code> final â†’ <code>evaluate</code> â†’ <code>save_artifacts</code> â†’ <code>_log_to_mlflow</code>.</li> <li>No reutilices artefactos viejos; limpia la carpeta <code>artifacts/</code> antes de grandes cambios.</li> </ul> <hr> <h3 id=5-mlflow-no-registra-nada-o-registra-en-el-lugar-equivocado>5) MLflow no registra nada o registra en el lugar equivocado<a class=headerlink href=#5-mlflow-no-registra-nada-o-registra-en-el-lugar-equivocado title="Permanent link">&para;</a></h3> <p><strong>SÃ­ntomas tÃ­picos</strong></p> <ul> <li>Corres <code>ChurnTrainer.run</code> pero no ves runs nuevos en la UI de MLflow.</li> <li>MÃ©tricas aparecen en otro experimento o en otro tracking URI.</li> </ul> <p><strong>CÃ³mo identificarlo</strong></p> <ul> <li>Imprime/inspecciona <code>self.config.mlflow.tracking_uri</code> y <code>experiment_name</code>.</li> <li>Verifica variables de entorno (<code>MLFLOW_TRACKING_URI</code>) si las usas en scripts aparte (<code>run_mlflow.py</code>).</li> </ul> <p><strong>CÃ³mo corregirlo</strong></p> <ul> <li>Centraliza la configuraciÃ³n en <code>BankChurnConfig</code> y <code>_setup_mlflow</code>, evitando <code>mlflow.set_tracking_uri</code> dispersos en el cÃ³digo.</li> <li>En <code>run_mlflow.py</code>, asegÃºrate de usar el mismo <code>tracking_uri</code> y <code>experiment</code> que usaste durante el entrenamiento.</li> </ul> <hr> <h3 id=patron-general-de-debugging-para-training>PatrÃ³n general de debugging para training<a class=headerlink href=#patron-general-de-debugging-para-training title="Permanent link">&para;</a></h3> <ol> <li><strong>Empieza por los datos</strong>: confirma que <code>load_data</code> y <code>prepare_features</code> producen <code>X, y</code> con las formas y columnas esperadas.</li> <li><strong>Verifica el split</strong>: revisa distribuciÃ³n de clases en <code>train/test</code> y en cada fold.</li> <li><strong>Comprueba los artefactos</strong>: que <code>model.joblib</code> y <code>training_results.json</code> se regeneren juntos.</li> <li><strong>Sincroniza con MLflow</strong>: compara mÃ©tricas locales con lo que ves en la UI.</li> </ol> <p>Con este enfoque, el entrenamiento deja de ser â€œcaja negraâ€ y se convierte en un pipeline controlado y auditable, como se espera en un rol Senior/Staff.</p> <hr> <p><a id=ejercicio></a></p> <h2 id=ejercicio-implementar-tu-trainer>âœ… Ejercicio: Implementar tu Trainer<a class=headerlink href=#ejercicio-implementar-tu-trainer title="Permanent link">&para;</a></h2> <p>Crea una clase <code>PriceTrainer</code> para CarVision siguiendo el patrÃ³n:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>class</span><span class=w> </span><span class=nc>PriceTrainer</span><span class=p>:</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Tu tarea: implementar siguiendo el patrÃ³n de ChurnTrainer.&quot;&quot;&quot;</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>        <span class=c1># TODO: Inicializar atributos</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>        <span class=k>pass</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>    <span class=k>def</span><span class=w> </span><span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>        <span class=c1># TODO: Implementar flujo completo</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>        <span class=k>pass</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>    <span class=k>def</span><span class=w> </span><span class=nf>load_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>        <span class=c1># TODO: Cargar y validar</span>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>        <span class=k>pass</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>    <span class=k>def</span><span class=w> </span><span class=nf>build_pipeline</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>        <span class=c1># TODO: Construir pipeline [features -&gt; pre -&gt; model]</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>        <span class=k>pass</span>
</code></pre></div> <hr> <h2 id=_1><a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <h3 id=ejercicio-puente-entrenamiento>ğŸ’» Ejercicio Puente: Entrenamiento<a class=headerlink href=#ejercicio-puente-entrenamiento title="Permanent link">&para;</a></h3> <blockquote> <p><strong>Meta</strong>: Practica el concepto antes de aplicarlo al portafolio.</p> </blockquote> <p><strong>Ejercicio bÃ¡sico:</strong> - Revisa el cÃ³digo de ejemplo en la secciÃ³n siguiente - Identifica los patrones clave - Replica el patrÃ³n en un proyecto simple</p> <hr> <h3 id=practica-del-portafolio-training-profesional-en-bankchurn>ğŸ› ï¸ PrÃ¡ctica del Portafolio: Training Profesional en BankChurn<a class=headerlink href=#practica-del-portafolio-training-profesional-en-bankchurn title="Permanent link">&para;</a></h3> <blockquote> <p><strong>Tarea</strong>: Aplicar los conceptos de este mÃ³dulo en BankChurn-Predictor.</p> </blockquote> <p><strong>Pasos:</strong> 1. Navega al proyecto: <code>cd BankChurn-Predictor</code> 2. Localiza el cÃ³digo relevante en <code>src/bankchurn/</code> 3. Verifica la implementaciÃ³n actual 4. Aplica mejoras segÃºn las buenas prÃ¡cticas de este mÃ³dulo</p> <hr> <h3 id=checkpoint-de-conocimiento-training-profesional>âœ… Checkpoint de Conocimiento: Training Profesional<a class=headerlink href=#checkpoint-de-conocimiento-training-profesional title="Permanent link">&para;</a></h3> <p><strong>Pregunta 1</strong>: Â¿CuÃ¡l es el concepto mÃ¡s importante de este mÃ³dulo? - Revisa el mapa mental y la secciÃ³n principal</p> <p><strong>Pregunta 2</strong>: Â¿CÃ³mo se aplica en el portafolio? - Examina el cÃ³digo de BankChurn-Predictor</p> <p><strong>ğŸ”§ Escenario de Debugging:</strong> - Identifica un problema comÃºn en este tema - Practica la soluciÃ³n con el cÃ³digo del portafolio</p> <hr> <h2 id=como-se-uso-en-el-portafolio>ğŸ“¦ CÃ³mo se UsÃ³ en el Portafolio<a class=headerlink href=#como-se-uso-en-el-portafolio title="Permanent link">&para;</a></h2> <p>El proyecto <strong>BankChurn</strong> implementa el patrÃ³n de training profesional completo:</p> <h3 id=clase-churntrainer-real>Clase ChurnTrainer Real<a class=headerlink href=#clase-churntrainer-real title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># BankChurn-Predictor/src/bankchurn/trainer.py (estructura)</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=k>class</span><span class=w> </span><span class=nc>ChurnTrainer</span><span class=p>:</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Entrenador profesional con CV, MLflow y artefactos.&quot;&quot;&quot;</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=n>BankChurnConfig</span><span class=p>):</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>        <span class=bp>self</span><span class=o>.</span><span class=n>metrics_</span> <span class=o>=</span> <span class=p>{}</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a>    <span class=k>def</span><span class=w> </span><span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_path</span><span class=p>:</span> <span class=n>Path</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>:</span> <span class=n>Path</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Flujo completo: load â†’ split â†’ CV â†’ train â†’ evaluate â†’ save.&quot;&quot;&quot;</span>
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>        <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_data</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>        <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>prepare_features</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>        <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>split_data</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a>
<a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a>        <span class=c1># Cross-validation</span>
<a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a>        <span class=n>cv_scores</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cross_validate</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a>
<a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a>        <span class=c1># Entrenamiento final</span>
<a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>build_pipeline</span><span class=p>()</span>
<a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a>
<a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a>        <span class=c1># EvaluaciÃ³n</span>
<a id=__codelineno-12-24 name=__codelineno-12-24 href=#__codelineno-12-24></a>        <span class=bp>self</span><span class=o>.</span><span class=n>metrics_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span>
<a id=__codelineno-12-25 name=__codelineno-12-25 href=#__codelineno-12-25></a>
<a id=__codelineno-12-26 name=__codelineno-12-26 href=#__codelineno-12-26></a>        <span class=c1># Guardar artefactos</span>
<a id=__codelineno-12-27 name=__codelineno-12-27 href=#__codelineno-12-27></a>        <span class=bp>self</span><span class=o>.</span><span class=n>save_artifacts</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
<a id=__codelineno-12-28 name=__codelineno-12-28 href=#__codelineno-12-28></a>
<a id=__codelineno-12-29 name=__codelineno-12-29 href=#__codelineno-12-29></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>metrics_</span>
</code></pre></div> <h3 id=flujo-de-entrenamiento>Flujo de Entrenamiento<a class=headerlink href=#flujo-de-entrenamiento title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>â”‚                    FLUJO DE TRAINING                          â”‚
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>â”‚                                                               â”‚
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>â”‚  load_data â†’ prepare_features â†’ split_data                    â”‚
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>â”‚      â”‚              â”‚               â”‚                         â”‚
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>â”‚      â–¼              â–¼               â–¼                         â”‚
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>â”‚  DataFrame     X, y arrays    train/test split                â”‚
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>â”‚                                     â”‚                         â”‚
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>â”‚                    â”‚                                 â”‚        â”‚
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>â”‚              cross_validate                    build_pipeline â”‚
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>â”‚                    â”‚                                 â”‚        â”‚
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>â”‚              cv_scores                          Pipeline      â”‚
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>â”‚                    â”‚                                 â”‚        â”‚
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>â”‚                                     â”‚                         â”‚
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>â”‚                              model_.fit()                     â”‚
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>â”‚                                     â”‚                         â”‚
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>â”‚                              evaluate()                       â”‚
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>â”‚                                     â”‚                         â”‚
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>â”‚                           save_artifacts()                    â”‚
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>â”‚                                     â”‚                         â”‚
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>â”‚                       pipeline.joblib + metrics.json          â”‚
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a>â”‚                                                               â”‚
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div> <h3 id=archivos-de-training-por-proyecto>Archivos de Training por Proyecto<a class=headerlink href=#archivos-de-training-por-proyecto title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Proyecto</th> <th>Trainer</th> <th>Config</th> <th>Artefactos</th> </tr> </thead> <tbody> <tr> <td>BankChurn</td> <td><code>src/bankchurn/trainer.py</code></td> <td><code>configs/config.yaml</code></td> <td><code>artifacts/</code></td> </tr> <tr> <td>CarVision</td> <td><code>main.py</code></td> <td><code>configs/config.yaml</code></td> <td><code>artifacts/</code></td> </tr> <tr> <td>TelecomAI</td> <td><code>src/telecomai/training.py</code></td> <td><code>configs/config.yaml</code></td> <td><code>artifacts/</code></td> </tr> </tbody> </table> <h3 id=ejercicio-ejecuta-training-real>ğŸ”§ Ejercicio: Ejecuta Training Real<a class=headerlink href=#ejercicio-ejecuta-training-real title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># 1. Ve a BankChurn</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=nb>cd</span><span class=w> </span>BankChurn-Predictor
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=c1># 2. Entrena el modelo</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>python<span class=w> </span>main.py<span class=w> </span>--config<span class=w> </span>configs/config.yaml
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=c1># 3. Verifica artefactos generados</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>ls<span class=w> </span>-la<span class=w> </span>artifacts/
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>cat<span class=w> </span>artifacts/training_results.json
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=c1># 4. Verifica MLflow</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>mlflow<span class=w> </span>ui<span class=w>  </span><span class=c1># Abre http://localhost:5000</span>
</code></pre></div> <hr> <h2 id=consejos-profesionales>ğŸ’¼ Consejos Profesionales<a class=headerlink href=#consejos-profesionales title="Permanent link">&para;</a></h2> <blockquote> <p><strong>Recomendaciones para destacar en entrevistas y proyectos reales</strong></p> </blockquote> <h3 id=para-entrevistas>Para Entrevistas<a class=headerlink href=#para-entrevistas title="Permanent link">&para;</a></h3> <ol> <li> <p><strong>Cross-Validation</strong>: Explica stratified k-fold, time series split, y cuÃ¡ndo usar cada uno.</p> </li> <li> <p><strong>Hyperparameter Tuning</strong>: RandomSearch vs GridSearch vs Bayesian (Optuna).</p> </li> <li> <p><strong>MÃ©tricas de negocio</strong>: Traduce mÃ©tricas tÃ©cnicas a impacto de negocio.</p> </li> </ol> <h3 id=para-proyectos-reales>Para Proyectos Reales<a class=headerlink href=#para-proyectos-reales title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>SituaciÃ³n</th> <th>Consejo</th> </tr> </thead> <tbody> <tr> <td>Clases desbalanceadas</td> <td>SMOTE, class_weight, o threshold tuning</td> </tr> <tr> <td>Overfitting</td> <td>Early stopping, regularizaciÃ³n, mÃ¡s datos</td> </tr> <tr> <td>Modelo en producciÃ³n</td> <td>Entrena con todos los datos al final</td> </tr> <tr> <td>Reproducibilidad</td> <td>Fija seeds en todos los componentes</td> </tr> </tbody> </table> <h3 id=pipeline-de-training-profesional>Pipeline de Training Profesional<a class=headerlink href=#pipeline-de-training-profesional title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>1. Split estratificado (train/val/test)
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>2. Feature engineering solo en train
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>3. Hyperparameter tuning con val
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>4. EvaluaciÃ³n final en test (una sola vez)
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>5. Re-entrenamiento con todos los datos
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>6. Versionado de modelo + mÃ©tricas
</code></pre></div> <hr> <h2 id=recursos-externos-del-modulo>ğŸ“º Recursos Externos del MÃ³dulo<a class=headerlink href=#recursos-externos-del-modulo title="Permanent link">&para;</a></h2> <blockquote> <p>ğŸ·ï¸ Sistema: ğŸ”´ Obligatorio | ğŸŸ¡ Recomendado | ğŸŸ¢ Complementario</p> </blockquote> <h3 id=videos>ğŸ¬ Videos<a class=headerlink href=#videos title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th style="text-align: center;">ğŸ·ï¸</th> <th style="text-align: left;">TÃ­tulo</th> <th style="text-align: left;">Canal</th> <th style="text-align: center;">DuraciÃ³n</th> <th style="text-align: left;">Link</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">ğŸ”´</td> <td style="text-align: left;"><strong>Cross-Validation Explained</strong></td> <td style="text-align: left;">StatQuest</td> <td style="text-align: center;">12 min</td> <td style="text-align: left;"><a href="https://www.youtube.com/watch?v=fSytzGwwBVw">YouTube</a></td> </tr> <tr> <td style="text-align: center;">ğŸ”´</td> <td style="text-align: left;"><strong>Hyperparameter Tuning</strong></td> <td style="text-align: left;">Krish Naik</td> <td style="text-align: center;">25 min</td> <td style="text-align: left;"><a href="https://www.youtube.com/watch?v=HdlDYng8g9s">YouTube</a></td> </tr> <tr> <td style="text-align: center;">ğŸŸ¡</td> <td style="text-align: left;"><strong>Optuna Tutorial</strong></td> <td style="text-align: left;">Weights &amp; Biases</td> <td style="text-align: center;">30 min</td> <td style="text-align: left;"><a href="https://www.youtube.com/watch?v=P6NwZVl8ttc">YouTube</a></td> </tr> </tbody> </table> <h3 id=documentacion>ğŸ“„ DocumentaciÃ³n<a class=headerlink href=#documentacion title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th style="text-align: center;">ğŸ·ï¸</th> <th style="text-align: left;">Recurso</th> <th style="text-align: left;">DescripciÃ³n</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;">ğŸ”´</td> <td style="text-align: left;"><a href=https://scikit-learn.org/stable/modules/cross_validation.html>sklearn Cross-validation</a></td> <td style="text-align: left;">GuÃ­a oficial CV</td> </tr> <tr> <td style="text-align: center;">ğŸŸ¡</td> <td style="text-align: left;"><a href=https://optuna.readthedocs.io/ >Optuna Docs</a></td> <td style="text-align: left;">Hyperparameter optimization</td> </tr> </tbody> </table> <hr> <h2 id=ejercicios-del-modulo>ğŸ”§ Ejercicios del MÃ³dulo<a class=headerlink href=#ejercicios-del-modulo title="Permanent link">&para;</a></h2> <h3 id=ejercicio-91-trainer-class>Ejercicio 9.1: Trainer Class<a class=headerlink href=#ejercicio-91-trainer-class title="Permanent link">&para;</a></h3> <p><strong>Objetivo</strong>: Implementar clase de entrenamiento profesional. <strong>Dificultad</strong>: â­â­â­</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1># TU TAREA: Completa la clase Trainer</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=k>class</span><span class=w> </span><span class=nc>Trainer</span><span class=p>:</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>):</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=k>def</span><span class=w> </span><span class=nf>cross_validate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Ejecuta CV estratificado.&quot;&quot;&quot;</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>        <span class=c1># ???</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Entrena modelo final.&quot;&quot;&quot;</span>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a>        <span class=c1># ???</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>    <span class=k>def</span><span class=w> </span><span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>path</span><span class=p>):</span>
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Guarda modelo y mÃ©tricas.&quot;&quot;&quot;</span>
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>        <span class=c1># ???</span>
</code></pre></div> <details> <summary>ğŸ’¡ Ver soluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=kn>from</span><span class=w> </span><span class=nn>pathlib</span><span class=w> </span><span class=kn>import</span> <span class=n>Path</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=kn>import</span><span class=w> </span><span class=nn>json</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=kn>import</span><span class=w> </span><span class=nn>joblib</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>cross_val_score</span><span class=p>,</span> <span class=n>StratifiedKFold</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.pipeline</span><span class=w> </span><span class=kn>import</span> <span class=n>Pipeline</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=k>class</span><span class=w> </span><span class=nc>Trainer</span><span class=p>:</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>config</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cv_scores_</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>        <span class=bp>self</span><span class=o>.</span><span class=n>metrics_</span> <span class=o>=</span> <span class=p>{}</span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>    <span class=k>def</span><span class=w> </span><span class=nf>cross_validate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>5</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Ejecuta CV estratificado.&quot;&quot;&quot;</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>        <span class=n>pipeline</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_pipeline</span><span class=p>()</span>
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>        <span class=n>cv_strategy</span> <span class=o>=</span> <span class=n>StratifiedKFold</span><span class=p>(</span>
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>            <span class=n>n_splits</span><span class=o>=</span><span class=n>cv</span><span class=p>,</span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a>            <span class=n>shuffle</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
<a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a>            <span class=n>random_state</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;random_state&#39;</span><span class=p>,</span> <span class=mi>42</span><span class=p>)</span>
<a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a>        <span class=p>)</span>
<a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a>
<a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a>        <span class=bp>self</span><span class=o>.</span><span class=n>cv_scores_</span> <span class=o>=</span> <span class=n>cross_val_score</span><span class=p>(</span>
<a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a>            <span class=n>pipeline</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a>            <span class=n>cv</span><span class=o>=</span><span class=n>cv_strategy</span><span class=p>,</span>
<a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a>            <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;f1&#39;</span>
<a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a>        <span class=p>)</span>
<a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a>
<a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a>        <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a>            <span class=s1>&#39;cv_mean&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_scores_</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span>
<a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a>            <span class=s1>&#39;cv_std&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_scores_</span><span class=o>.</span><span class=n>std</span><span class=p>(),</span>
<a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a>            <span class=s1>&#39;cv_scores&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_scores_</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
<a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a>        <span class=p>}</span>
<a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a>
<a id=__codelineno-17-36 name=__codelineno-17-36 href=#__codelineno-17-36></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-17-37 name=__codelineno-17-37 href=#__codelineno-17-37></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Entrena modelo final con todos los datos.&quot;&quot;&quot;</span>
<a id=__codelineno-17-38 name=__codelineno-17-38 href=#__codelineno-17-38></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_build_pipeline</span><span class=p>()</span>
<a id=__codelineno-17-39 name=__codelineno-17-39 href=#__codelineno-17-39></a>        <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<a id=__codelineno-17-40 name=__codelineno-17-40 href=#__codelineno-17-40></a>        <span class=k>return</span> <span class=bp>self</span>
<a id=__codelineno-17-41 name=__codelineno-17-41 href=#__codelineno-17-41></a>
<a id=__codelineno-17-42 name=__codelineno-17-42 href=#__codelineno-17-42></a>    <span class=k>def</span><span class=w> </span><span class=nf>evaluate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
<a id=__codelineno-17-43 name=__codelineno-17-43 href=#__codelineno-17-43></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;EvalÃºa en test set.&quot;&quot;&quot;</span>
<a id=__codelineno-17-44 name=__codelineno-17-44 href=#__codelineno-17-44></a>        <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>f1_score</span><span class=p>,</span> <span class=n>accuracy_score</span>
<a id=__codelineno-17-45 name=__codelineno-17-45 href=#__codelineno-17-45></a>
<a id=__codelineno-17-46 name=__codelineno-17-46 href=#__codelineno-17-46></a>        <span class=n>y_pred</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
<a id=__codelineno-17-47 name=__codelineno-17-47 href=#__codelineno-17-47></a>        <span class=bp>self</span><span class=o>.</span><span class=n>metrics_</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-17-48 name=__codelineno-17-48 href=#__codelineno-17-48></a>            <span class=s1>&#39;f1&#39;</span><span class=p>:</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
<a id=__codelineno-17-49 name=__codelineno-17-49 href=#__codelineno-17-49></a>            <span class=s1>&#39;accuracy&#39;</span><span class=p>:</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
<a id=__codelineno-17-50 name=__codelineno-17-50 href=#__codelineno-17-50></a>        <span class=p>}</span>
<a id=__codelineno-17-51 name=__codelineno-17-51 href=#__codelineno-17-51></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>metrics_</span>
<a id=__codelineno-17-52 name=__codelineno-17-52 href=#__codelineno-17-52></a>
<a id=__codelineno-17-53 name=__codelineno-17-53 href=#__codelineno-17-53></a>    <span class=k>def</span><span class=w> </span><span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>output_dir</span><span class=p>:</span> <span class=n>Path</span><span class=p>):</span>
<a id=__codelineno-17-54 name=__codelineno-17-54 href=#__codelineno-17-54></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Guarda modelo y mÃ©tricas.&quot;&quot;&quot;</span>
<a id=__codelineno-17-55 name=__codelineno-17-55 href=#__codelineno-17-55></a>        <span class=n>output_dir</span> <span class=o>=</span> <span class=n>Path</span><span class=p>(</span><span class=n>output_dir</span><span class=p>)</span>
<a id=__codelineno-17-56 name=__codelineno-17-56 href=#__codelineno-17-56></a>        <span class=n>output_dir</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>parents</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-17-57 name=__codelineno-17-57 href=#__codelineno-17-57></a>
<a id=__codelineno-17-58 name=__codelineno-17-58 href=#__codelineno-17-58></a>        <span class=c1># Guardar modelo</span>
<a id=__codelineno-17-59 name=__codelineno-17-59 href=#__codelineno-17-59></a>        <span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>model_</span><span class=p>,</span> <span class=n>output_dir</span> <span class=o>/</span> <span class=s1>&#39;model.joblib&#39;</span><span class=p>)</span>
<a id=__codelineno-17-60 name=__codelineno-17-60 href=#__codelineno-17-60></a>
<a id=__codelineno-17-61 name=__codelineno-17-61 href=#__codelineno-17-61></a>        <span class=c1># Guardar mÃ©tricas</span>
<a id=__codelineno-17-62 name=__codelineno-17-62 href=#__codelineno-17-62></a>        <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-17-63 name=__codelineno-17-63 href=#__codelineno-17-63></a>            <span class=s1>&#39;cv_scores&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_scores_</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span> <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>cv_scores_</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-17-64 name=__codelineno-17-64 href=#__codelineno-17-64></a>            <span class=s1>&#39;test_metrics&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>metrics_</span><span class=p>,</span>
<a id=__codelineno-17-65 name=__codelineno-17-65 href=#__codelineno-17-65></a>            <span class=s1>&#39;config&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span>
<a id=__codelineno-17-66 name=__codelineno-17-66 href=#__codelineno-17-66></a>        <span class=p>}</span>
<a id=__codelineno-17-67 name=__codelineno-17-67 href=#__codelineno-17-67></a>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_dir</span> <span class=o>/</span> <span class=s1>&#39;results.json&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
<a id=__codelineno-17-68 name=__codelineno-17-68 href=#__codelineno-17-68></a>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>results</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
<a id=__codelineno-17-69 name=__codelineno-17-69 href=#__codelineno-17-69></a>
<a id=__codelineno-17-70 name=__codelineno-17-70 href=#__codelineno-17-70></a>    <span class=k>def</span><span class=w> </span><span class=nf>_build_pipeline</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Pipeline</span><span class=p>:</span>
<a id=__codelineno-17-71 name=__codelineno-17-71 href=#__codelineno-17-71></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;Construye pipeline segÃºn config.&quot;&quot;&quot;</span>
<a id=__codelineno-17-72 name=__codelineno-17-72 href=#__codelineno-17-72></a>        <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<a id=__codelineno-17-73 name=__codelineno-17-73 href=#__codelineno-17-73></a>        <span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
<a id=__codelineno-17-74 name=__codelineno-17-74 href=#__codelineno-17-74></a>
<a id=__codelineno-17-75 name=__codelineno-17-75 href=#__codelineno-17-75></a>        <span class=k>return</span> <span class=n>Pipeline</span><span class=p>([</span>
<a id=__codelineno-17-76 name=__codelineno-17-76 href=#__codelineno-17-76></a>            <span class=p>(</span><span class=s1>&#39;scaler&#39;</span><span class=p>,</span> <span class=n>StandardScaler</span><span class=p>()),</span>
<a id=__codelineno-17-77 name=__codelineno-17-77 href=#__codelineno-17-77></a>            <span class=p>(</span><span class=s1>&#39;model&#39;</span><span class=p>,</span> <span class=n>RandomForestClassifier</span><span class=p>(</span>
<a id=__codelineno-17-78 name=__codelineno-17-78 href=#__codelineno-17-78></a>                <span class=n>n_estimators</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;n_estimators&#39;</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
<a id=__codelineno-17-79 name=__codelineno-17-79 href=#__codelineno-17-79></a>                <span class=n>max_depth</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;max_depth&#39;</span><span class=p>),</span>
<a id=__codelineno-17-80 name=__codelineno-17-80 href=#__codelineno-17-80></a>                <span class=n>random_state</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;random_state&#39;</span><span class=p>,</span> <span class=mi>42</span><span class=p>)</span>
<a id=__codelineno-17-81 name=__codelineno-17-81 href=#__codelineno-17-81></a>            <span class=p>))</span>
<a id=__codelineno-17-82 name=__codelineno-17-82 href=#__codelineno-17-82></a>        <span class=p>])</span>
</code></pre></div> </details> <hr> <h3 id=ejercicio-92-reproducibilidad>Ejercicio 9.2: Reproducibilidad<a class=headerlink href=#ejercicio-92-reproducibilidad title="Permanent link">&para;</a></h3> <p><strong>Objetivo</strong>: Garantizar resultados reproducibles. <strong>Dificultad</strong>: â­â­</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1># TU TAREA: Â¿QuÃ© falta para garantizar reproducibilidad?</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=k>def</span><span class=w> </span><span class=nf>train_model</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>)</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>)</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>    <span class=k>return</span> <span class=n>model</span>
</code></pre></div> <details> <summary>ğŸ’¡ Ver soluciÃ³n</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=k>def</span><span class=w> </span><span class=nf>set_seeds</span><span class=p>(</span><span class=n>seed</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>42</span><span class=p>):</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Fija todas las semillas para reproducibilidad.&quot;&quot;&quot;</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=n>seed</span><span class=p>)</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>    <span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=n>seed</span><span class=p>)</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a>    <span class=c1># Si usas PyTorch: torch.manual_seed(seed)</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>    <span class=c1># Si usas TensorFlow: tf.random.set_seed(seed)</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=k>def</span><span class=w> </span><span class=nf>train_model</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>random_state</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>42</span><span class=p>):</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a>    <span class=c1># 1. Fijar semillas globales</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a>    <span class=n>set_seeds</span><span class=p>(</span><span class=n>random_state</span><span class=p>)</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>    <span class=c1># 2. random_state en el modelo</span>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a>    <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a>        <span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a>        <span class=n>random_state</span><span class=o>=</span><span class=n>random_state</span>  <span class=c1># â† IMPORTANTE</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a>    <span class=p>)</span>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a>
<a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a>    <span class=c1># 3. random_state en el split</span>
<a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a>    <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span>
<a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a>        <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span>
<a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a>        <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span>
<a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a>        <span class=n>random_state</span><span class=o>=</span><span class=n>random_state</span><span class=p>,</span>  <span class=c1># â† IMPORTANTE</span>
<a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a>        <span class=n>stratify</span><span class=o>=</span><span class=n>y</span>  <span class=c1># â† Mantiene distribuciÃ³n de clases</span>
<a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a>    <span class=p>)</span>
<a id=__codelineno-19-28 name=__codelineno-19-28 href=#__codelineno-19-28></a>
<a id=__codelineno-19-29 name=__codelineno-19-29 href=#__codelineno-19-29></a>    <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
<a id=__codelineno-19-30 name=__codelineno-19-30 href=#__codelineno-19-30></a>    <span class=k>return</span> <span class=n>model</span>
<a id=__codelineno-19-31 name=__codelineno-19-31 href=#__codelineno-19-31></a>
<a id=__codelineno-19-32 name=__codelineno-19-32 href=#__codelineno-19-32></a><span class=c1># Checklist de reproducibilidad:</span>
<a id=__codelineno-19-33 name=__codelineno-19-33 href=#__codelineno-19-33></a><span class=c1># âœ… random_state en train_test_split</span>
<a id=__codelineno-19-34 name=__codelineno-19-34 href=#__codelineno-19-34></a><span class=c1># âœ… random_state en modelo</span>
<a id=__codelineno-19-35 name=__codelineno-19-35 href=#__codelineno-19-35></a><span class=c1># âœ… random_state en cross-validation</span>
<a id=__codelineno-19-36 name=__codelineno-19-36 href=#__codelineno-19-36></a><span class=c1># âœ… VersiÃ³n de dependencias fijada (requirements.txt)</span>
<a id=__codelineno-19-37 name=__codelineno-19-37 href=#__codelineno-19-37></a><span class=c1># âœ… Datos versionados (DVC)</span>
<a id=__codelineno-19-38 name=__codelineno-19-38 href=#__codelineno-19-38></a><span class=c1># âœ… CÃ³digo versionado (Git commit)</span>
</code></pre></div> </details> <hr> <h2 id=glosario-del-modulo>ğŸ”— Glosario del MÃ³dulo<a class=headerlink href=#glosario-del-modulo title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>TÃ©rmino</th> <th>DefiniciÃ³n</th> </tr> </thead> <tbody> <tr> <td><strong>Cross-Validation</strong></td> <td>TÃ©cnica para evaluar modelo dividiendo datos en K folds</td> </tr> <tr> <td><strong>Stratified K-Fold</strong></td> <td>CV que mantiene proporciÃ³n de clases en cada fold</td> </tr> <tr> <td><strong>Hyperparameter Tuning</strong></td> <td>BÃºsqueda de mejores parÃ¡metros del modelo</td> </tr> <tr> <td><strong>random_state</strong></td> <td>Semilla para reproducibilidad de resultados aleatorios</td> </tr> </tbody> </table> <hr> <div align=center> **Siguiente mÃ³dulo** â†’ [10. Experiment Tracking](10_EXPERIMENT_TRACKING.md) --- [â† Volver al Ãndice](00_INDICE.md) </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Volver al principio </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 DuqueOM â€” GuÃ­a MLOps v2 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/DuqueOM target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://linkedin.com/in/duqueom target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>